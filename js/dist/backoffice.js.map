{"version":3,"sources":["webpack://@flamarkt/core/webpack/bootstrap","webpack://@flamarkt/core/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flamarkt/core/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flamarkt/core/external \"flarum.core.compat['common/Model']\"","webpack://@flamarkt/core/external \"flarum.extensions['flamarkt-backoffice']['backoffice']['app']\"","webpack://@flamarkt/core/external \"flarum.core.compat['common/utils/ItemList']\"","webpack://@flamarkt/core/external \"flarum.core.compat['common/Component']\"","webpack://@flamarkt/core/external \"flarum.core.compat['common/app']\"","webpack://@flamarkt/core/external \"flarum.core.compat['common/components/LinkButton']\"","webpack://@flamarkt/core/./src/common/components/PriceLabel.ts","webpack://@flamarkt/core/external \"flarum.core.compat['common/components/Page']\"","webpack://@flamarkt/core/external \"flarum.core.compat['common/utils/extractText']\"","webpack://@flamarkt/core/external \"flarum.core.compat['common/components/Button']\"","webpack://@flamarkt/core/external \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@flamarkt/core/./src/common/components/DecimalInput.ts","webpack://@flamarkt/core/./src/common/components/DecimalLabel.ts","webpack://@flamarkt/core/external \"flarum.core.compat['common/extend']\"","webpack://@flamarkt/core/external \"flarum.extensions['flamarkt-backoffice']['common']['states/AbstractListState']\"","webpack://@flamarkt/core/./src/common/components/PriceInput.ts","webpack://@flamarkt/core/./src/common/components/QuantityInput.ts","webpack://@flamarkt/core/./src/common/models/Order.ts","webpack://@flamarkt/core/./src/common/models/OrderLine.ts","webpack://@flamarkt/core/./src/common/models/Product.ts","webpack://@flamarkt/core/./src/common/components/OrderSortDropdown.ts","webpack://@flamarkt/core/external \"flarum.extensions['flamarkt-backoffice']['common']['components/AbstractSortDropdown']\"","webpack://@flamarkt/core/./src/common/components/ProductSortDropdown.ts","webpack://@flamarkt/core/./src/common/states/OrderListState.ts","webpack://@flamarkt/core/./src/common/states/ProductListState.ts","webpack://@flamarkt/core/external \"flarum.extensions['flamarkt-backoffice']['common']['pages/AbstractShowPage']\"","webpack://@flamarkt/core/external \"flarum.core.compat['common/components/Select']\"","webpack://@flamarkt/core/./src/common/models/Payment.ts","webpack://@flamarkt/core/./src/common/components/QuantityLabel.ts","webpack://@flamarkt/core/./src/common/helpers/formatPrice.ts","webpack://@flamarkt/core/./src/common/models/Cart.ts","webpack://@flamarkt/core/external \"flarum.core.compat['common/helpers/highlight']\"","webpack://@flamarkt/core/external \"flarum.core.compat['common/helpers/humanTime']\"","webpack://@flamarkt/core/external \"flarum.extensions['flamarkt-backoffice']['common']['components/ActiveLinkButton']\"","webpack://@flamarkt/core/external \"flarum.extensions['flamarkt-backoffice']['backoffice']['components/AbstractList']\"","webpack://@flamarkt/core/external \"flarum.extensions['flamarkt-backoffice']['backoffice']['components/SubmitButton']\"","webpack://@flamarkt/core/external \"flarum.extensions['flamarkt-backoffice']['backoffice']['components/PermanentDeleteButton']\"","webpack://@flamarkt/core/./src/common/compat.js","webpack://@flamarkt/core/external \"flarum.extensions['flamarkt-backoffice']['common']['components/AbstractRelationshipSelect']\"","webpack://@flamarkt/core/external \"flarum.extensions['flamarkt-backoffice']['backoffice']['components/SoftDeleteButton']\"","webpack://@flamarkt/core/external \"flarum.extensions['flamarkt-backoffice']['common']['components/SortableHandle']\"","webpack://@flamarkt/core/external \"flarum.core.compat['common/helpers/username']\"","webpack://@flamarkt/core/external \"flarum.extensions['flamarkt-backoffice']['common']['components/Sortable']\"","webpack://@flamarkt/core/external \"flarum.extensions['flamarkt-backoffice']['common']['components/UserRelationshipSelect']\"","webpack://@flamarkt/core/external \"flarum.core.compat['common/components/Modal']\"","webpack://@flamarkt/core/external \"flarum.core.compat['common/components/TextEditor']\"","webpack://@flamarkt/core/external \"flarum.extensions['flamarkt-backoffice']['backoffice']['components/BackofficeNav']\"","webpack://@flamarkt/core/./src/backoffice/components/ProductRelationshipSelect.ts","webpack://@flamarkt/core/./src/backoffice/components/OrderLineEdit.ts","webpack://@flamarkt/core/./src/backoffice/components/OrderList.ts","webpack://@flamarkt/core/./src/backoffice/components/OrderRelationshipSelect.ts","webpack://@flamarkt/core/./src/backoffice/components/ProductList.ts","webpack://@flamarkt/core/./src/backoffice/pages/OrderIndexPage.ts","webpack://@flamarkt/core/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@flamarkt/core/./src/backoffice/states/OrderLineEditState.ts","webpack://@flamarkt/core/./src/backoffice/components/EditPaymentModal.ts","webpack://@flamarkt/core/./src/backoffice/components/PaymentList.ts","webpack://@flamarkt/core/./src/backoffice/states/PaymentListPassthroughState.ts","webpack://@flamarkt/core/./src/backoffice/pages/OrderShowPage.ts","webpack://@flamarkt/core/./src/backoffice/pages/ProductIndexPage.ts","webpack://@flamarkt/core/./src/backoffice/pages/ProductShowPage.ts","webpack://@flamarkt/core/./src/backoffice/compat.js","webpack://@flamarkt/core/./src/backoffice/index.ts","webpack://@flamarkt/core/./src/backoffice/addRoutes.ts","webpack://@flamarkt/core/./src/backoffice/addNavLinks.ts","webpack://@flamarkt/core/./src/backoffice/registerSettings.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","_setPrototypeOf","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","constructor","flarum","core","compat","extensions","PriceLabel","decimals","app","forum","attribute","view","DecimalLabel","DecimalInput","this","attrs","min","max","step","fromIntegerValue","Math","pow","toIntegerValue","round","inputAttrs","type","onchange","event","parseFloat","target","Component","toFixed","PriceInput","QuantityInput","Order","number","Model","slug","productCount","priceTotal","paidAmount","createdAt","transformDate","isHidden","user","hasOne","lines","hasMany","payments","apiEndpoint","exists","data","id","OrderLine","group","label","comment","quantity","priceUnit","product","Product","title","description","descriptionHtml","price","priceEdit","cartQuantity","canOrder","canEdit","cartPriceTotalLocal","OrderSortDropdown","className","options","AbstractSortDropdown","ProductSortDropdown","translator","trans","OrderListState","AbstractListState","ProductListState","Payment","method","identifier","amount","QuantityLabel","parseInt","Cart","products","priceTotalLocal","reduce","total","common","formatPrice","ProductRelationshipSelect","resultsCache","Map","search","query","store","find","filter","q","page","limit","then","results","set","redraw","Promise","resolve","toLowerCase","concat","all","substr","length","e","arr","lastIndexOf","sort","a","b","localeCompare","item","highlight","AbstractRelationshipSelect","OrderLineEdit","vnode","line","control","sortable","style","ondragstart","columns","toArray","ItemList","add","SortableHandle","Select","component","_none","shipping","manual","fields","updateTotal","showInfoProduct","showInfoLabel","showInfoComment","relationship","OrderList","head","order","humanTime","username","actions","LinkButton","icon","href","route","AbstractList","OrderRelationshipSelect","ProductList","OrderIndexPage","list","oninit","initState","refresh","setTitle","extractText","setTitleCount","pageParams","param","params","state","Page","_extends","assign","arguments","source","apply","uniqueKey","OrderLineEditState","uniqueFormKey","init","attributes","relationships","getIdentifier","EditPaymentModal","payment","dirty","createRecord","content","oninput","disabled","loading","SubmitButton","PermanentDeleteButton","model","afterdelete","modal","close","onsubmit","preventDefault","save","loaded","Modal","PaymentList","Button","onclick","show","PaymentListPassthroughState","pages","OrderShowPage","saving","newLine","initNewLine","initLineState","newRecord","findType","map","LoadingIndicator","readonly","UserRelationshipSelect","tableHead","Sortable","containerTag","placeholderTag","onsort","origin","destination","splice","index","push","SoftDeleteButton","verbatim","saveThroughNewRecord","error","AbstractShowPage","ProductIndexPage","ProductShowPage","availabilityDriver","priceDriver","composer","editor","TextEditor","availabilityDriverOptions","priceDriverOptions","_default","forEach","driver","backoffice","initializers","models","users","flamarktOrderCount","routes","path","extend","BackofficeNav","items","ActiveLinkButton","activeRoutes","extensionData","registerSetting","setting","registerPermission","permission","allowGuest"],"mappings":"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","file":"backoffice.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 63);\n","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","module.exports = flarum.core.compat['common/Model'];","module.exports = flarum.extensions['flamarkt-backoffice']['backoffice']['app'];","module.exports = flarum.core.compat['common/utils/ItemList'];","module.exports = flarum.core.compat['common/Component'];","module.exports = flarum.core.compat['common/app'];","module.exports = flarum.core.compat['common/components/LinkButton'];","import app from 'flarum/common/app';\nimport DecimalLabel, {DecimalLabelAttrs} from './DecimalLabel';\n\nexport interface PriceLabelAttrs extends DecimalLabelAttrs {\n    hint?: string // A text designed to help with extensibility\n}\n\nexport default class PriceLabel<T extends PriceLabelAttrs = PriceLabelAttrs> extends DecimalLabel<T> {\n    decimals(): number {\n        return app.forum.attribute('priceDecimals');\n    }\n\n    view(): any {\n        return [\n            super.view(),\n            ' ',\n            app.forum.attribute('priceUnit'),\n        ];\n    }\n}\n","module.exports = flarum.core.compat['common/components/Page'];","module.exports = flarum.core.compat['common/utils/extractText'];","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/components/LoadingIndicator'];","import Component, {ComponentAttrs} from 'flarum/common/Component';\nimport Product from '../models/Product';\n\nexport interface DecimalInputAttrs extends ComponentAttrs {\n    value: number\n    onchange: (value: number) => void\n    disabled?: boolean\n    product?: Product\n    unit?: string\n    min?: number\n    max?: number\n    step?: number\n    decimals?: number\n}\n\nexport default class DecimalInput<T extends DecimalInputAttrs = DecimalInputAttrs> extends Component<T> {\n    decimals(): number {\n        return this.attrs.decimals || 0;\n    }\n\n    min(): number | undefined {\n        return this.attrs.min;\n    }\n\n    max(): number | undefined {\n        return this.attrs.max;\n    }\n\n    step(): number | undefined {\n        return this.attrs.step;\n    }\n\n    fromIntegerValue(value: number): number {\n        return value / Math.pow(10, this.decimals());\n    }\n\n    toIntegerValue(value: number): number {\n        return Math.round(value * Math.pow(10, this.decimals()));\n    }\n\n    view() {\n        const inputAttrs: any = {\n            type: 'number',\n            value: this.fromIntegerValue(this.attrs.value) + '', // Cast to string to preserve zero\n            onchange: (event: Event) => {\n                const value = parseFloat((event.target as HTMLInputElement).value);\n\n                this.attrs.onchange(this.toIntegerValue(value));\n            },\n        };\n\n        const min = this.min();\n\n        if (typeof min !== 'undefined') {\n            inputAttrs.min = this.fromIntegerValue(min);\n        }\n\n        const max = this.max();\n\n        if (typeof max !== 'undefined') {\n            inputAttrs.max = this.fromIntegerValue(max);\n        }\n\n        const step = this.step();\n\n        if (typeof step !== 'undefined') {\n            inputAttrs.step = this.fromIntegerValue(step);\n        } else if (this.decimals() > 0) {\n            inputAttrs.step = 1 / Math.pow(10, this.decimals());\n        }\n\n        return m('input.FormControl', inputAttrs);\n    }\n}\n","import {Children} from 'mithril';\nimport Component, {ComponentAttrs} from 'flarum/common/Component';\nimport Product from '../models/Product';\n\nexport interface DecimalLabelAttrs extends ComponentAttrs {\n    value: number\n    product?: Product\n    unit?: string\n    decimals?: number\n}\n\nexport default class DecimalLabel<T extends DecimalLabelAttrs = DecimalLabelAttrs> extends Component<T> {\n    decimals(): number {\n        return this.attrs.decimals || 0;\n    }\n\n    fromIntegerValue(value: number): number {\n        return value / Math.pow(10, this.decimals());\n    }\n\n    view(): Children {\n        return this.fromIntegerValue(this.attrs.value).toFixed(this.decimals());\n    }\n}\n","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.extensions['flamarkt-backoffice']['common']['states/AbstractListState'];","import app from 'flarum/common/app';\nimport DecimalInput from './DecimalInput';\n\nexport default class PriceInput extends DecimalInput {\n    decimals(): number {\n        return app.forum.attribute('priceDecimals');\n    }\n}\n","import DecimalInput from './DecimalInput';\n\nexport default class QuantityInput extends DecimalInput {\n    //\n}\n","import Model from 'flarum/common/Model';\nimport User from 'flarum/common/models/User';\nimport OrderLine from './OrderLine';\nimport Payment from './Payment';\n\nexport default class Order extends Model {\n    number = Model.attribute('number');\n    slug = Model.attribute('slug');\n    productCount = Model.attribute('productCount');\n    priceTotal = Model.attribute('priceTotal');\n    paidAmount = Model.attribute('paidAmount');\n    createdAt = Model.attribute('createdAt', Model.transformDate);\n    isHidden = Model.attribute<boolean>('isHidden');\n\n    user = Model.hasOne<User>('user');\n    lines = Model.hasMany<OrderLine>('lines');\n    payments = Model.hasMany<Payment>('payments');\n\n    apiEndpoint() {\n        // @ts-ignore data.id not type-hinted for non-existent models\n        return '/flamarkt/orders' + (this.exists ? '/' + this.data.id : '');\n    }\n}\n","import Model from 'flarum/common/Model';\nimport Product from './Product';\n\nexport default class OrderLine extends Model {\n    number = Model.attribute<number>('number');\n    group = Model.attribute<string | null>('group');\n    type = Model.attribute<string | null>('type');\n    label = Model.attribute<string | null>('label');\n    comment = Model.attribute<string | null>('comment');\n    quantity = Model.attribute<number | null>('quantity');\n    priceUnit = Model.attribute<number | null>('priceUnit');\n    priceTotal = Model.attribute<number | null>('priceTotal');\n\n    product = Model.hasOne<Product>('product');\n}\n","import Model from 'flarum/common/Model';\n\nexport default class Product extends Model {\n    title = Model.attribute<string>('title');\n    slug = Model.attribute('slug');\n    description = Model.attribute<string | null>('description');\n    descriptionHtml = Model.attribute<string | null>('descriptionHtml');\n    price = Model.attribute<number | null>('price');\n    priceEdit = Model.attribute<number | null>('priceEdit');\n    cartQuantity = Model.attribute<number | null>('cartQuantity');\n    isHidden = Model.attribute<boolean>('isHidden');\n    canOrder = Model.attribute<number | null>('canOrder');\n    canEdit = Model.attribute<number | null>('canEdit');\n\n    cartPriceTotalLocal(): number {\n        if (!this.price || !this.cartQuantity) {\n            return 0;\n        }\n\n        // @ts-ignore Wrong Model.attribute typings\n        return this.price() * this.cartQuantity();\n    }\n\n    apiEndpoint() {\n        // @ts-ignore data.id not type-hinted for non-existent models\n        return '/flamarkt/products' + (this.exists ? '/' + this.data.id : '');\n    }\n}\n","import AbstractSortDropdown, {SortDropdownAttrs, SortOptions} from 'flamarkt/backoffice/common/components/AbstractSortDropdown';\nimport OrderListState from '../states/OrderListState';\n\nexport interface OrderSortDropdownAttrs extends SortDropdownAttrs {\n    state: OrderListState\n}\n\nexport default class OrderSortDropdown extends AbstractSortDropdown<OrderSortDropdownAttrs> {\n    className(): string {\n        return 'OrderSortDropdown';\n    }\n\n    options(): SortOptions {\n        return {\n            '-createdAt': 'Newest',\n            'createdAt': 'Oldest',\n            '-priceTotal': 'Highest total',\n            'priceTotal': 'Lowest total',\n        };\n    }\n}\n","module.exports = flarum.extensions['flamarkt-backoffice']['common']['components/AbstractSortDropdown'];","import app from 'flarum/common/app';\nimport AbstractSortDropdown, {SortDropdownAttrs, SortOptions} from 'flamarkt/backoffice/common/components/AbstractSortDropdown';\nimport ProductListState from '../states/ProductListState';\n\nexport interface ProductSortDropdownAttrs extends SortDropdownAttrs {\n    state: ProductListState\n}\n\nexport default class ProductSortDropdown extends AbstractSortDropdown<ProductSortDropdownAttrs> {\n    className(): string {\n        return 'ProductSortDropdown';\n    }\n\n    options(): SortOptions {\n        return {\n            '-createdAt': app.translator.trans('flamarkt-core.lib.sort.products.createdAtDesc') as string,\n            'createdAt': app.translator.trans('flamarkt-core.lib.sort.products.createdAtAsc') as string,\n            'price': app.translator.trans('flamarkt-core.lib.sort.products.priceAsc') as string,\n            '-price': app.translator.trans('flamarkt-core.lib.sort.products.priceDesc') as string,\n            'title': app.translator.trans('flamarkt-core.lib.sort.products.titleAsc') as string,\n            '-title': app.translator.trans('flamarkt-core.lib.sort.products.titleDesc') as string,\n        };\n    }\n}\n","import AbstractListState from 'flamarkt/backoffice/common/states/AbstractListState';\nimport Order from '../models/Order';\n\nexport default class OrderListState extends AbstractListState<Order> {\n    type() {\n        return 'flamarkt/orders';\n    }\n}\n","import AbstractListState from 'flamarkt/backoffice/common/states/AbstractListState';\nimport Product from '../models/Product';\n\nexport default class ProductListState extends AbstractListState<Product> {\n    type() {\n        return 'flamarkt/products';\n    }\n}\n","module.exports = flarum.extensions['flamarkt-backoffice']['common']['pages/AbstractShowPage'];","module.exports = flarum.core.compat['common/components/Select'];","import Model from 'flarum/common/Model';\n\nexport default class Payment extends Model {\n    method = Model.attribute<string | null>('method');\n    identifier = Model.attribute<string | null>('identifier');\n    amount = Model.attribute<number | null>('amount');\n    createdAt = Model.attribute('createdAt', Model.transformDate);\n    isHidden = Model.attribute<boolean>('isHidden');\n\n    apiEndpoint() {\n        // @ts-ignore data.id not type-hinted for non-existent models\n        return '/flamarkt/payments' + (this.exists ? '/' + this.data.id : '');\n    }\n}\n","import DecimalLabel from './DecimalLabel';\n\nexport default class QuantityLabel extends DecimalLabel {\n    //\n}\n","import app from 'flarum/common/app';\n\n/**\n * @deprecated replaced with PriceLabel\n */\nexport default function (price: any) {\n    // Keep price as-it if not a number, this allows passing vdom or hard-coded string\n    if (price === parseInt(price)) {\n        price = (price / Math.pow(10, app.forum.attribute('priceDecimals'))).toFixed(app.forum.attribute('priceDecimals'));\n    }\n\n    return [price, ' ' + app.forum.attribute('priceUnit')];\n}\n","import Model from 'flarum/common/Model';\nimport Product from './Product';\n\nexport default class Cart extends Model {\n    productCount = Model.attribute<number>('productCount');\n    priceTotal = Model.attribute<number>('priceTotal');\n\n    products = Model.hasMany<Product>('products');\n\n    priceTotalLocal(): number {\n        return (this.products() || []).reduce((total, product) => total + (product ? product.cartPriceTotalLocal() : 0), 0);\n    }\n\n    apiEndpoint() {\n        // @ts-ignore data.id not type-hinted for non-existent models\n        return '/flamarkt/carts' + (this.exists ? '/' + this.data.id : '');\n    }\n}\n","module.exports = flarum.core.compat['common/helpers/highlight'];","module.exports = flarum.core.compat['common/helpers/humanTime'];","module.exports = flarum.extensions['flamarkt-backoffice']['common']['components/ActiveLinkButton'];","module.exports = flarum.extensions['flamarkt-backoffice']['backoffice']['components/AbstractList'];","module.exports = flarum.extensions['flamarkt-backoffice']['backoffice']['components/SubmitButton'];","module.exports = flarum.extensions['flamarkt-backoffice']['backoffice']['components/PermanentDeleteButton'];","import DecimalInput from './components/DecimalInput';\nimport DecimalLabel from './components/DecimalLabel';\nimport OrderSortDropdown from './components/OrderSortDropdown';\nimport PriceInput from './components/PriceInput';\nimport PriceLabel from './components/PriceLabel';\nimport ProductSortDropdown from './components/ProductSortDropdown';\nimport QuantityInput from './components/QuantityInput';\nimport QuantityLabel from './components/QuantityLabel';\nimport formatPrice from './helpers/formatPrice';\nimport Cart from './models/Cart';\nimport Order from './models/Order';\nimport OrderLine from './models/OrderLine';\nimport Payment from './models/Payment';\nimport Product from './models/Product';\nimport OrderListState from './states/OrderListState';\nimport ProductListState from './states/ProductListState';\n\nexport const common = {\n    'components/DecimalInput': DecimalInput,\n    'components/DecimalLabel': DecimalLabel,\n    'components/OrderSortDropdown': OrderSortDropdown,\n    'components/PriceInput': PriceInput,\n    'components/PriceLabel': PriceLabel,\n    'components/ProductSortDropdown': ProductSortDropdown,\n    'components/QuantityInput': QuantityInput,\n    'components/QuantityLabel': QuantityLabel,\n    'helpers/formatPrice': formatPrice,\n    'models/Cart': Cart,\n    'models/Order': Order,\n    'models/OrderLine': OrderLine,\n    'models/Payment': Payment,\n    'models/Product': Product,\n    'states/OrderListState': OrderListState,\n    'states/ProductListState': ProductListState,\n}\n","module.exports = flarum.extensions['flamarkt-backoffice']['common']['components/AbstractRelationshipSelect'];","module.exports = flarum.extensions['flamarkt-backoffice']['backoffice']['components/SoftDeleteButton'];","module.exports = flarum.extensions['flamarkt-backoffice']['common']['components/SortableHandle'];","module.exports = flarum.core.compat['common/helpers/username'];","module.exports = flarum.extensions['flamarkt-backoffice']['common']['components/Sortable'];","module.exports = flarum.extensions['flamarkt-backoffice']['common']['components/UserRelationshipSelect'];","module.exports = flarum.core.compat['common/components/Modal'];","module.exports = flarum.core.compat['common/components/TextEditor'];","module.exports = flarum.extensions['flamarkt-backoffice']['backoffice']['components/BackofficeNav'];","import app from 'flamarkt/backoffice/backoffice/app';\nimport AbstractRelationshipSelect from 'flamarkt/backoffice/common/components/AbstractRelationshipSelect';\nimport highlight from 'flarum/common/helpers/highlight';\nimport Product from '../../common/models/Product';\n\nexport default class ProductRelationshipSelect extends AbstractRelationshipSelect<Product> {\n    protected resultsCache = new Map<string, Product[]>();\n\n    search(query: string) {\n        if (!query) {\n            m.redraw();\n            return Promise.resolve();\n        }\n\n        return app.store\n            .find('flamarkt/products', {\n                filter: {q: query},\n                page: {limit: 5},\n            })\n            .then((results) => {\n                this.resultsCache.set(query, results);\n                m.redraw();\n            });\n    }\n\n    results(query: string) {\n        if (!query) {\n            return [];\n        }\n\n        query = query.toLowerCase();\n\n        const results = this.resultsCache.get(query);\n\n        // Indicates still loading\n        if (typeof results === 'undefined') {\n            return null;\n        }\n\n        return (results || [])\n            .concat(\n                app.store\n                    .all<Product>('flamarkt-products')\n                    .filter(product => product.title().toLowerCase().substr(0, query.length) === query)\n            )\n            .filter((e, i, arr) => arr.lastIndexOf(e) === i)\n            .sort((a, b) => a.title().localeCompare(b.title()));\n    }\n\n    item(product: Product, query?: string) {\n        return [\n            query ? highlight(product.title(), query) : product.title(),\n        ];\n    }\n}\n","import {Attributes, ClassComponent, Vnode} from 'mithril';\nimport SortableHandle from 'flamarkt/backoffice/common/components/SortableHandle';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Select from 'flarum/common/components/Select';\nimport ProductRelationshipSelect from './ProductRelationshipSelect';\nimport Product from '../../common/models/Product';\nimport OrderLineEditState from '../states/OrderLineEditState';\nimport PriceInput from '../../common/components/PriceInput';\nimport QuantityInput from '../../common/components/QuantityInput';\nimport PriceLabel from '../../common/components/PriceLabel';\n\ninterface OrderLineAttrs extends Attributes {\n    line: OrderLineEditState\n    sortable?: boolean\n    control: Vnode\n    onchange: () => void\n}\n\nexport default class OrderLineEdit implements ClassComponent<OrderLineAttrs> {\n    view(vnode: Vnode<OrderLineAttrs>) {\n        const {line, control, onchange, sortable, style, ondragstart} = vnode.attrs;\n\n        return m('tr', {\n            // Copy over attrs from Sortable component\n            style,\n            'data-index': vnode.attrs['data-index'],\n            ondragstart,\n        }, this.columns(line, control, onchange, sortable).toArray());\n    }\n\n    columns(line: OrderLineEditState, control: Vnode, onchange: () => void, sortable?: boolean): ItemList<any> {\n        const columns = new ItemList();\n\n        columns.add('handle', m('td.OrderLineEdit-Handle', sortable ? m(SortableHandle) : null), 100);\n        columns.add('group', m('td.OrderLineEdit-Group', Select.component({\n            value: line.group === null ? '_none' : line.group,\n            onchange: (value: string) => {\n                line.group = value === '_none' ? null : value;\n                onchange();\n            },\n            options: {\n                _none: 'None',\n                shipping: 'Shipping',\n            },\n        })), 90);\n        columns.add('type', m('td.OrderLineEdit-Type', Select.component({\n            value: line.type,\n            onchange: (value: string) => {\n                line.type = value;\n                onchange();\n            },\n            options: {\n                product: 'Product',\n                manual: 'Manual',\n            },\n        })), 80);\n        columns.add('info', m('td.OrderLineEdit-Info', this.fields(line, onchange).toArray()), 30);\n        columns.add('priceUnit', m('td.OrderLineEdit-PriceUnit', m(PriceInput, {\n            value: line.priceUnit,\n            onchange: (value: number) => {\n                line.priceUnit = value;\n                line.updateTotal();\n                onchange();\n            },\n            product: line.product,\n        })), -30);\n        columns.add('quantity', m('td.OrderLineEdit-Quantity', m(QuantityInput, {\n            value: line.quantity,\n            onchange: (value: number) => {\n                line.quantity = value;\n                line.updateTotal();\n                onchange();\n            },\n            product: line.product,\n        })), -60);\n        columns.add('priceTotal', m('td.OrderLineEdit-PriceTotal', m(PriceLabel, {\n            value: line.priceTotal,\n            product: line.product,\n        })), -90);\n        columns.add('control', m('td.OrderLineEdit-Controls', control), -100);\n\n        return columns;\n    }\n\n    showInfoProduct(line: OrderLineEditState) {\n        return line.type === 'product';\n    }\n\n    showInfoLabel(line: OrderLineEditState) {\n        return line.type === 'manual';\n    }\n\n    showInfoComment(line: OrderLineEditState) {\n        return line.type === 'product' || line.type === 'manual';\n    }\n\n    fields(line: OrderLineEditState, onchange: () => void): ItemList<any> {\n        const fields = new ItemList();\n\n        if (this.showInfoProduct(line)) {\n            fields.add('product', m('.Form-group', [\n                m('label', 'Product'),\n                m(ProductRelationshipSelect, {\n                    relationship: line.product,\n                    onchange: (product: Product | null) => {\n                        line.product = product;\n                        onchange();\n                    },\n                    hasOne: true,\n                }),\n            ]));\n        }\n\n        if (this.showInfoLabel(line)) {\n            fields.add('label', m('.Form-group', [\n                m('label', 'Label'),\n                m('input.FormControl', {\n                    type: 'text',\n                    value: line.label,\n                    onchange: (event: Event) => {\n                        line.label = (event.target as HTMLInputElement).value;\n                        onchange();\n                    },\n                }),\n            ]));\n        }\n\n        if (this.showInfoComment(line)) {\n            fields.add('comment', m('.Form-group', [\n                m('label', 'Comment'),\n                m('textarea.FormControl', {\n                    value: line.comment,\n                    onchange: (event: Event) => {\n                        line.comment = (event.target as HTMLInputElement).value;\n                        onchange();\n                    },\n                }),\n            ]));\n        }\n\n        return fields;\n    }\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport AbstractList from 'flamarkt/backoffice/backoffice/components/AbstractList';\nimport Order from '../../common/models/Order';\nimport username from 'flarum/common/helpers/username';\nimport humanTime from 'flarum/common/helpers/humanTime';\nimport PriceLabel from '../../common/components/PriceLabel';\n\nexport default class OrderList extends AbstractList<Order> {\n    head() {\n        const columns = super.head();\n\n        columns.add('number', m('th', app.translator.trans('flamarkt-core.backoffice.orders.head.number')), 50);\n        columns.add('date', m('th', app.translator.trans('flamarkt-core.backoffice.orders.head.date')), 40);\n        columns.add('user', m('th', app.translator.trans('flamarkt-core.backoffice.orders.head.user')), 30);\n        columns.add('priceTotal', m('th', app.translator.trans('flamarkt-core.backoffice.orders.head.priceTotal')), 20);\n        columns.add('paidAmount', m('th', app.translator.trans('flamarkt-core.backoffice.orders.head.paidAmount')), 10);\n        columns.add('productCount', m('th', app.translator.trans('flamarkt-core.backoffice.orders.head.productCount')), 5);\n\n        return columns;\n    }\n\n    columns(order: Order) {\n        const columns = super.columns(order);\n\n        columns.add('number', m('td', order.number()), 50);\n        columns.add('date', m('td', humanTime(order.createdAt())), 40);\n        columns.add('user', m('td', username(order.user())), 30);\n        columns.add('priceTotal', m('td', m(PriceLabel, {\n            value: order.priceTotal(),\n        })), 20);\n        columns.add('paidAmount', m('td', m(PriceLabel, {\n            value: order.paidAmount(),\n        })), 10);\n        columns.add('productCount', m('td', order.productCount()), 5);\n\n        return columns;\n    }\n\n    actions(order: Order) {\n        const actions = super.actions(order);\n\n        actions.add('edit', LinkButton.component({\n            className: 'Button Button--icon',\n            icon: 'fas fa-pen',\n            href: app.route.order(order),\n        }));\n\n        return actions;\n    }\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport AbstractRelationshipSelect from 'flamarkt/backoffice/common/components/AbstractRelationshipSelect';\nimport highlight from 'flarum/common/helpers/highlight';\nimport Order from '../../common/models/Order';\n\nexport default class OrderRelationshipSelect extends AbstractRelationshipSelect<Order> {\n    protected resultsCache = new Map<string, Order[]>();\n\n    search(query: string) {\n        if (!query) {\n            m.redraw();\n            return Promise.resolve();\n        }\n\n        return app.store\n            .find('flamarkt/orders', {\n                filter: {q: query},\n                page: {limit: 5},\n            })\n            .then((results) => {\n                this.resultsCache.set(query, results);\n                m.redraw();\n            });\n    }\n\n    results(query: string) {\n        if (!query) {\n            return [];\n        }\n\n        query = query.toLowerCase();\n\n        const results = this.resultsCache.get(query);\n\n        // Indicates still loading\n        if (typeof results === 'undefined') {\n            return null;\n        }\n\n        return results || [];\n    }\n\n    item(order: Order, query?: string) {\n        return [\n            query ? highlight(order.number(), query) : order.number(),\n        ];\n    }\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport AbstractList from 'flamarkt/backoffice/backoffice/components/AbstractList';\nimport Product from '../../common/models/Product';\n\nexport default class ProductList extends AbstractList<Product> {\n    head() {\n        const columns = super.head();\n\n        columns.add('title', m('th', app.translator.trans('flamarkt-core.backoffice.products.head.title')), 10);\n\n        return columns;\n    }\n\n    columns(product: Product) {\n        const columns = super.columns(product);\n\n        columns.add('title', m('td', product.title()), 10);\n\n        return columns;\n    }\n\n    actions(product: Product) {\n        const actions = super.actions(product);\n\n        actions.add('edit', LinkButton.component({\n            className: 'Button Button--icon',\n            icon: 'fas fa-pen',\n            href: app.route.product(product),\n        }));\n\n        return actions;\n    }\n}\n","import {Vnode} from 'mithril';\nimport app from 'flamarkt/backoffice/backoffice/app';\nimport Page from 'flarum/common/components/Page';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport extractText from 'flarum/common/utils/extractText';\nimport OrderListState from '../../common/states/OrderListState';\nimport OrderList from '../components/OrderList';\nimport OrderSortDropdown from '../../common/components/OrderSortDropdown';\n\nexport default class OrderIndexPage extends Page {\n    list!: OrderListState;\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.list = this.initState();\n        this.list.refresh();\n\n        app.setTitle(extractText(app.translator.trans('flamarkt-core.backoffice.orders.title')));\n        app.setTitleCount(0);\n    }\n\n    initState() {\n        const pageParams = m.route.param();\n\n        const params: any = {\n            sort: pageParams.sort,\n        }\n\n        if (pageParams.user) {\n            params.filter = params.filter || {};\n            params.filter.user = pageParams.user;\n        }\n\n        return new OrderListState(params);\n    }\n\n    view() {\n        return m('.OrderIndexPage', m('.container', [\n            m('.Form-group', [\n                LinkButton.component({\n                    className: 'Button',\n                    href: app.route('orders.show', {\n                        id: 'new',\n                    }),\n                }, app.translator.trans('flamarkt-core.backoffice.orders.new')),\n                m(OrderSortDropdown, {\n                    state: this.list,\n                }),\n            ]),\n            m(OrderList, {\n                state: this.list,\n            }),\n        ]));\n    }\n}\n","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","import OrderLine from '../../common/models/OrderLine';\nimport Product from '../../common/models/Product';\nimport Model from 'flarum/common/Model';\n\nlet uniqueKey = 0;\n\nexport default class OrderLineEditState {\n    uniqueFormKey: string\n    line?: OrderLine\n    group: string | null = null\n    type: string | null = null\n    label: string = '';\n    comment: string = '';\n    quantity: number = 0\n    priceUnit: number = 0\n    priceTotal: number = 0\n    product: Product | null = null\n\n    constructor() {\n        // Used as the Mithril key for re-order operations\n        this.uniqueFormKey = ++uniqueKey + '';\n    }\n\n    init(line: OrderLine) {\n        this.line = line;\n        this.group = line.group() || null;\n        this.type = line.type() || null;\n        this.label = line.label() || '';\n        this.comment = line.comment() || '';\n        this.quantity = line.quantity() || 0;\n        this.priceUnit = line.priceUnit() || 0;\n        this.priceTotal = line.priceTotal() || 0;\n        this.product = line.product() || null;\n    }\n\n    updateTotal() {\n        this.priceTotal = this.quantity * this.priceUnit;\n    }\n\n    data(): any {\n        const data: any = {\n            attributes: {\n                group: this.group,\n                type: this.type,\n                label: this.label,\n                comment: this.comment,\n                quantity: this.quantity,\n                priceUnit: this.priceUnit,\n                // priceTotal intentionally not sent, it's computed again server-side\n            },\n            relationships: {\n                product: {\n                    // @ts-ignore Model.getIdentifier is protected\n                    data: Model.getIdentifier(this.product),\n                },\n            },\n        };\n\n        if (this.line) {\n            data.id = this.line.id();\n        }\n\n        return data;\n    }\n}\n","import {Vnode} from 'mithril';\nimport app from 'flamarkt/backoffice/backoffice/app';\nimport Modal from 'flarum/common/components/Modal';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport SubmitButton from 'flamarkt/backoffice/backoffice/components/SubmitButton';\nimport PermanentDeleteButton from 'flamarkt/backoffice/backoffice/components/PermanentDeleteButton';\nimport Payment from '../../common/models/Payment';\nimport PriceInput from '../../common/components/PriceInput';\n\ninterface EditPaymentModalAttrs {\n    payment?: Payment\n}\n\n// @ts-ignore non-abstract className() method\nexport default class EditPaymentModal extends Modal {\n    payment!: Payment\n    method: string = ''\n    identifier: string = ''\n    amount: number = 0\n    dirty: boolean = false\n\n    oninit(vnode: Vnode<EditPaymentModalAttrs, this>) {\n        super.oninit(vnode);\n\n        if (vnode.attrs.payment) {\n            this.payment = vnode.attrs.payment;\n            this.method = this.payment.method() || '';\n            this.identifier = this.payment.identifier() || '';\n            this.amount = this.payment.amount() || 0;\n        } else {\n            // TODO: order relationship\n            this.payment = app.store.createRecord('flamarkt-payments');\n        }\n    }\n\n    content() {\n        return m('.Modal-body', this.fields().toArray());\n    }\n\n    fields(): ItemList<any> {\n        const fields = new ItemList();\n\n        fields.add('method', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.payments.field.method')),\n            m('input.FormControl', {\n                type: 'text',\n                value: this.method,\n                oninput: (event: Event) => {\n                    this.method = (event.target as HTMLInputElement).value;\n                    this.dirty = true;\n                },\n                disabled: this.loading,\n            }),\n        ]), 30);\n\n        fields.add('identifier', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.payments.field.identifier')),\n            m('input.FormControl', {\n                type: 'text',\n                value: this.identifier,\n                oninput: (event: Event) => {\n                    this.identifier = (event.target as HTMLInputElement).value;\n                    this.dirty = true;\n                },\n                disabled: this.loading,\n            }),\n        ]), 20);\n\n        fields.add('amount', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.payments.field.amount')),\n            m(PriceInput, {\n                value: this.amount,\n                onchange: (value: number) => {\n                    this.amount = value;\n                    this.dirty = true;\n                },\n                disabled: this.loading,\n            }),\n        ]), 10);\n\n        fields.add('submit', m('.Form-group', [\n            SubmitButton.component({\n                loading: this.loading,\n                dirty: this.dirty,\n                exists: this.payment.exists,\n            }),\n            ' ',\n            PermanentDeleteButton.component({\n                model: this.payment,\n                afterdelete() {\n                    // TODO: refresh order state\n                    app.modal.close();\n                },\n            }),\n        ]), -10);\n\n        return fields;\n    }\n\n    data() {\n        return {\n            method: this.method || null,\n            identifier: this.identifier || null,\n            amount: this.amount,\n        };\n    }\n\n    onsubmit(event: Event) {\n        event.preventDefault();\n\n        this.loading = true;\n\n        this.payment.save(this.data()).then(payment => {\n            this.payment = payment;\n            this.dirty = false;\n            this.loading = false;\n            m.redraw();\n        }, this.loaded.bind(this));\n    }\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport Button from 'flarum/common/components/Button';\nimport humanTime from 'flarum/common/helpers/humanTime';\nimport PriceLabel from '../../common/components/PriceLabel';\nimport Payment from '../../common/models/Payment';\nimport AbstractList from 'flamarkt/backoffice/backoffice/components/AbstractList';\nimport EditPaymentModal from './EditPaymentModal';\n\nexport default class PaymentList extends AbstractList<Payment> {\n    head() {\n        const columns = super.head();\n\n        columns.add('date', m('th', app.translator.trans('flamarkt-core.backoffice.payments.head.date')), 40);\n        columns.add('method', m('th', app.translator.trans('flamarkt-core.backoffice.payments.head.method')), 30);\n        columns.add('identifier', m('th', app.translator.trans('flamarkt-core.backoffice.payments.head.identifier')), 20);\n        columns.add('amount', m('th', app.translator.trans('flamarkt-core.backoffice.payments.head.amount')), 10);\n\n        return columns;\n    }\n\n    columns(payment: Payment) {\n        const columns = super.columns(payment);\n\n        columns.add('date', m('td', humanTime(payment.createdAt())), 40);\n        columns.add('method', m('td', payment.method()), 30);\n        columns.add('identifier', m('td', payment.identifier()), 20);\n        columns.add('amount', m('td', m(PriceLabel, {\n            value: payment.amount(),\n        })), 10);\n\n        return columns;\n    }\n\n    actions(payment: Payment) {\n        const actions = super.actions(payment);\n\n        actions.add('edit', Button.component({\n            className: 'Button Button--icon',\n            icon: 'fas fa-pen',\n            onclick() {\n                app.modal.show(EditPaymentModal, {\n                    payment,\n                });\n            },\n        }));\n\n        return actions;\n    }\n}\n","import AbstractListState, {Page} from 'flamarkt/backoffice/common/states/AbstractListState';\nimport Payment from '../../common/models/Payment';\nimport Order from '../../common/models/Order';\n\n/**\n * Allows using a List component with the relationship from the order object\n */\nexport default class PaymentListPassthroughState extends AbstractListState<Payment> {\n    type() {\n        return 'flamarkt-payments';\n    }\n\n    constructor(order: Order) {\n        super();\n\n        const payments = order.payments() as Payment[] | false;\n\n        this.loading = false;\n        this.pages = [\n            new Page<Payment>(1, payments || []),\n        ];\n    }\n}\n","import {Vnode} from 'mithril';\nimport app from 'flamarkt/backoffice/backoffice/app';\nimport Button from 'flarum/common/components/Button';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport User from 'flarum/common/models/User';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport AbstractShowPage from 'flamarkt/backoffice/common/pages/AbstractShowPage';\nimport Order from '../../common/models/Order';\nimport OrderLine from '../../common/models/OrderLine';\nimport Sortable from 'flamarkt/backoffice/common/components/Sortable';\nimport OrderLineEdit from '../components/OrderLineEdit';\nimport SubmitButton from 'flamarkt/backoffice/backoffice/components/SubmitButton';\nimport UserRelationshipSelect from 'flamarkt/backoffice/common/components/UserRelationshipSelect';\nimport OrderLineEditState from '../states/OrderLineEditState';\nimport SoftDeleteButton from 'flamarkt/backoffice/backoffice/components/SoftDeleteButton';\nimport PermanentDeleteButton from 'flamarkt/backoffice/backoffice/components/PermanentDeleteButton';\nimport PaymentList from '../components/PaymentList';\nimport PaymentListPassthroughState from '../states/PaymentListPassthroughState';\n\nexport default class OrderShowPage extends AbstractShowPage {\n    order: Order | null = null;\n    user: User | null = null;\n    lines: OrderLineEditState[] = [];\n    saving: boolean = false;\n    dirty: boolean = false;\n    newLine!: OrderLineEditState;\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.initNewLine();\n    }\n\n    initNewLine() {\n        this.newLine = new OrderLineEditState();\n    }\n\n    initLineState(line: OrderLine): OrderLineEditState {\n        const state = new OrderLineEditState();\n        state.init(line);\n        return state;\n    }\n\n    newRecord() {\n        return app.store.createRecord('flamarkt-orders');\n    }\n\n    findType() {\n        return 'flamarkt/orders';\n    }\n\n    show(order: Order) {\n        this.order = order;\n        this.user = order.user() || null;\n        this.lines = (order.lines() as OrderLine[] || []).map(this.initLineState.bind(this));\n\n        //app.setTitle(order.title());\n        app.setTitleCount(0);\n    }\n\n    view() {\n        if (!this.order) {\n            return LoadingIndicator.component();\n        }\n\n        return m('form.OrderShowPage', {\n            onsubmit: this.onsubmit.bind(this),\n        }, m('.container.container--narrow', this.fields().toArray()));\n    }\n\n    fields(): ItemList<any> {\n        const fields = new ItemList();\n\n        fields.add('number', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.orders.field.number')),\n            m('input.FormControl', {\n                value: this.order!.number(),\n                readonly: true,\n            })\n        ]), 30);\n\n        fields.add('user', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.orders.field.user')),\n            m(UserRelationshipSelect, {\n                relationship: this.user,\n                onchange: (user: User | null) => {\n                    this.user = user;\n                    this.dirty = true;\n                },\n                hasOne: true,\n            }),\n        ]), 20);\n\n        fields.add('lines', m('table.OrderComposerTable', [\n            m('thead', m('tr', this.tableHead().toArray())),\n            m(Sortable, {\n                containerTag: 'tbody',\n                placeholderTag: 'tr',\n                onsort: (origin, destination) => {\n                    this.lines.splice(destination, 0, ...this.lines.splice(origin, 1));\n                    this.dirty = true;\n                },\n            }, this.lines.map((line, index) => m(OrderLineEdit, {\n                key: line.uniqueFormKey,\n                line,\n                sortable: true,\n                control: Button.component({\n                    icon: 'fas fa-times',\n                    className: 'Button Button--icon Button--delete',\n                    onclick: () => {\n                        this.lines.splice(index, 1);\n                        this.dirty = true;\n                    },\n                    title: app.translator.trans('flamarkt-core.backoffice.orders.lines.control.delete'),\n                }),\n                onchange: () => {\n                    this.dirty = true;\n                },\n            }))),\n            m('tbody', m(OrderLineEdit, {\n                key: 'new',\n                line: this.newLine,\n                control: Button.component({\n                    icon: 'fas fa-plus',\n                    className: 'Button Button--icon',\n                    onclick: () => {\n                        //TODO: use onupdate on the edit line\n                        this.lines.push(this.newLine);\n                        this.dirty = true;\n\n                        this.initNewLine();\n                    },\n                    title: app.translator.trans('flamarkt-core.backoffice.orders.lines.control.add'),\n                }),\n                onchange: () => {\n                    this.dirty = true;\n                },\n            })),\n        ]), 10);\n\n        fields.add('submit', m('.Form-group', [\n            SubmitButton.component({\n                loading: this.saving,\n                dirty: this.dirty,\n                exists: this.order!.exists,\n            }),\n            ' ',\n            SoftDeleteButton.component({\n                model: this.order,\n            }),\n            ' ',\n            PermanentDeleteButton.component({\n                model: this.order,\n                afterdelete() {\n                    m.route.set(app.route('orders.index'));\n                },\n            }),\n        ]), -10);\n\n        fields.add('payments', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.payments.title')),\n            m(PaymentList, {\n                state: new PaymentListPassthroughState(this.order!),\n            }),\n        ]), -20);\n\n        return fields;\n    }\n\n    tableHead() {\n        const columns = new ItemList();\n\n        columns.add('handle', m('th'), 100);\n        columns.add('group', m('th', app.translator.trans('flamarkt-core.backoffice.orders.lines.head.group')), 90);\n        columns.add('type', m('th', app.translator.trans('flamarkt-core.backoffice.orders.lines.head.type')), 80);\n        columns.add('info', m('th', app.translator.trans('flamarkt-core.backoffice.orders.lines.head.info')), 30);\n        columns.add('priceUnit', m('th', app.translator.trans('flamarkt-core.backoffice.orders.lines.head.priceUnit')), -30);\n        columns.add('quantity', m('th', app.translator.trans('flamarkt-core.backoffice.orders.lines.head.quantity')), -60);\n        columns.add('priceTotal', m('th', app.translator.trans('flamarkt-core.backoffice.orders.lines.head.priceTotal')), -90);\n        columns.add('control', m('th'), -100);\n\n        return columns;\n    }\n\n    data() {\n        return {\n            relationships: {\n                lines: this.lines.map(line => {\n                    return {\n                        verbatim: true,\n                        type: 'flamarkt-product-lines',\n                        ...line.data(),\n                    };\n                }),\n                user: this.user,\n            },\n        };\n    }\n\n    onsubmit(event: Event) {\n        event.preventDefault();\n\n        this.saving = true;\n\n        this.saveThroughNewRecord<Order>(this.order?.id()!, this.data()).then(order => {\n            this.order = order;\n\n            this.saving = false;\n            this.dirty = false;\n            m.redraw();\n\n            m.route.set(app.route.order(order));\n        }).catch(error => {\n            this.saving = false;\n            m.redraw();\n        });\n    }\n}\n","import {Vnode} from 'mithril';\nimport app from 'flamarkt/backoffice/backoffice/app';\nimport Page from 'flarum/common/components/Page';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport extractText from 'flarum/common/utils/extractText';\nimport ProductList from '../components/ProductList';\nimport ProductListState from '../../common/states/ProductListState';\nimport ProductSortDropdown from '../../common/components/ProductSortDropdown';\n\nexport default class ProductIndexPage extends Page {\n    list!: ProductListState;\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.list = this.initState();\n        this.list.refresh();\n\n        app.setTitle(extractText(app.translator.trans('flamarkt-core.backoffice.products.title')));\n        app.setTitleCount(0);\n    }\n\n    initState() {\n        const params = m.route.param();\n\n        return new ProductListState({\n            sort: params.sort,\n        });\n    }\n\n    view() {\n        return m('.ProductIndexPage', m('.container', [\n            m('.Form-group', [\n                LinkButton.component({\n                    className: 'Button',\n                    href: app.route('products.show', {\n                        id: 'new',\n                    }),\n                }, app.translator.trans('flamarkt-core.backoffice.products.new')),\n                m(ProductSortDropdown, {\n                    state: this.list,\n                }),\n            ]),\n            m(ProductList, {\n                state: this.list,\n            }),\n        ]));\n    }\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport AbstractShowPage from 'flamarkt/backoffice/common/pages/AbstractShowPage';\nimport Product from '../../common/models/Product';\nimport SubmitButton from 'flamarkt/backoffice/backoffice/components/SubmitButton';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport TextEditor from 'flarum/common/components/TextEditor';\nimport Select from 'flarum/common/components/Select';\nimport SoftDeleteButton from 'flamarkt/backoffice/backoffice/components/SoftDeleteButton';\nimport PermanentDeleteButton from 'flamarkt/backoffice/backoffice/components/PermanentDeleteButton';\nimport PriceInput from '../../common/components/PriceInput';\n\nexport default class ProductShowPage extends AbstractShowPage {\n    product: Product | null = null;\n    saving: boolean = false;\n    dirty: boolean = false;\n    title: string = '';\n    description: string = '';\n    price: number = 0;\n    availabilityDriver: string | null = null;\n    priceDriver: string | null = null;\n\n    // We can't use the TextEditor component without having a composer object where the editor can be written to\n    composer = {\n        editor: null,\n    };\n\n    newRecord() {\n        return app.store.createRecord('flamarkt-products', {\n            // Necessary because some of the extensions read values with model.attribute(name)\n            // which errors if the attributes object is not defined\n            attributes: {},\n        });\n    }\n\n    findType() {\n        return 'flamarkt/products';\n    }\n\n    show(product: Product) {\n        this.product = product;\n        this.title = product.title() || '';\n        this.description = product.description() || '';\n        this.price = product.priceEdit() || 0;\n        this.availabilityDriver = product.attribute('availabilityDriver');\n        this.priceDriver = product.attribute('priceDriver');\n\n        //app.history.push('product', product.title());\n        // @ts-ignore\n        app.setTitle(product.title());\n        app.setTitleCount(0);\n    }\n\n    view() {\n        if (!this.product) {\n            return LoadingIndicator.component();\n        }\n\n        return m('form.ProductShowPage', {\n            onsubmit: this.onsubmit.bind(this),\n        }, m('.container.container--narrow', this.fields().toArray()));\n    }\n\n    fields(): ItemList<any> {\n        const fields = new ItemList();\n\n        // We need to patch our way through the global app object because of https://github.com/flarum/markdown/pull/28\n        // which made the markdown toolbar only work globally\n        // TODO: remove when possible\n        // @ts-ignore\n        app.composer = this.composer;\n\n        fields.add('title', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.products.field.title')),\n            m('input.FormControl', {\n                type: 'text',\n                value: this.title,\n                oninput: (event: Event) => {\n                    this.title = (event.target as HTMLInputElement).value;\n                    this.dirty = true;\n                },\n                disabled: this.saving,\n            }),\n        ]), 50);\n\n        fields.add('description', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.products.field.description')),\n            m('.FormControl.FormControl--editor', TextEditor.component({\n                value: this.description,\n                onchange: (value: string) => {\n                    this.description = value;\n                    this.dirty = true;\n\n                    m.redraw();\n                },\n                disabled: this.saving,\n                composer: this.composer,\n            })),\n        ]), 40);\n\n        fields.add('price', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.products.field.price')),\n            m(PriceInput, {\n                value: this.price,\n                onchange: (value: number) => {\n                    this.price = value;\n                    this.dirty = true;\n                },\n                disabled: this.saving,\n            }),\n        ]), 30);\n\n        fields.add('availabilityDriver', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.products.field.availabilityDriver')),\n            Select.component({\n                value: this.availabilityDriver || '_default',\n                options: this.availabilityDriverOptions(),\n                onchange: (value: string) => {\n                    this.availabilityDriver = value === '_default' ? null : value;\n                    this.dirty = true;\n                },\n            }),\n        ]), 20);\n\n        fields.add('priceDriver', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.products.field.priceDriver')),\n            Select.component({\n                value: this.priceDriver || '_default',\n                options: this.priceDriverOptions(),\n                onchange: (value: string) => {\n                    this.priceDriver = value === '_default' ? null : value;\n                    this.dirty = true;\n                },\n            }),\n        ]), 10);\n\n        fields.add('submit', m('.Form-group', [\n            SubmitButton.component({\n                loading: this.saving,\n                dirty: this.dirty,\n                exists: this.product!.exists,\n            }),\n            ' ',\n            SoftDeleteButton.component({\n                model: this.product,\n            }),\n            ' ',\n            PermanentDeleteButton.component({\n                model: this.product,\n                afterdelete() {\n                    m.route.set(app.route('products.index'));\n                },\n            }),\n        ]), -10);\n\n        return fields;\n    }\n\n    availabilityDriverOptions(): any {\n        const options: any = {\n            _default: 'Default',\n        };\n\n        (app.forum.attribute('flamarktAvailabilityDrivers') as string[] || []).forEach(driver => {\n            options[driver] = driver;\n        });\n\n        return options;\n    }\n\n    priceDriverOptions(): any {\n        const options: any = {\n            _default: 'Default',\n        };\n\n        (app.forum.attribute('flamarktPriceDrivers') as string[] || []).forEach(driver => {\n            options[driver] = driver;\n        });\n\n        return options;\n    }\n\n    data() {\n        return {\n            title: this.title,\n            description: this.description,\n            price: this.price,\n            availabilityDriver: this.availabilityDriver,\n            priceDriver: this.priceDriver,\n        };\n    }\n\n    onsubmit(event: Event) {\n        event.preventDefault();\n\n        this.saving = true;\n\n        // We can't use product.save() because Flarum updates the internal data object before saving\n        // Which interferes with the rendering of the Form that reads those values (including taxonomy fields and variants)\n        this.saveThroughNewRecord<Product>(this.product?.id()!, this.data()).then(product => {\n            this.product = product;\n\n            this.saving = false;\n            this.dirty = false;\n            m.redraw();\n\n            m.route.set(app.route.product(product));\n        }).catch(error => {\n            this.saving = false;\n            m.redraw();\n\n            throw error;\n        });\n    }\n}\n","import OrderLineEdit from './components/OrderLineEdit';\nimport OrderList from './components/OrderList';\nimport OrderRelationshipSelect from './components/OrderRelationshipSelect';\nimport ProductList from './components/ProductList';\nimport ProductRelationshipSelect from './components/ProductRelationshipSelect';\nimport OrderIndexPage from './pages/OrderIndexPage';\nimport OrderShowPage from './pages/OrderShowPage';\nimport ProductIndexPage from './pages/ProductIndexPage';\nimport ProductShowPage from './pages/ProductShowPage';\nimport OrderLineEditState from './states/OrderLineEditState';\n\nexport const backoffice = {\n    'components/OrderLineEdit': OrderLineEdit,\n    'components/OrderList': OrderList,\n    'components/OrderRelationshipSelect': OrderRelationshipSelect,\n    'components/ProductList': ProductList,\n    'components/ProductRelationshipSelect': ProductRelationshipSelect,\n    'pages/OrderIndexPage': OrderIndexPage,\n    'pages/OrderShowPage': OrderShowPage,\n    'pages/ProductIndexPage': ProductIndexPage,\n    'pages/ProductShowPage': ProductShowPage,\n    'states/OrderLineEditState': OrderLineEditState,\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport Model from 'flarum/common/Model';\nimport Order from '../common/models/Order';\nimport OrderLine from '../common/models/OrderLine';\nimport Payment from '../common/models/Payment';\nimport Product from '../common/models/Product';\nimport {common} from '../common/compat';\nimport {backoffice} from './compat';\nimport addNavLinks from './addNavLinks';\nimport addRoutes from './addRoutes';\nimport registerSettings from './registerSettings';\n\nexport {\n    common,\n    backoffice,\n};\n\napp.initializers.add('flamarkt-core', () => {\n    app.store.models['flamarkt-orders'] = Order;\n    app.store.models['flamarkt-order-lines'] = OrderLine;\n    app.store.models['flamarkt-payments'] = Payment;\n    app.store.models['flamarkt-products'] = Product;\n\n    // @ts-ignore no way to type-hint this at the moment\n    app.store.models.users.prototype.flamarktOrderCount = Model.attribute('flamarktOrderCount');\n\n    // Routes registration must be done before nav links\n    addRoutes();\n    addNavLinks();\n    registerSettings();\n});\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport ProductIndexPage from './pages/ProductIndexPage';\nimport ProductShowPage from './pages/ProductShowPage';\nimport OrderIndexPage from './pages/OrderIndexPage';\nimport OrderShowPage from './pages/OrderShowPage';\nimport Product from '../common/models/Product';\nimport Order from '../common/models/Order';\n\nexport default function () {\n    app.routes['products.index'] = {path: '/products', component: ProductIndexPage};\n    app.routes['products.show'] = {path: '/products/:id', component: ProductShowPage};\n    app.routes['orders.index'] = {path: '/orders', component: OrderIndexPage};\n    app.routes['orders.show'] = {path: '/orders/:id', component: OrderShowPage};\n\n    app.route.product = (product: Product) => {\n        return app.route('products.show', {\n            id: product.id(),\n        });\n    };\n    app.route.order = (order: Order) => {\n        return app.route('orders.show', {\n            id: order.id(),\n        });\n    };\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport {extend} from 'flarum/common/extend';\nimport BackofficeNav from 'flamarkt/backoffice/backoffice/components/BackofficeNav';\nimport ActiveLinkButton from \"flamarkt/backoffice/common/components/ActiveLinkButton\";\n\nexport default function () {\n    extend(BackofficeNav.prototype, 'items', function(items) {\n        items.add('products', ActiveLinkButton.component({\n            href: app.route('products.index'),\n            icon: 'fas fa-box',\n            activeRoutes: [\n                'products.*',\n            ],\n        }, app.translator.trans('flamarkt-core.backoffice.nav.products')), 40);\n\n        items.add('orders', ActiveLinkButton.component({\n            href: app.route('orders.index'),\n            icon: 'fas fa-shopping-cart',\n            activeRoutes: [\n                'orders.*',\n            ],\n        }, app.translator.trans('flamarkt-core.backoffice.nav.orders')), 20);\n    });\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport ExtensionPage from 'flarum/admin/components/ExtensionPage';\nimport Select from 'flarum/common/components/Select';\n\nexport default function () {\n    app.extensionData.for('flamarkt-core')\n        .registerSetting(function (this: ExtensionPage) {\n            const options: any = {};\n\n            (app.forum.attribute('flamarktAvailabilityDrivers') as string[] || []).forEach(driver => {\n                options[driver] = driver;\n            });\n\n            return m('.Form-group', [\n                m('label', app.translator.trans('flamarkt-core.backoffice.settings.defaultAvailabilityDriver')),\n                Select.component({\n                    value: this.setting('flamarkt.defaultAvailabilityDriver')() || 'never',\n                    options,\n                    onchange: this.setting('flamarkt.defaultAvailabilityDriver'),\n                }),\n            ]);\n        })\n        .registerSetting(function (this: ExtensionPage) {\n            const options: any = {};\n\n            (app.forum.attribute('flamarktPriceDrivers') as string[] || []).forEach(driver => {\n                options[driver] = driver;\n            });\n\n            return m('.Form-group', [\n                m('label', app.translator.trans('flamarkt-core.backoffice.settings.defaultPriceDriver')),\n                Select.component({\n                    value: this.setting('flamarkt.defaultPriceDriver')() || 'fixed',\n                    options,\n                    onchange: this.setting('flamarkt.defaultPriceDriver'),\n                }),\n            ]);\n        })\n        .registerSetting({\n            type: 'switch',\n            setting: 'flamarkt.forceOrderPrepayment',\n            label: app.translator.trans('flamarkt-core.backoffice.settings.forceOrderPrepayment'),\n        })\n        .registerPermission({\n            icon: 'fas fa-shopping-cart',\n            label: app.translator.trans('flamarkt-core.backoffice.permissions.shop'),\n            permission: 'flamarkt.shop',\n            allowGuest: true,\n        }, 'reply')\n        .registerPermission({\n            icon: 'fas fa-wrench',\n            label: app.translator.trans('flamarkt-core.backoffice.permissions.backoffice'),\n            permission: 'backoffice', // Intentionally not namespaced\n        }, 'moderate');\n}\n"],"sourceRoot":""}