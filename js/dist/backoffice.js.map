{"version":3,"file":"backoffice.js","mappings":"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","sources":["webpack://@flamarkt/core/webpack/bootstrap","webpack://@flamarkt/core/webpack/runtime/compat get default export","webpack://@flamarkt/core/webpack/runtime/define property getters","webpack://@flamarkt/core/webpack/runtime/hasOwnProperty shorthand","webpack://@flamarkt/core/webpack/runtime/make namespace object","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['app']\"","webpack://@flamarkt/core/external root \"flarum.core.compat['common/Model']\"","webpack://@flamarkt/core/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flamarkt/core/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flamarkt/core/external root \"flarum.core.compat['common/Component']\"","webpack://@flamarkt/core/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@flamarkt/core/./src/common/components/DecimalInput.ts","webpack://@flamarkt/core/./src/common/components/DecimalLabel.ts","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/AbstractSortDropdown']\"","webpack://@flamarkt/core/./src/common/components/OrderSortDropdown.ts","webpack://@flamarkt/core/external root \"flarum.core.compat['common/app']\"","webpack://@flamarkt/core/./src/common/components/PriceInput.ts","webpack://@flamarkt/core/./src/common/components/PriceLabel.ts","webpack://@flamarkt/core/./src/common/components/ProductSortDropdown.ts","webpack://@flamarkt/core/./src/common/components/QuantityInput.ts","webpack://@flamarkt/core/./src/common/components/QuantityLabel.ts","webpack://@flamarkt/core/./src/common/models/Cart.ts","webpack://@flamarkt/core/./src/forum/utils/DateFormat.ts","webpack://@flamarkt/core/./src/common/models/Order.ts","webpack://@flamarkt/core/./src/common/models/OrderLine.ts","webpack://@flamarkt/core/./src/common/models/Payment.ts","webpack://@flamarkt/core/./src/common/models/Product.ts","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['states/AbstractListState']\"","webpack://@flamarkt/core/./src/common/states/OrderListState.ts","webpack://@flamarkt/core/./src/common/states/ProductListState.ts","webpack://@flamarkt/core/./src/common/compat.js","webpack://@flamarkt/core/./src/common/helpers/formatPrice.ts","webpack://@flamarkt/core/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@flamarkt/core/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/SubmitButton']\"","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/PermanentDeleteButton']\"","webpack://@flamarkt/core/./src/backoffice/components/EditPaymentModal.ts","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/SortableHandle']\"","webpack://@flamarkt/core/external root \"flarum.core.compat['common/components/Select']\"","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/AbstractRelationshipSelect']\"","webpack://@flamarkt/core/external root \"flarum.core.compat['common/helpers/highlight']\"","webpack://@flamarkt/core/./src/backoffice/components/ProductRelationshipSelect.ts","webpack://@flamarkt/core/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@flamarkt/core/./src/backoffice/utils/augmentOptionsWithValue.ts","webpack://@flamarkt/core/./src/backoffice/utils/OrderLineOptions.ts","webpack://@flamarkt/core/./src/backoffice/components/OrderLineEdit.ts","webpack://@flamarkt/core/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/AbstractList']\"","webpack://@flamarkt/core/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@flamarkt/core/external root \"flarum.core.compat['common/helpers/humanTime']\"","webpack://@flamarkt/core/./src/backoffice/components/OrderList.ts","webpack://@flamarkt/core/external root \"flarum.core.compat['common/components/Button']\"","webpack://@flamarkt/core/./src/backoffice/components/PaymentList.ts","webpack://@flamarkt/core/./src/backoffice/states/PaymentListPassthroughState.ts","webpack://@flamarkt/core/./src/backoffice/components/OrderPaymentSection.ts","webpack://@flamarkt/core/./src/backoffice/components/OrderRelationshipSelect.ts","webpack://@flamarkt/core/./src/backoffice/components/ProductList.ts","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/SearchInput']\"","webpack://@flamarkt/core/external root \"flarum.core.compat['common/components/Page']\"","webpack://@flamarkt/core/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@flamarkt/core/./src/backoffice/pages/OrderIndexPage.ts","webpack://@flamarkt/core/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['pages/AbstractShowPage']\"","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/Sortable']\"","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/UserRelationshipSelect']\"","webpack://@flamarkt/core/./src/backoffice/states/OrderLineEditState.ts","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/SoftDeleteButton']\"","webpack://@flamarkt/core/./src/backoffice/pages/OrderShowPage.ts","webpack://@flamarkt/core/./src/backoffice/pages/ProductIndexPage.ts","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/RichTextInput']\"","webpack://@flamarkt/core/./src/backoffice/pages/ProductShowPage.ts","webpack://@flamarkt/core/./src/backoffice/compat.js","webpack://@flamarkt/core/external root \"flarum.core.compat['common/extend']\"","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/BackofficeNav']\"","webpack://@flamarkt/core/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/ActiveLinkButton']\"","webpack://@flamarkt/core/./src/backoffice/index.ts","webpack://@flamarkt/core/./src/common/addModels.ts","webpack://@flamarkt/core/./src/backoffice/addRoutes.ts","webpack://@flamarkt/core/./src/backoffice/addNavLinks.ts","webpack://@flamarkt/core/./src/backoffice/registerSettings.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","import Component, {ComponentAttrs} from 'flarum/common/Component';\nimport classList from 'flarum/common/utils/classList';\nimport Product from '../models/Product';\n\nexport interface DecimalInputAttrs extends ComponentAttrs {\n    value: number\n    onchange: (value: number) => void\n    disabled?: boolean\n    readonly?: boolean\n    product?: Product\n    unit?: string\n    min?: number\n    max?: number\n    step?: number\n    decimals?: number\n    className?: string\n}\n\nexport default class DecimalInput<T extends DecimalInputAttrs = DecimalInputAttrs> extends Component<T> {\n    hasFocus: boolean = false\n\n    decimals(): number {\n        return this.attrs.decimals || 0;\n    }\n\n    min(): number | undefined {\n        return this.attrs.min;\n    }\n\n    max(): number | undefined {\n        return this.attrs.max;\n    }\n\n    step(): number | undefined {\n        return this.attrs.step;\n    }\n\n    disabled(): boolean {\n        return !!this.attrs.disabled;\n    }\n\n    readonly(): boolean {\n        return !!this.attrs.readonly;\n    }\n\n    className(): any[] {\n        return [{\n            focused: this.hasFocus,\n        }, this.attrs.className];\n    }\n\n    fromIntegerValue(value: number): number {\n        return value / Math.pow(10, this.decimals());\n    }\n\n    toIntegerValue(value: number): number {\n        return Math.round(value * Math.pow(10, this.decimals()));\n    }\n\n    inputAttrs() {\n        const inputAttrs: any = {\n            type: 'number',\n            value: this.fromIntegerValue(this.attrs.value) + '', // Cast to string to preserve zero\n            onchange: (event: Event) => {\n                const value = parseFloat((event.target as HTMLInputElement).value);\n\n                this.attrs.onchange(this.toIntegerValue(value));\n            },\n            onfocus: () => {\n                this.hasFocus = true;\n            },\n            onblur: () => {\n                this.hasFocus = false;\n            },\n            disabled: this.disabled(),\n            readonly: this.readonly(),\n        };\n\n        const min = this.min();\n\n        if (typeof min !== 'undefined') {\n            inputAttrs.min = this.fromIntegerValue(min);\n        }\n\n        const max = this.max();\n\n        if (typeof max !== 'undefined') {\n            inputAttrs.max = this.fromIntegerValue(max);\n        }\n\n        const step = this.step();\n\n        if (typeof step !== 'undefined') {\n            inputAttrs.step = this.fromIntegerValue(step);\n        } else if (this.decimals() > 0) {\n            inputAttrs.step = 1 / Math.pow(10, this.decimals());\n        }\n\n        return inputAttrs;\n    }\n\n    unitLabel(): string {\n        return '';\n    }\n\n    view() {\n        const label = this.unitLabel();\n\n        return m('.FlamarktDecimalInput.FormControl', {\n            className: classList(this.className()),\n        }, [\n            m('input', this.inputAttrs()),\n            label ? m('.FlamarktDecimalInputUnit', {\n                onclick: () => {\n                    this.$('input').focus();\n                },\n            }, label) : null,\n        ]);\n    }\n}\n","import {Children} from 'mithril';\nimport Component, {ComponentAttrs} from 'flarum/common/Component';\nimport Product from '../models/Product';\n\nexport interface DecimalLabelAttrs extends ComponentAttrs {\n    value: number\n    product?: Product\n    unit?: string\n    decimals?: number\n}\n\nexport default class DecimalLabel<T extends DecimalLabelAttrs = DecimalLabelAttrs> extends Component<T> {\n    decimals(): number {\n        return this.attrs.decimals || 0;\n    }\n\n    fromIntegerValue(value: number): number {\n        return value / Math.pow(10, this.decimals());\n    }\n\n    view(): Children {\n        return this.fromIntegerValue(this.attrs.value).toFixed(this.decimals());\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/AbstractSortDropdown'];","import AbstractSortDropdown, {SortDropdownAttrs, SortOptions} from 'flamarkt/backoffice/common/components/AbstractSortDropdown';\nimport OrderListState from '../states/OrderListState';\n\nexport interface OrderSortDropdownAttrs extends SortDropdownAttrs {\n    list: OrderListState\n}\n\nexport default class OrderSortDropdown extends AbstractSortDropdown<OrderSortDropdownAttrs> {\n    className(): string {\n        return 'OrderSortDropdown';\n    }\n\n    options(): SortOptions {\n        return {\n            '-createdAt': 'Newest',\n            'createdAt': 'Oldest',\n            '-priceTotal': 'Highest total',\n            'priceTotal': 'Lowest total',\n        };\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","import app from 'flarum/common/app';\nimport DecimalInput from './DecimalInput';\n\nexport default class PriceInput extends DecimalInput {\n    decimals(): number {\n        return app.forum.attribute('priceDecimals');\n    }\n\n    className(): any[] {\n        return ['FlamarktPriceInput', ...super.className()];\n    }\n\n    unitLabel(): string {\n        return app.forum.attribute('priceUnit');\n    }\n}\n","import app from 'flarum/common/app';\nimport DecimalLabel, {DecimalLabelAttrs} from './DecimalLabel';\n\nexport interface PriceLabelAttrs extends DecimalLabelAttrs {\n    hint?: string // A text designed to help with extensibility\n}\n\nexport default class PriceLabel<T extends PriceLabelAttrs = PriceLabelAttrs> extends DecimalLabel<T> {\n    decimals(): number {\n        return app.forum.attribute('priceDecimals');\n    }\n\n    view(): any {\n        return [\n            super.view(),\n            ' ',\n            app.forum.attribute('priceUnit'),\n        ];\n    }\n}\n","import app from 'flarum/common/app';\nimport AbstractSortDropdown, {SortDropdownAttrs, SortOptions} from 'flamarkt/backoffice/common/components/AbstractSortDropdown';\nimport ProductListState from '../states/ProductListState';\n\nexport interface ProductSortDropdownAttrs extends SortDropdownAttrs {\n    list: ProductListState\n}\n\nexport default class ProductSortDropdown extends AbstractSortDropdown<ProductSortDropdownAttrs> {\n    className(): string {\n        return 'ProductSortDropdown';\n    }\n\n    options(): SortOptions {\n        return {\n            '-createdAt': app.translator.trans('flamarkt-core.lib.sort.products.createdAtDesc') as string,\n            'createdAt': app.translator.trans('flamarkt-core.lib.sort.products.createdAtAsc') as string,\n            'price': app.translator.trans('flamarkt-core.lib.sort.products.priceAsc') as string,\n            '-price': app.translator.trans('flamarkt-core.lib.sort.products.priceDesc') as string,\n            'title': app.translator.trans('flamarkt-core.lib.sort.products.titleAsc') as string,\n            '-title': app.translator.trans('flamarkt-core.lib.sort.products.titleDesc') as string,\n        };\n    }\n}\n","import DecimalInput from './DecimalInput';\n\nexport default class QuantityInput extends DecimalInput {\n    //\n}\n","import DecimalLabel from './DecimalLabel';\n\nexport default class QuantityLabel extends DecimalLabel {\n    //\n}\n","import Model from 'flarum/common/Model';\nimport Product from './Product';\n\nexport default class Cart extends Model {\n    productCount = Model.attribute<number>('productCount');\n    priceTotal = Model.attribute<number>('priceTotal');\n    amountDueAfterPartial = Model.attribute<number>('amountDueAfterPartial');\n    canAddProducts = Model.attribute<boolean>('canAddProducts');\n    canCheckout = Model.attribute<boolean>('canCheckout');\n\n    products = Model.hasMany<Product>('products');\n\n    priceTotalLocal(): number {\n        return (this.products() || []).reduce((total, product) => total + (product ? product.cartPriceTotalLocal() : 0), 0);\n    }\n\n    apiEndpoint() {\n        // @ts-ignore data.id not type-hinted for non-existent models\n        return '/flamarkt/carts' + (this.exists ? '/' + this.data.id : '');\n    }\n}\n","// The date format is hard-coded but exposed here, so it can be easily overridden with custom code\nexport default {\n    // The default format to use\n    defaultFormat(): string {\n        return 'YYYY-MM-DD';\n    },\n\n    // The format used as part of titles to indicate which day an order is for\n    orderDayFormat(): string {\n        return this.defaultFormat();\n    },\n\n    // The format used in the list of payments to indicate which day a particular payment was made\n    paymentDayFormat(): string {\n        return this.defaultFormat();\n    },\n}\n","import Model from 'flarum/common/Model';\nimport User from 'flarum/common/models/User';\nimport OrderLine from './OrderLine';\nimport Payment from './Payment';\nimport DateFormat from '../../forum/utils/DateFormat';\n\nexport default class Order extends Model {\n    number = Model.attribute('number');\n    slug = Model.attribute('slug');\n    productCount = Model.attribute('productCount');\n    priceTotal = Model.attribute('priceTotal');\n    paidAmount = Model.attribute('paidAmount');\n    createdAt = Model.attribute('createdAt', Model.transformDate);\n    isHidden = Model.attribute<boolean>('isHidden');\n\n    user = Model.hasOne<User>('user');\n    lines = Model.hasMany<OrderLine>('lines');\n    payments = Model.hasMany<Payment>('payments');\n\n    titleDate(): string {\n        const date = this.createdAt();\n\n        if (date) {\n            return dayjs(date).format(DateFormat.orderDayFormat());\n        }\n\n        return '<not dated>';\n    }\n\n    apiEndpoint() {\n        // @ts-ignore data.id not type-hinted for non-existent models\n        return '/flamarkt/orders' + (this.exists ? '/' + this.data.id : '');\n    }\n}\n","import Model from 'flarum/common/Model';\nimport Product from './Product';\n\nexport default class OrderLine extends Model {\n    number = Model.attribute<number>('number');\n    group = Model.attribute<string | null>('group');\n    type = Model.attribute<string | null>('type');\n    label = Model.attribute<string | null>('label');\n    comment = Model.attribute<string | null>('comment');\n    quantity = Model.attribute<number | null>('quantity');\n    priceUnit = Model.attribute<number | null>('priceUnit');\n    priceTotal = Model.attribute<number | null>('priceTotal');\n\n    product = Model.hasOne<Product>('product');\n}\n","import Model from 'flarum/common/Model';\n\nexport default class Payment extends Model {\n    method = Model.attribute<string | null>('method');\n    identifier = Model.attribute<string | null>('identifier');\n    amount = Model.attribute<number | null>('amount');\n    createdAt = Model.attribute('createdAt', Model.transformDate);\n    isHidden = Model.attribute<boolean>('isHidden');\n\n    apiEndpoint() {\n        // @ts-ignore data.id not type-hinted for non-existent models\n        return '/flamarkt/payments' + (this.exists ? '/' + this.data.id : '');\n    }\n}\n","import Model from 'flarum/common/Model';\n\nexport default class Product extends Model {\n    title = Model.attribute<string>('title');\n    slug = Model.attribute('slug');\n    description = Model.attribute<string | null>('description');\n    descriptionHtml = Model.attribute<string | null>('descriptionHtml');\n    price = Model.attribute<number | null>('price');\n    priceEdit = Model.attribute<number | null>('priceEdit');\n    cartQuantity = Model.attribute<number | null>('cartQuantity');\n    isHidden = Model.attribute<boolean>('isHidden');\n    canAddToCart = Model.attribute<number | null>('canAddToCart');\n    /**\n     * @deprecated Use canAddToCart instead. Behaviour will probably change in the future to differentiate products that can be added to cart but not actually ordered.\n     */\n    canOrder = Model.attribute<number | null>('canOrder');\n    canEdit = Model.attribute<number | null>('canEdit');\n\n    cartPriceTotalLocal(): number {\n        if (!this.price || !this.cartQuantity) {\n            return 0;\n        }\n\n        // @ts-ignore Wrong Model.attribute typings\n        return this.price() * this.cartQuantity();\n    }\n\n    apiEndpoint() {\n        return '/flamarkt/products' + (this.exists ? '/' + (this.data as any).id : '');\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['states/AbstractListState'];","import AbstractListState from 'flamarkt/backoffice/common/states/AbstractListState';\nimport Order from '../models/Order';\n\nexport default class OrderListState extends AbstractListState<Order> {\n    type() {\n        return 'flamarkt/orders';\n    }\n}\n","import AbstractListState from 'flamarkt/backoffice/common/states/AbstractListState';\nimport Product from '../models/Product';\n\nexport default class ProductListState extends AbstractListState<Product> {\n    type() {\n        return 'flamarkt/products';\n    }\n}\n","import DecimalInput from './components/DecimalInput';\nimport DecimalLabel from './components/DecimalLabel';\nimport OrderSortDropdown from './components/OrderSortDropdown';\nimport PriceInput from './components/PriceInput';\nimport PriceLabel from './components/PriceLabel';\nimport ProductSortDropdown from './components/ProductSortDropdown';\nimport QuantityInput from './components/QuantityInput';\nimport QuantityLabel from './components/QuantityLabel';\nimport formatPrice from './helpers/formatPrice';\nimport Cart from './models/Cart';\nimport Order from './models/Order';\nimport OrderLine from './models/OrderLine';\nimport Payment from './models/Payment';\nimport Product from './models/Product';\nimport OrderListState from './states/OrderListState';\nimport ProductListState from './states/ProductListState';\n\nexport const common = {\n    'components/DecimalInput': DecimalInput,\n    'components/DecimalLabel': DecimalLabel,\n    'components/OrderSortDropdown': OrderSortDropdown,\n    'components/PriceInput': PriceInput,\n    'components/PriceLabel': PriceLabel,\n    'components/ProductSortDropdown': ProductSortDropdown,\n    'components/QuantityInput': QuantityInput,\n    'components/QuantityLabel': QuantityLabel,\n    'helpers/formatPrice': formatPrice,\n    'models/Cart': Cart,\n    'models/Order': Order,\n    'models/OrderLine': OrderLine,\n    'models/Payment': Payment,\n    'models/Product': Product,\n    'states/OrderListState': OrderListState,\n    'states/ProductListState': ProductListState,\n}\n","import app from 'flarum/common/app';\n\n/**\n * @deprecated replaced with PriceLabel\n */\nexport default function (price: any) {\n    // Keep price as-it if not a number, this allows passing vdom or hard-coded string\n    if (price === parseInt(price)) {\n        price = (price / Math.pow(10, app.forum.attribute('priceDecimals'))).toFixed(app.forum.attribute('priceDecimals'));\n    }\n\n    return [price, ' ' + app.forum.attribute('priceUnit')];\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/SubmitButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/PermanentDeleteButton'];","import {Vnode} from 'mithril';\nimport app from 'flamarkt/backoffice/backoffice/app';\nimport Modal from 'flarum/common/components/Modal';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport SubmitButton from 'flamarkt/backoffice/backoffice/components/SubmitButton';\nimport PermanentDeleteButton from 'flamarkt/backoffice/backoffice/components/PermanentDeleteButton';\nimport Payment from '../../common/models/Payment';\nimport PriceInput from '../../common/components/PriceInput';\n\ninterface EditPaymentModalAttrs {\n    payment?: Payment\n}\n\n// @ts-ignore non-abstract className() method\nexport default class EditPaymentModal extends Modal {\n    payment!: Payment\n    method: string = ''\n    identifier: string = ''\n    amount: number = 0\n    dirty: boolean = false\n\n    oninit(vnode: Vnode<EditPaymentModalAttrs, this>) {\n        super.oninit(vnode);\n\n        if (vnode.attrs.payment) {\n            this.payment = vnode.attrs.payment;\n            this.method = this.payment.method() || '';\n            this.identifier = this.payment.identifier() || '';\n            this.amount = this.payment.amount() || 0;\n        } else {\n            // TODO: order relationship\n            this.payment = app.store.createRecord('flamarkt-payments');\n        }\n    }\n\n    content() {\n        return m('.Modal-body', this.fields().toArray());\n    }\n\n    fields(): ItemList<any> {\n        const fields = new ItemList();\n\n        fields.add('method', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.payments.field.method')),\n            m('input.FormControl', {\n                type: 'text',\n                value: this.method,\n                oninput: (event: Event) => {\n                    this.method = (event.target as HTMLInputElement).value;\n                    this.dirty = true;\n                },\n                disabled: this.loading,\n            }),\n        ]), 30);\n\n        fields.add('identifier', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.payments.field.identifier')),\n            m('input.FormControl', {\n                type: 'text',\n                value: this.identifier,\n                oninput: (event: Event) => {\n                    this.identifier = (event.target as HTMLInputElement).value;\n                    this.dirty = true;\n                },\n                disabled: this.loading,\n            }),\n        ]), 20);\n\n        fields.add('amount', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.payments.field.amount')),\n            m(PriceInput, {\n                value: this.amount,\n                onchange: (value: number) => {\n                    this.amount = value;\n                    this.dirty = true;\n                },\n                disabled: this.loading,\n            }),\n        ]), 10);\n\n        fields.add('submit', m('.Form-group', [\n            SubmitButton.component({\n                loading: this.loading,\n                dirty: this.dirty,\n                exists: this.payment.exists,\n            }),\n            ' ',\n            PermanentDeleteButton.component({\n                model: this.payment,\n                afterdelete() {\n                    // TODO: refresh order state\n                    app.modal.close();\n                },\n            }),\n        ]), -10);\n\n        return fields;\n    }\n\n    data() {\n        return {\n            method: this.method || null,\n            identifier: this.identifier || null,\n            amount: this.amount,\n        };\n    }\n\n    onsubmit(event: Event) {\n        event.preventDefault();\n\n        this.loading = true;\n\n        this.payment.save(this.data()).then(payment => {\n            this.payment = payment;\n            this.dirty = false;\n            this.loading = false;\n            m.redraw();\n        }, this.loaded.bind(this));\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/SortableHandle'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Select'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/AbstractRelationshipSelect'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/highlight'];","import app from 'flamarkt/backoffice/backoffice/app';\nimport AbstractRelationshipSelect from 'flamarkt/backoffice/common/components/AbstractRelationshipSelect';\nimport highlight from 'flarum/common/helpers/highlight';\nimport Product from '../../common/models/Product';\n\nexport default class ProductRelationshipSelect extends AbstractRelationshipSelect<Product> {\n    protected resultsCache = new Map<string, Product[]>();\n\n    search(query: string) {\n        if (!query) {\n            m.redraw();\n            return Promise.resolve();\n        }\n\n        return app.store\n            .find<Product[]>('flamarkt/products', {\n                filter: {q: query},\n                page: {limit: 5},\n            })\n            .then((results) => {\n                this.resultsCache.set(query, results);\n                m.redraw();\n            });\n    }\n\n    results(query: string) {\n        if (!query) {\n            return [];\n        }\n\n        query = query.toLowerCase();\n\n        const results = this.resultsCache.get(query);\n\n        // Indicates still loading\n        if (typeof results === 'undefined') {\n            return null;\n        }\n\n        return (results || [])\n            .concat(\n                app.store\n                    .all<Product>('flamarkt-products')\n                    .filter(product => product.title().toLowerCase().substr(0, query.length) === query)\n            )\n            .filter((e, i, arr) => arr.lastIndexOf(e) === i)\n            .sort((a, b) => a.title().localeCompare(b.title()));\n    }\n\n    item(product: Product, query?: string) {\n        return [\n            query ? highlight(product.title(), query) : product.title(),\n        ];\n    }\n}\n","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","export default function (options: { [key: string]: string }, value: string | undefined | null) {\n    // If value is invalid, don't add it\n    if (!value) {\n        return options;\n    }\n\n    // If value is already a valid option, don't add it\n    if (Object.keys(options).indexOf(value) !== -1) {\n        return options;\n    }\n\n    // Add the value as an option\n    return {\n        ...options,\n        [value]: value,\n    };\n}\n","// We export those values as methods on a simple object to make them easy to extend and later translate\nexport default {\n    orderLineGroupOptions(): { [key: string]: string } {\n        return {\n            _none: 'None',\n            shipping: 'Shipping',\n        };\n    },\n    orderLineTypeOptions(): { [key: string]: string } {\n        return {\n            product: 'Product',\n            manual: 'Manual',\n        };\n    },\n}\n","import {Attributes, ClassComponent, Vnode} from 'mithril';\nimport SortableHandle from 'flamarkt/backoffice/common/components/SortableHandle';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Select from 'flarum/common/components/Select';\nimport ProductRelationshipSelect from './ProductRelationshipSelect';\nimport Product from '../../common/models/Product';\nimport OrderLineEditState from '../states/OrderLineEditState';\nimport PriceInput from '../../common/components/PriceInput';\nimport QuantityInput from '../../common/components/QuantityInput';\nimport PriceLabel from '../../common/components/PriceLabel';\nimport augmentOptionsWithValue from '../utils/augmentOptionsWithValue';\nimport OrderLineOptions from '../utils/OrderLineOptions';\n\ninterface OrderLineAttrs extends Attributes {\n    line: OrderLineEditState\n    sortable?: boolean\n    control: Vnode\n    onchange: () => void\n}\n\nexport default class OrderLineEdit implements ClassComponent<OrderLineAttrs> {\n    view(vnode: Vnode<OrderLineAttrs>) {\n        const {line, control, onchange, sortable, style, ondragstart} = vnode.attrs;\n\n        return m('tr', {\n            // Copy over attrs from Sortable component\n            style,\n            'data-index': vnode.attrs['data-index'],\n            ondragstart,\n        }, this.columns(line, control, onchange, sortable).toArray());\n    }\n\n    columns(line: OrderLineEditState, control: Vnode, onchange: () => void, sortable?: boolean): ItemList<any> {\n        const columns = new ItemList();\n\n        columns.add('handle', m('td.OrderLineEdit-Handle', sortable ? m(SortableHandle) : null), 100);\n        columns.add('group', m('td.OrderLineEdit-Group', Select.component({\n            value: line.group === null ? '_none' : line.group,\n            onchange: (value: string) => {\n                line.group = value === '_none' ? null : value;\n                onchange();\n            },\n            options: augmentOptionsWithValue(OrderLineOptions.orderLineGroupOptions(), line.group),\n        })), 90);\n        columns.add('type', m('td.OrderLineEdit-Type', Select.component({\n            value: line.type,\n            onchange: (value: string) => {\n                line.type = value;\n                onchange();\n            },\n            options: augmentOptionsWithValue(OrderLineOptions.orderLineTypeOptions(), line.type),\n        })), 80);\n        columns.add('info', m('td.OrderLineEdit-Info', this.fields(line, onchange).toArray()), 30);\n        columns.add('priceUnit', m('td.OrderLineEdit-PriceUnit', m(PriceInput, {\n            value: line.priceUnit,\n            onchange: (value: number) => {\n                line.priceUnit = value;\n                line.updateTotal();\n                onchange();\n            },\n            product: line.product,\n        })), -30);\n        columns.add('quantity', m('td.OrderLineEdit-Quantity', m(QuantityInput, {\n            value: line.quantity,\n            onchange: (value: number) => {\n                line.quantity = value;\n                line.updateTotal();\n                onchange();\n            },\n            product: line.product,\n        })), -60);\n        columns.add('priceTotal', m('td.OrderLineEdit-PriceTotal', m(PriceLabel, {\n            value: line.priceTotal,\n            product: line.product,\n        })), -90);\n        columns.add('control', m('td.OrderLineEdit-Controls', control), -100);\n\n        return columns;\n    }\n\n    showInfoProduct(line: OrderLineEditState) {\n        return line.type === 'product';\n    }\n\n    showInfoLabel(line: OrderLineEditState) {\n        return line.type === 'manual';\n    }\n\n    showInfoComment(line: OrderLineEditState) {\n        return line.type === 'product' || line.type === 'manual';\n    }\n\n    fields(line: OrderLineEditState, onchange: () => void): ItemList<any> {\n        const fields = new ItemList();\n\n        if (this.showInfoProduct(line)) {\n            fields.add('product', m('.Form-group', [\n                m('label', 'Product'),\n                m(ProductRelationshipSelect, {\n                    relationship: line.product,\n                    onchange: (product: Product | null) => {\n                        line.product = product;\n                        onchange();\n                    },\n                    hasOne: true,\n                }),\n            ]));\n        }\n\n        if (this.showInfoLabel(line)) {\n            fields.add('label', m('.Form-group', [\n                m('label', 'Label'),\n                m('input.FormControl', {\n                    type: 'text',\n                    value: line.label,\n                    onchange: (event: Event) => {\n                        line.label = (event.target as HTMLInputElement).value;\n                        onchange();\n                    },\n                }),\n            ]));\n        }\n\n        if (this.showInfoComment(line)) {\n            fields.add('comment', m('.Form-group', [\n                m('label', 'Comment'),\n                m('textarea.FormControl', {\n                    value: line.comment,\n                    onchange: (event: Event) => {\n                        line.comment = (event.target as HTMLInputElement).value;\n                        onchange();\n                    },\n                }),\n            ]));\n        }\n\n        return fields;\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/AbstractList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/humanTime'];","import app from 'flamarkt/backoffice/backoffice/app';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport AbstractList from 'flamarkt/backoffice/backoffice/components/AbstractList';\nimport Order from '../../common/models/Order';\nimport username from 'flarum/common/helpers/username';\nimport humanTime from 'flarum/common/helpers/humanTime';\nimport PriceLabel from '../../common/components/PriceLabel';\n\nexport default class OrderList extends AbstractList<Order> {\n    head() {\n        const columns = super.head();\n\n        columns.add('number', m('th', app.translator.trans('flamarkt-core.backoffice.orders.head.number')), 50);\n        columns.add('date', m('th', app.translator.trans('flamarkt-core.backoffice.orders.head.date')), 40);\n        columns.add('user', m('th', app.translator.trans('flamarkt-core.backoffice.orders.head.user')), 30);\n        columns.add('priceTotal', m('th', app.translator.trans('flamarkt-core.backoffice.orders.head.priceTotal')), 20);\n        columns.add('paidAmount', m('th', app.translator.trans('flamarkt-core.backoffice.orders.head.paidAmount')), 10);\n        columns.add('productCount', m('th', app.translator.trans('flamarkt-core.backoffice.orders.head.productCount')), 5);\n\n        return columns;\n    }\n\n    columns(order: Order) {\n        const columns = super.columns(order);\n\n        columns.add('number', m('td', order.number()), 50);\n        columns.add('date', m('td', humanTime(order.createdAt())), 40);\n        columns.add('user', m('td', username(order.user())), 30);\n        columns.add('priceTotal', m('td', m(PriceLabel, {\n            value: order.priceTotal(),\n        })), 20);\n        columns.add('paidAmount', m('td', m(PriceLabel, {\n            value: order.paidAmount(),\n        })), 10);\n        columns.add('productCount', m('td', order.productCount()), 5);\n\n        return columns;\n    }\n\n    actions(order: Order) {\n        const actions = super.actions(order);\n\n        actions.add('edit', LinkButton.component({\n            className: 'Button Button--icon',\n            icon: 'fas fa-pen',\n            href: app.route.order(order),\n        }));\n\n        return actions;\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","import app from 'flamarkt/backoffice/backoffice/app';\nimport Button from 'flarum/common/components/Button';\nimport humanTime from 'flarum/common/helpers/humanTime';\nimport PriceLabel from '../../common/components/PriceLabel';\nimport Payment from '../../common/models/Payment';\nimport AbstractList from 'flamarkt/backoffice/backoffice/components/AbstractList';\nimport EditPaymentModal from './EditPaymentModal';\n\nexport default class PaymentList extends AbstractList<Payment> {\n    head() {\n        const columns = super.head();\n\n        columns.add('date', m('th', app.translator.trans('flamarkt-core.backoffice.payments.head.date')), 40);\n        columns.add('method', m('th', app.translator.trans('flamarkt-core.backoffice.payments.head.method')), 30);\n        columns.add('identifier', m('th', app.translator.trans('flamarkt-core.backoffice.payments.head.identifier')), 20);\n        columns.add('amount', m('th', app.translator.trans('flamarkt-core.backoffice.payments.head.amount')), 10);\n\n        return columns;\n    }\n\n    columns(payment: Payment) {\n        const columns = super.columns(payment);\n\n        columns.add('date', m('td', humanTime(payment.createdAt())), 40);\n        columns.add('method', m('td', payment.method()), 30);\n        columns.add('identifier', m('td', payment.identifier()), 20);\n        columns.add('amount', m('td', m(PriceLabel, {\n            value: payment.amount(),\n        })), 10);\n\n        return columns;\n    }\n\n    actions(payment: Payment) {\n        const actions = super.actions(payment);\n\n        actions.add('edit', Button.component({\n            className: 'Button Button--icon',\n            icon: 'fas fa-pen',\n            onclick() {\n                app.modal.show(EditPaymentModal, {\n                    payment,\n                });\n            },\n        }));\n\n        return actions;\n    }\n}\n","import AbstractListState, {Page} from 'flamarkt/backoffice/common/states/AbstractListState';\nimport Payment from '../../common/models/Payment';\nimport Order from '../../common/models/Order';\n\n/**\n * Allows using a List component with the relationship from the order object\n */\nexport default class PaymentListPassthroughState extends AbstractListState<Payment> {\n    type() {\n        return 'flamarkt-payments';\n    }\n\n    constructor(order: Order) {\n        super();\n\n        const payments = order.payments() as Payment[] | false;\n\n        this.loading = false;\n        this.pages = [\n            new Page<Payment>(1, payments || []),\n        ];\n    }\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport Component from 'flarum/common/Component';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport PaymentList from './PaymentList';\nimport PaymentListPassthroughState from '../states/PaymentListPassthroughState';\nimport Order from '../../common/models/Order';\nimport PriceLabel from '../../common/components/PriceLabel';\n\nexport interface OrderPaymentSectionAttrs {\n    order: Order\n}\n\nexport default class OrderPaymentSection extends Component<OrderPaymentSectionAttrs> {\n    view() {\n        return m('.OrderPaymentSection', this.fields().toArray());\n    }\n\n    fields(): ItemList<any> {\n        const fields = new ItemList();\n\n        const {order} = this.attrs;\n\n        fields.add('title', m('h3', app.translator.trans('flamarkt-core.backoffice.payments.title')), 100);\n\n        fields.add('totals', m('.Form-group.OrderPaymentSectionTotals', [\n            'Due: ',\n            m(PriceLabel, {\n                value: order.priceTotal(),\n            }),\n            ' / Paid: ',\n            m(PriceLabel, {\n                value: order.paidAmount(),\n            }),\n        ]), 100);\n\n        fields.add('payments', m('.Form-group', [\n            m(PaymentList, {\n                state: new PaymentListPassthroughState(order),\n            }),\n        ]), 0);\n\n        return fields;\n    }\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport AbstractRelationshipSelect from 'flamarkt/backoffice/common/components/AbstractRelationshipSelect';\nimport highlight from 'flarum/common/helpers/highlight';\nimport Order from '../../common/models/Order';\n\nexport default class OrderRelationshipSelect extends AbstractRelationshipSelect<Order> {\n    protected resultsCache = new Map<string, Order[]>();\n\n    search(query: string) {\n        if (!query) {\n            m.redraw();\n            return Promise.resolve();\n        }\n\n        return app.store\n            .find('flamarkt/orders', {\n                filter: {q: query},\n                page: {limit: 5},\n            })\n            .then((results) => {\n                this.resultsCache.set(query, results);\n                m.redraw();\n            });\n    }\n\n    results(query: string) {\n        if (!query) {\n            return [];\n        }\n\n        query = query.toLowerCase();\n\n        const results = this.resultsCache.get(query);\n\n        // Indicates still loading\n        if (typeof results === 'undefined') {\n            return null;\n        }\n\n        return results || [];\n    }\n\n    item(order: Order, query?: string) {\n        return [\n            query ? highlight(order.number(), query) : order.number(),\n        ];\n    }\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport AbstractList from 'flamarkt/backoffice/backoffice/components/AbstractList';\nimport Product from '../../common/models/Product';\n\nexport default class ProductList extends AbstractList<Product> {\n    head() {\n        const columns = super.head();\n\n        columns.add('title', m('th', app.translator.trans('flamarkt-core.backoffice.products.head.title')), 10);\n\n        return columns;\n    }\n\n    columns(product: Product) {\n        const columns = super.columns(product);\n\n        columns.add('title', m('td', product.title()), 10);\n\n        return columns;\n    }\n\n    actions(product: Product) {\n        const actions = super.actions(product);\n\n        actions.add('edit', LinkButton.component({\n            className: 'Button Button--icon',\n            icon: 'fas fa-pen',\n            href: app.route.product(product),\n        }));\n\n        return actions;\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/SearchInput'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","import {Vnode} from 'mithril';\nimport app from 'flamarkt/backoffice/backoffice/app';\nimport SearchInput from 'flamarkt/backoffice/backoffice/components/SearchInput';\nimport Page from 'flarum/common/components/Page';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport extractText from 'flarum/common/utils/extractText';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport OrderListState from '../../common/states/OrderListState';\nimport OrderList from '../components/OrderList';\nimport OrderSortDropdown from '../../common/components/OrderSortDropdown';\n\nexport default class OrderIndexPage extends Page {\n    list!: OrderListState;\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.list = this.initState();\n        this.list.refresh();\n\n        app.setTitle(extractText(app.translator.trans('flamarkt-core.backoffice.orders.title')));\n        app.setTitleCount(0);\n    }\n\n    initState() {\n        const pageParams = m.route.param();\n\n        const params: any = {\n            sort: pageParams.sort,\n        }\n\n        if (pageParams.user) {\n            params.filter = params.filter || {};\n            params.filter.user = pageParams.user;\n        }\n\n        return new OrderListState(params);\n    }\n\n    filters() {\n        const items = new ItemList();\n\n        items.add('sort', m(OrderSortDropdown, {\n            list: this.list,\n        }), 100);\n\n        items.add('search', m(SearchInput, {\n            initialValue: '',\n            onchange: (value: string) => {\n                this.list.params.q = value;\n                this.list.refresh();\n            },\n            placeholder: extractText(app.translator.trans('flamarkt-core.backoffice.orders.searchPlaceholder')),\n        }), 50);\n\n        items.add('separator', m('.BackofficeListFilters--separator'), -10);\n\n        items.add('new', LinkButton.component({\n            className: 'Button',\n            href: app.route('orders.show', {\n                id: 'new',\n            }),\n        }, app.translator.trans('flamarkt-core.backoffice.orders.new')), -100);\n\n        return items;\n    }\n\n    view() {\n        return m('.OrderIndexPage', m('.container', [\n            m('.BackofficeListFilters', this.filters().toArray()),\n            m(OrderList, {\n                list: this.list,\n            }),\n        ]));\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['pages/AbstractShowPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/Sortable'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/UserRelationshipSelect'];","import OrderLine from '../../common/models/OrderLine';\nimport Product from '../../common/models/Product';\nimport Model from 'flarum/common/Model';\n\nlet uniqueKey = 0;\n\nexport default class OrderLineEditState {\n    uniqueFormKey: string\n    line?: OrderLine\n    group: string | null = null\n    type: string | null = null\n    label: string = '';\n    comment: string = '';\n    quantity: number = 0\n    priceUnit: number = 0\n    priceTotal: number = 0\n    product: Product | null = null\n\n    constructor() {\n        // Used as the Mithril key for re-order operations\n        this.uniqueFormKey = ++uniqueKey + '';\n    }\n\n    init(line: OrderLine) {\n        this.line = line;\n        this.group = line.group() || null;\n        this.type = line.type() || null;\n        this.label = line.label() || '';\n        this.comment = line.comment() || '';\n        this.quantity = line.quantity() || 0;\n        this.priceUnit = line.priceUnit() || 0;\n        this.priceTotal = line.priceTotal() || 0;\n        this.product = line.product() || null;\n    }\n\n    updateTotal() {\n        this.priceTotal = this.quantity * this.priceUnit;\n    }\n\n    data(): any {\n        const data: any = {\n            attributes: {\n                group: this.group,\n                type: this.type,\n                label: this.label,\n                comment: this.comment,\n                quantity: this.quantity,\n                priceUnit: this.priceUnit,\n                // priceTotal intentionally not sent, it's computed again server-side\n            },\n            relationships: {\n                product: {\n                    // @ts-ignore Model.getIdentifier is protected\n                    data: Model.getIdentifier(this.product),\n                },\n            },\n        };\n\n        if (this.line) {\n            data.id = this.line.id();\n        }\n\n        return data;\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/SoftDeleteButton'];","import {Vnode} from 'mithril';\nimport app from 'flamarkt/backoffice/backoffice/app';\nimport Button from 'flarum/common/components/Button';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport User from 'flarum/common/models/User';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport AbstractShowPage from 'flamarkt/backoffice/common/pages/AbstractShowPage';\nimport Order from '../../common/models/Order';\nimport OrderLine from '../../common/models/OrderLine';\nimport Sortable from 'flamarkt/backoffice/common/components/Sortable';\nimport OrderLineEdit from '../components/OrderLineEdit';\nimport SubmitButton from 'flamarkt/backoffice/backoffice/components/SubmitButton';\nimport UserRelationshipSelect from 'flamarkt/backoffice/common/components/UserRelationshipSelect';\nimport OrderLineEditState from '../states/OrderLineEditState';\nimport SoftDeleteButton from 'flamarkt/backoffice/backoffice/components/SoftDeleteButton';\nimport PermanentDeleteButton from 'flamarkt/backoffice/backoffice/components/PermanentDeleteButton';\nimport OrderPaymentSection from '../components/OrderPaymentSection';\n\nexport default class OrderShowPage extends AbstractShowPage {\n    order: Order | null = null;\n    user: User | null = null;\n    lines: OrderLineEditState[] = [];\n    saving: boolean = false;\n    dirty: boolean = false;\n    newLine!: OrderLineEditState;\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.initNewLine();\n    }\n\n    initNewLine() {\n        this.newLine = new OrderLineEditState();\n    }\n\n    initLineState(line: OrderLine): OrderLineEditState {\n        const state = new OrderLineEditState();\n        state.init(line);\n        return state;\n    }\n\n    newRecord() {\n        return app.store.createRecord('flamarkt-orders');\n    }\n\n    findType() {\n        return 'flamarkt/orders';\n    }\n\n    show(order: Order) {\n        this.order = order;\n        this.user = order.user() || null;\n        this.lines = (order.lines() as OrderLine[] || []).map(this.initLineState.bind(this));\n\n        //app.setTitle(order.title());\n        app.setTitleCount(0);\n    }\n\n    view() {\n        if (!this.order) {\n            return LoadingIndicator.component();\n        }\n\n        return m('form.OrderShowPage', {\n            onsubmit: this.onsubmit.bind(this),\n        }, m('.container', this.fields().toArray()));\n    }\n\n    fields(): ItemList<any> {\n        const fields = new ItemList();\n\n        fields.add('number', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.orders.field.number')),\n            m('input.FormControl', {\n                value: this.order!.number(),\n                readonly: true,\n            })\n        ]), 30);\n\n        fields.add('user', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.orders.field.user')),\n            m(UserRelationshipSelect, {\n                relationship: this.user,\n                onchange: (user: User | null) => {\n                    this.user = user;\n                    this.dirty = true;\n                },\n                hasOne: true,\n            }),\n        ]), 20);\n\n        fields.add('lines', m('table.OrderComposerTable', [\n            m('thead', m('tr', this.tableHead().toArray())),\n            m(Sortable, {\n                containerTag: 'tbody',\n                placeholderTag: 'tr',\n                onsort: (origin, destination) => {\n                    this.lines.splice(destination, 0, ...this.lines.splice(origin, 1));\n                    this.dirty = true;\n                },\n            }, this.lines.map((line, index) => m(OrderLineEdit, {\n                key: line.uniqueFormKey,\n                line,\n                sortable: true,\n                control: Button.component({\n                    icon: 'fas fa-times',\n                    className: 'Button Button--icon Button--delete',\n                    onclick: () => {\n                        this.lines.splice(index, 1);\n                        this.dirty = true;\n                    },\n                    title: app.translator.trans('flamarkt-core.backoffice.orders.lines.control.delete'),\n                }),\n                onchange: () => {\n                    this.dirty = true;\n                },\n            }))),\n            m('tbody', m(OrderLineEdit, {\n                key: 'new',\n                line: this.newLine,\n                control: Button.component({\n                    icon: 'fas fa-plus',\n                    className: 'Button Button--icon',\n                    onclick: () => {\n                        //TODO: use onupdate on the edit line\n                        this.lines.push(this.newLine);\n                        this.dirty = true;\n\n                        this.initNewLine();\n                    },\n                    title: app.translator.trans('flamarkt-core.backoffice.orders.lines.control.add'),\n                }),\n                onchange: () => {\n                    this.dirty = true;\n                },\n            })),\n        ]), 10);\n\n        fields.add('submit', m('.Form-group', [\n            SubmitButton.component({\n                loading: this.saving,\n                dirty: this.dirty,\n                exists: this.order!.exists,\n            }),\n            ' ',\n            SoftDeleteButton.component({\n                model: this.order,\n            }),\n            ' ',\n            PermanentDeleteButton.component({\n                model: this.order,\n                afterdelete() {\n                    m.route.set(app.route('orders.index'));\n                },\n            }),\n        ]), -10);\n\n        fields.add('payments', m(OrderPaymentSection, {\n            order: this.order,\n        }), -20);\n\n        return fields;\n    }\n\n    tableHead() {\n        const columns = new ItemList();\n\n        columns.add('handle', m('th'), 100);\n        columns.add('group', m('th', app.translator.trans('flamarkt-core.backoffice.orders.lines.head.group')), 90);\n        columns.add('type', m('th', app.translator.trans('flamarkt-core.backoffice.orders.lines.head.type')), 80);\n        columns.add('info', m('th', app.translator.trans('flamarkt-core.backoffice.orders.lines.head.info')), 30);\n        columns.add('priceUnit', m('th', app.translator.trans('flamarkt-core.backoffice.orders.lines.head.priceUnit')), -30);\n        columns.add('quantity', m('th', app.translator.trans('flamarkt-core.backoffice.orders.lines.head.quantity')), -60);\n        columns.add('priceTotal', m('th', app.translator.trans('flamarkt-core.backoffice.orders.lines.head.priceTotal')), -90);\n        columns.add('control', m('th'), -100);\n\n        return columns;\n    }\n\n    data() {\n        return {\n            relationships: {\n                lines: this.lines.map(line => {\n                    return {\n                        verbatim: true,\n                        type: 'flamarkt-product-lines',\n                        ...line.data(),\n                    };\n                }),\n                user: this.user,\n            },\n        };\n    }\n\n    onsubmit(event: Event) {\n        event.preventDefault();\n\n        this.saving = true;\n\n        this.saveThroughNewRecord<Order>(this.order?.id()!, this.data()).then(order => {\n            this.order = order;\n\n            this.saving = false;\n            this.dirty = false;\n            m.redraw();\n\n            m.route.set(app.route.order(order));\n        }).catch(error => {\n            this.saving = false;\n            m.redraw();\n        });\n    }\n}\n","import {Vnode} from 'mithril';\nimport app from 'flamarkt/backoffice/backoffice/app';\nimport SearchInput from 'flamarkt/backoffice/backoffice/components/SearchInput';\nimport Page from 'flarum/common/components/Page';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport extractText from 'flarum/common/utils/extractText';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport ProductList from '../components/ProductList';\nimport ProductListState from '../../common/states/ProductListState';\nimport ProductSortDropdown from '../../common/components/ProductSortDropdown';\n\nexport default class ProductIndexPage extends Page {\n    list!: ProductListState;\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.list = this.initState();\n        this.list.refresh();\n\n        app.setTitle(extractText(app.translator.trans('flamarkt-core.backoffice.products.title')));\n        app.setTitleCount(0);\n    }\n\n    initState() {\n        const params = m.route.param();\n\n        return new ProductListState({\n            sort: params.sort,\n        });\n    }\n\n    filters() {\n        const items = new ItemList();\n\n        items.add('sort', m(ProductSortDropdown, {\n            list: this.list,\n        }), 100);\n\n        items.add('search', m(SearchInput, {\n            initialValue: '',\n            onchange: (value: string) => {\n                this.list.params.q = value;\n                this.list.refresh();\n            },\n            placeholder: extractText(app.translator.trans('flamarkt-core.backoffice.products.searchPlaceholder')),\n        }), 50);\n\n        items.add('separator', m('.BackofficeListFilters--separator'), -10);\n\n        items.add('new', LinkButton.component({\n            className: 'Button',\n            href: app.route('products.show', {\n                id: 'new',\n            }),\n        }, app.translator.trans('flamarkt-core.backoffice.products.new')), -100);\n\n        return items;\n    }\n\n    view() {\n        return m('.ProductIndexPage', m('.container', [\n            m('.BackofficeListFilters', this.filters().toArray()),\n            m(ProductList, {\n                list: this.list,\n            }),\n        ]));\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/RichTextInput'];","import app from 'flamarkt/backoffice/backoffice/app';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport AbstractShowPage from 'flamarkt/backoffice/common/pages/AbstractShowPage';\nimport Product from '../../common/models/Product';\nimport SubmitButton from 'flamarkt/backoffice/backoffice/components/SubmitButton';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Select from 'flarum/common/components/Select';\nimport SoftDeleteButton from 'flamarkt/backoffice/backoffice/components/SoftDeleteButton';\nimport PermanentDeleteButton from 'flamarkt/backoffice/backoffice/components/PermanentDeleteButton';\nimport RichTextInput from 'flamarkt/backoffice/backoffice/components/RichTextInput';\nimport PriceInput from '../../common/components/PriceInput';\n\nexport default class ProductShowPage extends AbstractShowPage {\n    product: Product | null = null;\n    saving: boolean = false;\n    dirty: boolean = false;\n    title: string = '';\n    description: string = '';\n    price: number = 0;\n    availabilityDriver: string | null = null;\n    priceDriver: string | null = null;\n\n    newRecord() {\n        return app.store.createRecord('flamarkt-products', {\n            // Necessary because some of the extensions read values with model.attribute(name)\n            // which errors if the attributes object is not defined\n            attributes: {},\n        });\n    }\n\n    findType() {\n        return 'flamarkt/products';\n    }\n\n    show(product: Product) {\n        this.product = product;\n        this.title = product.title() || '';\n        this.description = product.description() || '';\n        this.price = product.priceEdit() || 0;\n        this.availabilityDriver = product.attribute('availabilityDriver');\n        this.priceDriver = product.attribute('priceDriver');\n\n        //app.history.push('product', product.title());\n        // @ts-ignore\n        app.setTitle(product.title());\n        app.setTitleCount(0);\n    }\n\n    view() {\n        if (!this.product) {\n            return LoadingIndicator.component();\n        }\n\n        return m('form.ProductShowPage', {\n            onsubmit: this.onsubmit.bind(this),\n        }, m('.container.container--narrow', this.fields().toArray()));\n    }\n\n    fields(): ItemList<any> {\n        const fields = new ItemList();\n\n        fields.add('title', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.products.field.title')),\n            m('input.FormControl', {\n                type: 'text',\n                value: this.title,\n                oninput: (event: Event) => {\n                    this.title = (event.target as HTMLInputElement).value;\n                    this.dirty = true;\n                },\n                disabled: this.saving,\n            }),\n        ]), 50);\n\n        fields.add('description', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.products.field.description')),\n            m(RichTextInput, {\n                value: this.description,\n                onchange: (value: string) => {\n                    this.description = value;\n                    this.dirty = true;\n\n                    m.redraw();\n                },\n                disabled: this.saving,\n            }),\n        ]), 40);\n\n        fields.add('price', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.products.field.price')),\n            m(PriceInput, {\n                value: this.price,\n                onchange: (value: number) => {\n                    this.price = value;\n                    this.dirty = true;\n                },\n                disabled: this.saving,\n            }),\n        ]), 30);\n\n        fields.add('availabilityDriver', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.products.field.availabilityDriver')),\n            Select.component({\n                value: this.availabilityDriver || '_default',\n                options: this.availabilityDriverOptions(),\n                onchange: (value: string) => {\n                    this.availabilityDriver = value === '_default' ? null : value;\n                    this.dirty = true;\n                },\n            }),\n        ]), 20);\n\n        fields.add('priceDriver', m('.Form-group', [\n            m('label', app.translator.trans('flamarkt-core.backoffice.products.field.priceDriver')),\n            Select.component({\n                value: this.priceDriver || '_default',\n                options: this.priceDriverOptions(),\n                onchange: (value: string) => {\n                    this.priceDriver = value === '_default' ? null : value;\n                    this.dirty = true;\n                },\n            }),\n        ]), 10);\n\n        fields.add('submit', m('.Form-group', [\n            SubmitButton.component({\n                loading: this.saving,\n                dirty: this.dirty,\n                exists: this.product!.exists,\n            }),\n            ' ',\n            SoftDeleteButton.component({\n                model: this.product,\n            }),\n            ' ',\n            PermanentDeleteButton.component({\n                model: this.product,\n                afterdelete() {\n                    m.route.set(app.route('products.index'));\n                },\n            }),\n        ]), -10);\n\n        return fields;\n    }\n\n    availabilityDriverOptions(): any {\n        const options: any = {\n            _default: 'Default',\n        };\n\n        (app.forum.attribute('flamarktAvailabilityDrivers') as string[] || []).forEach(driver => {\n            options[driver] = driver;\n        });\n\n        return options;\n    }\n\n    priceDriverOptions(): any {\n        const options: any = {\n            _default: 'Default',\n        };\n\n        (app.forum.attribute('flamarktPriceDrivers') as string[] || []).forEach(driver => {\n            options[driver] = driver;\n        });\n\n        return options;\n    }\n\n    data() {\n        return {\n            title: this.title,\n            description: this.description,\n            price: this.price,\n            availabilityDriver: this.availabilityDriver,\n            priceDriver: this.priceDriver,\n        };\n    }\n\n    onsubmit(event: Event) {\n        event.preventDefault();\n\n        this.saving = true;\n\n        // We can't use product.save() because Flarum updates the internal data object before saving\n        // Which interferes with the rendering of the Form that reads those values (including taxonomy fields and variants)\n        this.saveThroughNewRecord<Product>(this.product?.id()!, this.data()).then(product => {\n            this.product = product;\n\n            this.saving = false;\n            this.dirty = false;\n            m.redraw();\n\n            m.route.set(app.route.product(product));\n        }).catch(error => {\n            this.saving = false;\n            m.redraw();\n\n            throw error;\n        });\n    }\n}\n","import EditPaymentModal from './components/EditPaymentModal';\nimport OrderLineEdit from './components/OrderLineEdit';\nimport OrderList from './components/OrderList';\nimport OrderPaymentSection from './components/OrderPaymentSection';\nimport OrderRelationshipSelect from './components/OrderRelationshipSelect';\nimport PaymentList from './components/PaymentList';\nimport ProductList from './components/ProductList';\nimport ProductRelationshipSelect from './components/ProductRelationshipSelect';\nimport OrderIndexPage from './pages/OrderIndexPage';\nimport OrderShowPage from './pages/OrderShowPage';\nimport ProductIndexPage from './pages/ProductIndexPage';\nimport ProductShowPage from './pages/ProductShowPage';\nimport OrderLineEditState from './states/OrderLineEditState';\nimport PaymentListPassthroughState from './states/PaymentListPassthroughState';\nimport augmentOptionsWithValue from './utils/augmentOptionsWithValue';\nimport OrderLineOptions from './utils/OrderLineOptions';\n\nexport const backoffice = {\n    'components/EditPaymentModal': EditPaymentModal,\n    'components/OrderLineEdit': OrderLineEdit,\n    'components/OrderList': OrderList,\n    'components/OrderPaymentSection': OrderPaymentSection,\n    'components/OrderRelationshipSelect': OrderRelationshipSelect,\n    'components/PaymentList': PaymentList,\n    'components/ProductList': ProductList,\n    'components/ProductRelationshipSelect': ProductRelationshipSelect,\n    'pages/OrderIndexPage': OrderIndexPage,\n    'pages/OrderShowPage': OrderShowPage,\n    'pages/ProductIndexPage': ProductIndexPage,\n    'pages/ProductShowPage': ProductShowPage,\n    'states/OrderLineEditState': OrderLineEditState,\n    'states/PaymentListPassthroughState': PaymentListPassthroughState,\n    'utils/augmentOptionsWithValue': augmentOptionsWithValue,\n    'utils/OrderLineOptions': OrderLineOptions,\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/BackofficeNav'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/ActiveLinkButton'];","import app from 'flamarkt/backoffice/backoffice/app';\nimport Model from 'flarum/common/Model';\nimport {common} from '../common/compat';\nimport {backoffice} from './compat';\nimport addModels from '../common/addModels';\nimport addNavLinks from './addNavLinks';\nimport addRoutes from './addRoutes';\nimport registerSettings from './registerSettings';\n\nexport {\n    common,\n    backoffice,\n};\n\napp.initializers.add('flamarkt-core', () => {\n    addModels();\n\n    // @ts-ignore no way to type-hint this at the moment\n    app.store.models.users.prototype.flamarktOrderCount = Model.attribute('flamarktOrderCount');\n\n    // Routes registration must be done before nav links\n    addRoutes();\n    addNavLinks();\n    registerSettings();\n});\n","import app from 'flarum/common/app';\nimport Cart from './models/Cart';\nimport Order from './models/Order';\nimport OrderLine from './models/OrderLine';\nimport Payment from './models/Payment';\nimport Product from './models/Product';\n\nexport default function () {\n    app.store.models['flamarkt-carts'] = Cart;\n    app.store.models['flamarkt-orders'] = Order;\n    app.store.models['flamarkt-order-lines'] = OrderLine;\n    app.store.models['flamarkt-payments'] = Payment;\n    app.store.models['flamarkt-products'] = Product;\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport ProductIndexPage from './pages/ProductIndexPage';\nimport ProductShowPage from './pages/ProductShowPage';\nimport OrderIndexPage from './pages/OrderIndexPage';\nimport OrderShowPage from './pages/OrderShowPage';\nimport Product from '../common/models/Product';\nimport Order from '../common/models/Order';\n\nexport default function () {\n    app.routes['products.index'] = {path: '/products', component: ProductIndexPage};\n    app.routes['products.show'] = {path: '/products/:id', component: ProductShowPage};\n    app.routes['orders.index'] = {path: '/orders', component: OrderIndexPage};\n    app.routes['orders.show'] = {path: '/orders/:id', component: OrderShowPage};\n\n    app.route.product = (product: Product) => {\n        return app.route('products.show', {\n            id: product.id(),\n        });\n    };\n    app.route.order = (order: Order) => {\n        return app.route('orders.show', {\n            id: order.id(),\n        });\n    };\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport {extend} from 'flarum/common/extend';\nimport BackofficeNav from 'flamarkt/backoffice/backoffice/components/BackofficeNav';\nimport ActiveLinkButton from \"flamarkt/backoffice/common/components/ActiveLinkButton\";\n\nexport default function () {\n    extend(BackofficeNav.prototype, 'items', function(items) {\n        items.add('products', ActiveLinkButton.component({\n            href: app.route('products.index'),\n            icon: 'fas fa-box',\n            activeRoutes: [\n                'products.*',\n            ],\n        }, app.translator.trans('flamarkt-core.backoffice.nav.products')), 40);\n\n        items.add('orders', ActiveLinkButton.component({\n            href: app.route('orders.index'),\n            icon: 'fas fa-shopping-cart',\n            activeRoutes: [\n                'orders.*',\n            ],\n        }, app.translator.trans('flamarkt-core.backoffice.nav.orders')), 20);\n    });\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport ExtensionPage from 'flarum/admin/components/ExtensionPage';\nimport Select from 'flarum/common/components/Select';\n\nexport default function () {\n    app.extensionData.for('flamarkt-core')\n        .registerSetting(function (this: ExtensionPage) {\n            const options: any = {};\n\n            (app.forum.attribute('flamarktAvailabilityDrivers') as string[] || []).forEach(driver => {\n                options[driver] = driver;\n            });\n\n            return m('.Form-group', [\n                m('label', app.translator.trans('flamarkt-core.backoffice.settings.defaultAvailabilityDriver')),\n                Select.component({\n                    value: this.setting('flamarkt.defaultAvailabilityDriver')() || 'never',\n                    options,\n                    onchange: this.setting('flamarkt.defaultAvailabilityDriver'),\n                }),\n            ]);\n        })\n        .registerSetting(function (this: ExtensionPage) {\n            const options: any = {};\n\n            (app.forum.attribute('flamarktPriceDrivers') as string[] || []).forEach(driver => {\n                options[driver] = driver;\n            });\n\n            return m('.Form-group', [\n                m('label', app.translator.trans('flamarkt-core.backoffice.settings.defaultPriceDriver')),\n                Select.component({\n                    value: this.setting('flamarkt.defaultPriceDriver')() || 'fixed',\n                    options,\n                    onchange: this.setting('flamarkt.defaultPriceDriver'),\n                }),\n            ]);\n        })\n        .registerSetting({\n            type: 'switch',\n            setting: 'flamarkt.forceOrderPrepayment',\n            label: app.translator.trans('flamarkt-core.backoffice.settings.forceOrderPrepayment'),\n        })\n        .registerPermission({\n            icon: 'fas fa-shopping-cart',\n            label: app.translator.trans('flamarkt-core.backoffice.permissions.browse'),\n            permission: 'flamarkt.browse',\n            allowGuest: true,\n        }, 'reply')\n        .registerPermission({\n            icon: 'fas fa-shopping-cart',\n            label: app.translator.trans('flamarkt-core.backoffice.permissions.cart'),\n            permission: 'flamarkt.cart',\n            // allowGuest: true, // Planned, but currently not technically possible, needs carts that belongs to guests\n        }, 'reply')\n        .registerPermission({\n            icon: 'fas fa-shopping-cart',\n            label: app.translator.trans('flamarkt-core.backoffice.permissions.checkout'),\n            permission: 'flamarkt.checkout',\n            // allowGuest: true, // Add once carts can be used by guests\n        }, 'reply')\n        .registerPermission({\n            icon: 'fas fa-wrench',\n            label: app.translator.trans('flamarkt-core.backoffice.permissions.backoffice'),\n            permission: 'backoffice', // Intentionally not namespaced\n        }, 'moderate');\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","extensions","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","DecimalInput","hasFocus","decimals","this","attrs","min","max","step","disabled","readonly","className","focused","fromIntegerValue","Math","pow","toIntegerValue","round","inputAttrs","type","onchange","event","parseFloat","target","onfocus","onblur","unitLabel","view","label","m","classList","onclick","$","focus","Component","DecimalLabel","toFixed","OrderSortDropdown","options","AbstractSortDropdown","PriceInput","app","PriceLabel","ProductSortDropdown","QuantityInput","QuantityLabel","Cart","productCount","Model","priceTotal","amountDueAfterPartial","canAddProducts","canCheckout","products","priceTotalLocal","reduce","total","product","cartPriceTotalLocal","apiEndpoint","exists","data","id","defaultFormat","orderDayFormat","paymentDayFormat","Order","number","slug","paidAmount","createdAt","isHidden","user","lines","payments","titleDate","date","dayjs","format","DateFormat","OrderLine","group","comment","quantity","priceUnit","Payment","method","identifier","amount","Product","title","description","descriptionHtml","price","priceEdit","cartQuantity","canAddToCart","canOrder","canEdit","OrderListState","AbstractListState","ProductListState","common","parseInt","EditPaymentModal","payment","dirty","oninit","vnode","content","fields","toArray","ItemList","add","oninput","loading","SubmitButton","PermanentDeleteButton","model","afterdelete","onsubmit","preventDefault","save","then","redraw","loaded","Modal","ProductRelationshipSelect","resultsCache","Map","search","query","filter","q","page","limit","results","set","Promise","resolve","toLowerCase","concat","substr","length","e","i","arr","lastIndexOf","sort","b","localeCompare","item","highlight","AbstractRelationshipSelect","_extends","assign","arguments","source","apply","keys","indexOf","orderLineGroupOptions","_none","shipping","orderLineTypeOptions","manual","OrderLineEdit","line","control","sortable","style","ondragstart","columns","SortableHandle","Select","augmentOptionsWithValue","OrderLineOptions","updateTotal","showInfoProduct","showInfoLabel","showInfoComment","relationship","hasOne","OrderList","head","order","humanTime","username","actions","LinkButton","icon","href","AbstractList","PaymentList","Button","PaymentListPassthroughState","pages","Page","OrderPaymentSection","state","OrderRelationshipSelect","ProductList","OrderIndexPage","list","initState","refresh","extractText","pageParams","route","param","params","filters","items","SearchInput","initialValue","placeholder","uniqueKey","OrderLineEditState","uniqueFormKey","init","attributes","relationships","OrderShowPage","saving","newLine","initNewLine","initLineState","newRecord","findType","show","map","LoadingIndicator","UserRelationshipSelect","tableHead","Sortable","containerTag","placeholderTag","onsort","origin","destination","splice","index","push","SoftDeleteButton","verbatim","saveThroughNewRecord","error","AbstractShowPage","ProductIndexPage","ProductShowPage","availabilityDriver","priceDriver","attribute","RichTextInput","availabilityDriverOptions","priceDriverOptions","_default","forEach","driver","backoffice","path","component","extend","BackofficeNav","ActiveLinkButton","activeRoutes","registerSetting","setting","registerPermission","permission","allowGuest"],"sourceRoot":""}