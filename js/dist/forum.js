(()=>{var t={n:r=>{var n=r&&r.__esModule?()=>r.default:()=>r;return t.d(n,{a:n}),n},d:(r,n)=>{for(var o in n)t.o(n,o)&&!t.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:n[o]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},r={};(()=>{"use strict";t.r(r),t.d(r,{common:()=>B,forum:()=>Vt});const n=flarum.core.compat["forum/app"];var o=t.n(n);const e=flarum.core.compat["common/extend"];function a(t,r){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},a(t,r)}function i(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,a(t,r)}const c=flarum.core.compat["common/Model"];var u=t.n(c),s=function(t){function r(){for(var r,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(r=t.call.apply(t,[this].concat(o))||this).productCount=u().attribute("productCount"),r.priceTotal=u().attribute("priceTotal"),r.products=u().hasMany("products"),r}i(r,t);var n=r.prototype;return n.priceTotalLocal=function(){return(this.products()||[]).reduce((function(t,r){return t+(r?r.cartPriceTotalLocal():0)}),0)},n.apiEndpoint=function(){return"/flamarkt/carts"+(this.exists?"/"+this.data.id:"")},r}(u()),l=function(t){function r(){for(var r,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(r=t.call.apply(t,[this].concat(o))||this).number=u().attribute("number"),r.slug=u().attribute("slug"),r.productCount=u().attribute("productCount"),r.priceTotal=u().attribute("priceTotal"),r.paidAmount=u().attribute("paidAmount"),r.createdAt=u().attribute("createdAt",u().transformDate),r.isHidden=u().attribute("isHidden"),r.user=u().hasOne("user"),r.lines=u().hasMany("lines"),r.payments=u().hasMany("payments"),r}return i(r,t),r.prototype.apiEndpoint=function(){return"/flamarkt/orders"+(this.exists?"/"+this.data.id:"")},r}(u()),p=function(t){function r(){for(var r,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(r=t.call.apply(t,[this].concat(o))||this).number=u().attribute("number"),r.group=u().attribute("group"),r.type=u().attribute("type"),r.label=u().attribute("label"),r.comment=u().attribute("comment"),r.quantity=u().attribute("quantity"),r.priceUnit=u().attribute("priceUnit"),r.priceTotal=u().attribute("priceTotal"),r.product=u().hasOne("product"),r}return i(r,t),r}(u()),d=function(t){function r(){for(var r,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(r=t.call.apply(t,[this].concat(o))||this).title=u().attribute("title"),r.slug=u().attribute("slug"),r.description=u().attribute("description"),r.descriptionHtml=u().attribute("descriptionHtml"),r.price=u().attribute("price"),r.priceEdit=u().attribute("priceEdit"),r.cartQuantity=u().attribute("cartQuantity"),r.isHidden=u().attribute("isHidden"),r.canOrder=u().attribute("canOrder"),r.canEdit=u().attribute("canEdit"),r}i(r,t);var n=r.prototype;return n.cartPriceTotalLocal=function(){return this.price&&this.cartQuantity?this.price()*this.cartQuantity():0},n.apiEndpoint=function(){return"/flamarkt/products"+(this.exists?"/"+this.data.id:"")},r}(u());const f=flarum.core.compat["common/Component"];var h=t.n(f),y=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.decimals=function(){return this.attrs.decimals||0},n.min=function(){return this.attrs.min},n.max=function(){return this.attrs.max},n.step=function(){return this.attrs.step},n.fromIntegerValue=function(t){return t/Math.pow(10,this.decimals())},n.toIntegerValue=function(t){return Math.round(t*Math.pow(10,this.decimals()))},n.view=function(){var t=this,r={type:"number",value:this.fromIntegerValue(this.attrs.value)+"",onchange:function(r){var n=parseFloat(r.target.value);t.attrs.onchange(t.toIntegerValue(n))}},n=this.min();void 0!==n&&(r.min=this.fromIntegerValue(n));var o=this.max();void 0!==o&&(r.max=this.fromIntegerValue(o));var e=this.step();return void 0!==e?r.step=this.fromIntegerValue(e):this.decimals()>0&&(r.step=1/Math.pow(10,this.decimals())),m("input.FormControl",r)},r}(h()),v=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.decimals=function(){return this.attrs.decimals||0},n.fromIntegerValue=function(t){return t/Math.pow(10,this.decimals())},n.view=function(){return this.fromIntegerValue(this.attrs.value).toFixed(this.decimals())},r}(h());const b=((flarum.extensions["flamarkt-backoffice"]||{}).common||{})["components/AbstractSortDropdown"];var g=t.n(b),w=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.className=function(){return"OrderSortDropdown"},n.options=function(){return{"-createdAt":"Newest",createdAt:"Oldest","-priceTotal":"Highest total",priceTotal:"Lowest total"}},r}(g());const k=flarum.core.compat["common/app"];var P=t.n(k),A=function(t){function r(){return t.apply(this,arguments)||this}return i(r,t),r.prototype.decimals=function(){return P().forum.attribute("priceDecimals")},r}(y),T=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.decimals=function(){return P().forum.attribute("priceDecimals")},n.view=function(){return[t.prototype.view.call(this)," ",P().forum.attribute("priceUnit")]},r}(v),C=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.className=function(){return"ProductSortDropdown"},n.options=function(){return{"-createdAt":P().translator.trans("flamarkt-core.lib.sort.products.createdAtDesc"),createdAt:P().translator.trans("flamarkt-core.lib.sort.products.createdAtAsc"),price:P().translator.trans("flamarkt-core.lib.sort.products.priceAsc"),"-price":P().translator.trans("flamarkt-core.lib.sort.products.priceDesc"),title:P().translator.trans("flamarkt-core.lib.sort.products.titleAsc"),"-title":P().translator.trans("flamarkt-core.lib.sort.products.titleDesc")}},r}(g()),S=function(t){function r(){return t.apply(this,arguments)||this}return i(r,t),r}(y),I=function(t){function r(){return t.apply(this,arguments)||this}return i(r,t),r}(v);function N(t){return t===parseInt(t)&&(t=(t/Math.pow(10,P().forum.attribute("priceDecimals"))).toFixed(P().forum.attribute("priceDecimals"))),[t," "+P().forum.attribute("priceUnit")]}var x=function(t){function r(){for(var r,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(r=t.call.apply(t,[this].concat(o))||this).method=u().attribute("method"),r.identifier=u().attribute("identifier"),r.amount=u().attribute("amount"),r.createdAt=u().attribute("createdAt",u().transformDate),r.isHidden=u().attribute("isHidden"),r}return i(r,t),r.prototype.apiEndpoint=function(){return"/flamarkt/payments"+(this.exists?"/"+this.data.id:"")},r}(u());const L=((flarum.extensions["flamarkt-backoffice"]||{}).common||{})["states/AbstractListState"];var O=t.n(L),Q=function(t){function r(){return t.apply(this,arguments)||this}return i(r,t),r.prototype.type=function(){return"flamarkt/orders"},r}(O()),D=function(t){function r(){return t.apply(this,arguments)||this}return i(r,t),r.prototype.type=function(){return"flamarkt/products"},r}(O()),B={"components/DecimalInput":y,"components/DecimalLabel":v,"components/OrderSortDropdown":w,"components/PriceInput":A,"components/PriceLabel":T,"components/ProductSortDropdown":C,"components/QuantityInput":S,"components/QuantityLabel":I,"helpers/formatPrice":N,"models/Cart":s,"models/Order":l,"models/OrderLine":p,"models/Payment":x,"models/Product":d,"states/OrderListState":Q,"states/ProductListState":D};const R=flarum.core.compat["common/helpers/listItems"];var q=t.n(R),H=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.view=function(){return m("ul.Breadcrumb",q()(this.items().toArray()))},n.items=function(){return this.attrs.items},r}(h());const M=flarum.core.compat["common/components/Dropdown"];var E=t.n(M);const U=flarum.core.compat["common/helpers/icon"];var _=t.n(U);const F=flarum.core.compat["common/utils/extractText"];var V=t.n(F);const j=flarum.core.compat["common/components/LinkButton"];var K=t.n(j);const G=flarum.core.compat["common/utils/ItemList"];var z=t.n(G),J=function(t){function r(){for(var r,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(r=t.call.apply(t,[this].concat(o))||this).attrs=void 0,r}i(r,t);var n=r.prototype;return n.view=function(){return m(".CartDropdownList",this.items().toArray())},n.items=function(){var t=new(z());return t.add("products",m("p",o().translator.trans("flamarkt-core.forum.cartDropdown.products",{count:this.attrs.state.productCount()||0})),10),t.add("link",K().component({className:"Button Button--primary Button--block",href:o().route("flamarkt.cart")},o().translator.trans("flamarkt-core.forum.cartDropdown.action")),-10),t},r}(h()),W=function(t){function r(){for(var r,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(r=t.call.apply(t,[this].concat(o))||this).attrs=void 0,r}i(r,t),r.initAttrs=function(r){r.className=r.className||"CartDropdown",r.buttonClassName=r.buttonClassName||"Button Button--flat",r.menuClassName=r.menuClassName||"Dropdown-menu--right",r.label=r.label||V()(o().translator.trans("flamarkt-core.forum.cartDropdown.label")),t.initAttrs.call(this,r)};var n=r.prototype;return n.getButton=function(t){return m("a.Dropdown-toggle",{className:this.attrs.buttonClassName,"data-toggle":"dropdown",onclick:this.onclick.bind(this),title:this.attrs.label,href:o().route("flamarkt.cart")},this.getButtonContent(t))},n.getButtonContent=function(t){var r="fas fa-shopping-cart";return this.attrs.state.loading&&(r="fas fa-spinner fa-pulse"),[_()(r,{className:"Button-icon"}),m("span.Button-label",m(T,{value:this.attrs.state.priceTotal()||0,hint:"cart dropdown"}))]},n.getMenu=function(){return m(".Dropdown-menu",{className:this.attrs.menuClassName,onclick:this.menuClick.bind(this)},this.showing?J.component({state:this.attrs.state}):null)},n.onclick=function(t){t.preventDefault(),o().drawer.isOpen()?this.goToRoute():this.showing||this.attrs.state.load()},n.goToRoute=function(){m.route.set(o().route("flamarkt.cart"))},n.menuClick=function(t){(t.shiftKey||t.metaKey||t.ctrlKey||2===t.which)&&t.stopPropagation()},r}(E()),X=function(t){function r(){return t.apply(this,arguments)||this}return i(r,t),r.prototype.view=function(t){return m("section",{className:"CartPage-section "+t.attrs.className},[m("h3",t.attrs.title),t.children])},r}(h());const Y=flarum.core.compat["common/components/Button"];var Z=t.n(Y);const tt=flarum.core.compat["common/components/Link"];var rt=t.n(tt),nt=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.view=function(){return m("tr",this.columns().toArray())},n.columns=function(){var t=new(z()),r=this.attrs.product;return t.add("product",m("td",m(rt(),{href:o().route.product(r)},r.title()))),t.add("quantity",m("td",m(S,{value:this.attrs.product.cartQuantity(),onchange:function(t){},product:r}))),t.add("total",m("td",m(T,{value:r.cartPriceTotalLocal(),hint:"cart product total",product:r}))),t.add("delete",m("td",Z().component({className:"Button Button--icon",icon:"fas fa-times"}))),t},r}(h()),ot=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.view=function(){return m("table.CartTable",[m("thead",m("tr",this.head().toArray())),m("tbody",this.rows().toArray())])},n.head=function(){var t=new(z());return t.add("product",m("th","Product")),t.add("quantity",m("th","Quantity")),t.add("total",m("th","Total")),t.add("actions",m("th")),t},n.rows=function(){var t=new(z()),r=this.attrs.cart.products()||[];return r.forEach((function(r){r&&t.add("product-"+r.id(),nt.component({product:r}))})),0===r.length?t.add("empty",m("tr",m("td",{colspan:100},"Cart is empty"))):t.add("total",m("tr",[m("th",{colspan:2},"Total"),m("th",m(T,{value:this.attrs.cart.priceTotalLocal(),hint:"cart total"}))])),t},r}(h()),et=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.view=function(){return m("tr",this.columns().toArray())},n.columns=function(){var t=new(z()),r=this.attrs.line,n=r.product();return t.add("number",m("td",r.number()),100),t.add("product",m("td",this.productContent()),30),t.add("priceUnit",m("td",m(T,{value:r.priceUnit(),product:n,hint:"order line unit"})),-30),t.add("quantity",m("td",m(I,{value:r.quantity(),product:n})),-60),t.add("priceTotal",m("td",m(T,{value:r.priceTotal(),hint:"order line total",product:n})),-90),t},n.productContent=function(){return[this.labelContent(),this.commentContent()]},n.labelContent=function(){var t=this.attrs.line,r=t.product();return"product"===t.type()&&r?m(rt(),{href:o().route.product(r)},r.title()):t.label()||m("em","N/A")},n.commentContent=function(){var t=this.attrs.line;return t.comment()?m(".comment",t.comment()):null},r}(h()),at=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.view=function(){return this.visible()?m("tr",this.columns().toArray()):null},n.visible=function(){return!1},n.columns=function(){var t=new(z());return t.add("number",m("th"),100),t.add("product",m("th"),30),t.add("priceUnit",m("th"),-30),t.add("quantity",m("th"),-60),t.add("priceTotal",m("th"),-90),t},r}(h()),it=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.view=function(){return this.visible()?m("tr",this.columns().toArray()):null},n.visible=function(){return null===this.attrs.group},n.subtotal=function(){return this.attrs.lines.reduce((function(t,r){return t+(r.priceTotal()||0)}),0)},n.columns=function(){var t=new(z());return t.add("number",m("th"),100),t.add("product",m("th","Subtotal"),30),t.add("priceUnit",m("th"),-30),t.add("quantity",m("th"),-60),t.add("priceTotal",m("th",m(T,{value:this.subtotal(),hint:"order group subtotal"})),-90),t},r}(h()),ct=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.view=function(){return m("table.CartTable",[m("thead",m("tr",this.head().toArray())),m("tbody",this.rows().toArray()),m("tfoot",m("tr",this.foot().toArray()))])},n.head=function(){var t=new(z());return t.add("number",m("th"),100),t.add("product",m("th","Product"),30),t.add("priceUnit",m("th","Price"),-30),t.add("quantity",m("th","Quantity"),-60),t.add("priceTotal",m("th","Total"),-90),t},n.foot=function(){var t=new(z());return t.add("number",m("th"),100),t.add("product",m("th","Total"),30),t.add("priceUnit",m("th"),-30),t.add("quantity",m("th"),-60),t.add("priceTotal",m("th",m(T,{value:this.attrs.order.priceTotal(),hint:"order foot total"})),-90),t},n.rows=function(){var t=new(z()),r=!0,n="__not_exists",o=[];return(this.attrs.order.lines()||[]).forEach((function(e){e&&(e.group()!==n&&(r||t.add("group-foot-"+n,m(it,{group:n,lines:o})),n=e.group(),o=[],t.add("group-head-"+n,m(at,{group:n,line:[]}))),t.add("line-"+e.id(),et.component({line:e})),o.push(e),r=!1)})),r||t.add("group-foot-"+n,m(it,{group:n,lines:o})),t},r}(h()),ut=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.view=function(){return m("li.ProductListItem",this.link(this.items().toArray()))},n.link=function(t){return m(rt(),{className:"ProductListItem--link",href:o().route.product(this.attrs.product)},t)},n.items=function(){var t=new(z()),r=this.attrs.product;return t.add("price",m("span.ProductListItem--price",N(r.price())),20),t.add("title",m("span.ProductListItem--title",r.title()),10),t},r}(h()),st=function(t){function r(){for(var r,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(r=t.call.apply(t,[this].concat(o))||this).cartQuantity=1,r.savingQuantity=!1,r}i(r,t);var n=r.prototype;return n.oninit=function(r){t.prototype.oninit.call(this,r),this.cartQuantity=this.attrs.product.cartQuantity()||1},n.view=function(){var t=this,r=this.attrs.product;return m(".ProductQuantity",[m(S,{value:this.cartQuantity,onchange:function(r){t.cartQuantity=r},product:r,min:0}),Z().component({className:"Button Button--primary Button--block",disabled:this.cartQuantity===r.cartQuantity(),loading:this.savingQuantity,onclick:function(){t.savingQuantity=!0,r.save({cartQuantity:t.cartQuantity}).then((function(){t.savingQuantity=!1,t.cartQuantity=r.cartQuantity()||1,m.redraw(),o().cart.load()})).catch((function(r){throw t.savingQuantity=!1,m.redraw(),r}))}},o().translator.trans(r.cartQuantity()?"flamarkt-core.forum.product.updateCartQuantity":"flamarkt-core.forum.product.addToCart")),r.cartQuantity()?Z().component({className:"Button Button--block",loading:this.savingQuantity,onclick:function(){t.savingQuantity=!0,r.save({cartQuantity:0}).then((function(){t.savingQuantity=!1,t.cartQuantity=1,m.redraw(),o().cart.load()})).catch((function(r){throw t.savingQuantity=!1,m.redraw(),r}))}},o().translator.trans("flamarkt-core.forum.product.removeFromCart")):null])},r}(h());const lt=flarum.core.compat["common/helpers/highlight"];var mt=t.n(lt),pt=function(){function t(){this.results=new Map}var r=t.prototype;return r.search=function(t){var r=this;return o().store.find("flamarkt/products",{filter:{q:t},page:{limit:5}}).then((function(n){r.results.set(t,n),m.redraw()}))},r.view=function(t){var r=this;t=t.toLowerCase();var n=(this.results.get(t)||[]).map((function(n){return m("li.UserSearchResult",{"data-index":"products"+n.id()},m(rt(),{href:o().route.product(n)},r.product(n,t).toArray()))}));return[m("li.Dropdown-header",o().translator.trans("flamarkt-core.forum.search.products.heading")),m("li",K().component({icon:"fas fa-search",href:o().route("flamarkt.products.index",{q:t})},o().translator.trans("flamarkt-core.forum.search.products.all",{query:t})))].concat(n)},r.product=function(t,r){var n=new(z());return n.add("title",mt()(t.title(),r)),n},t}();const dt=flarum.core.compat["forum/components/IndexPage"];var ft=t.n(dt),ht=function(t){function r(){for(var r,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(r=t.call.apply(t,[this].concat(o))||this).attrs=void 0,r}i(r,t);var n=r.prototype;return n.view=function(t){var r=this.className();return m(".ShopPage",{className:r||void 0},[ft().prototype.hero(),m(".container",m(".sideNavContainer",[m("nav.IndexPage-nav.ShopPage-nav.sideNav",m("ul",q()(this.sidebarItems().toArray()))),m(".ShopPage-content.sideNavOffset",[H.component({items:this.breadcrumbItems()}),this.contentTitle(),this.content(t)])]))])},n.sidebarItems=function(){return ft().prototype.sidebarItems()},n.breadcrumbItems=function(){var t=new(z());"/"!==this.currentPageHref()&&t.add("home",K().component({href:"/"},"Home"),100);var r=this.title();return r&&t.add("current",m("span.breadcrumb-current",r),-100),t},n.className=function(){return""},n.title=function(){return""},n.currentPageHref=function(){return null},n.contentTitle=function(){var t=this.title();return t?m("h1",t):null},r}(h()),yt=function(t){function r(){return t.apply(this,arguments)||this}return i(r,t),r.prototype.breadcrumbItems=function(){var r=t.prototype.breadcrumbItems.call(this);return this.currentPageHref()!==o().route("flamarkt.account")&&r.add("account",K().component({href:o().route("flamarkt.account")},"Account")),r},r}(ht);const vt={controls:function(t){var r=new(z());return r.add("orders",K().component({href:o().route("flamarkt.account.orders")},"Orders"),10),r.add("settings",K().component({href:o().route("settings")},"Settings"),-10),r}};var bt=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.className=function(){return"AccountPage"},n.title=function(){return o().translator.trans("flamarkt-core.forum.account.headingTitle")},n.currentPageHref=function(){return o().route("flamarkt.account")},n.content=function(){return o().session.user?m("ul",q()(vt.controls(o().session.user).toArray())):null},r}(yt);const gt=flarum.core.compat["common/components/LoadingIndicator"];var wt=t.n(gt),kt=function(t){function r(){for(var r,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(r=t.call.apply(t,[this].concat(o))||this).submitting=!1,r}i(r,t);var n=r.prototype;return n.className=function(){return"CartPage"},n.title=function(){return o().translator.trans("flamarkt-core.forum.cart.headingTitle")},n.content=function(){var t=this.attrs.cart;return t?t.exists?m("form",{onsubmit:this.onsubmit.bind(this)},this.sections().toArray()):"No cart":wt().component()},n.sectionProducts=function(){var t=new(z());return t.add("table",ot.component({cart:this.attrs.cart})),t},n.sectionPayment=function(){return new(z())},n.sections=function(){var t=new(z());t.add("products",X.component({className:"CartPage-products",title:"Products"},this.sectionProducts().toArray()));var r=this.sectionPayment().toArray();return r.length&&t.add("payment",X.component({className:"CartPage-payment",title:"Payment"},r)),t.add("submit",m(".Form-group",Z().component({type:"submit",className:"Button Button--primary",loading:this.submitting},"Place order"))),t},n.data=function(){return{relationships:{cart:this.attrs.cart}}},n.onsubmit=function(t){t.preventDefault(),this.submitting=!0,o().store.createRecord("flamarkt-orders").save(this.data()).then(this.afterSuccessfulSubmit.bind(this)).catch(this.afterFailedSubmit.bind(this))},n.afterSuccessfulSubmit=function(t){o().store.all("flamarkt-products").forEach((function(t){t.pushAttributes({cartQuantity:null})})),m.route.set(o().route.order(t)),o().cart.load()},n.afterFailedSubmit=function(t){throw this.submitting=!1,m.redraw(),t},r}(ht);const Pt=flarum.core.compat["common/helpers/humanTime"];var At=t.n(Pt);const Tt=flarum.core.compat["common/components/Placeholder"];var Ct=t.n(Tt),St=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.className=function(){return"OrderIndexPage"},n.title=function(){return o().translator.trans("flamarkt-core.forum.orders.headingTitle")},n.content=function(){var t=this;return m("div",[m(".Form-group",[m(w,{list:this.attrs.state})]),m("table.CartTable",[m("thead",m("tr",this.headerRow().toArray())),m("tbody",[this.attrs.state.pages.map((function(r){return r.items.map((function(r){return m("tr",t.orderRow(r).toArray())}))})),this.bottomRow()])])])},n.headerRow=function(){var t=new(z());return t.add("number",m("th","#"),40),t.add("createdAt",m("th","Date"),30),t.add("productCount",m("th","Products"),20),t.add("priceTotal",m("th","Total"),10),t},n.orderRow=function(t){var r=new(z());return r.add("number",m("td",m(rt(),{href:o().route.order(t)},t.number())),40),r.add("createdAt",m("td",At()(t.createdAt())),30),r.add("productCount",m("td",t.productCount()),20),r.add("priceTotal",m("td",m(T,{value:t.priceTotal()})),10),r},n.bottomRowContent=function(){return this.attrs.state.loading?wt().component():this.attrs.state.moreResults?Z().component({className:"Button Button--block",onclick:this.attrs.state.loadMore.bind(this.attrs.state)},"Load more"):0!==this.attrs.state.pages.length||this.attrs.state.loading?void 0:Ct().component({text:"No orders yet"})},n.bottomRow=function(){var t=this.bottomRowContent();return t?m("tr",m("td",{colspan:100},t)):null},r}(yt),It=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.className=function(){return"OrderShowPage"},n.title=function(){return this.attrs.order?o().translator.trans("flamarkt-core.forum.order.headingTitle",{number:this.attrs.order.number()}):"Order"},n.content=function(){return this.attrs.order?this.sections().toArray():wt().component()},n.sections=function(){var t=new(z());return t.add("table",ct.component({order:this.attrs.order}),10),t},r}(yt),Nt=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.className=function(){return"ProductIndexPage"},n.title=function(){return"/"===this.currentPageHref()?"Home":o().translator.trans("flamarkt-core.forum.products.headingTitle")},n.currentPageHref=function(){return o().route("flamarkt.products.index")},n.contentTitle=function(){return"/"===this.currentPageHref()?null:t.prototype.contentTitle.call(this)},n.content=function(){return[m(".ProductListFilters",this.filters().toArray()),m("ul.ProductList",this.attrs.state.pages.map((function(t){return t.items.map((function(t){return ut.component({product:t})}))}))),this.bottomControls()]},n.bottomControls=function(){return this.attrs.state.loading?wt().component():this.attrs.state.moreResults?Z().component({className:"Button",onclick:this.attrs.state.loadMore.bind(this.attrs.state)},"Load more"):0!==this.attrs.state.pages.length||this.attrs.state.loading?void 0:Ct().component({text:"No results"})},n.filters=function(){var t=new(z());return t.add("sort",m(C,{list:this.attrs.state,updateUrl:!0})),t},r}(ht),xt=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.breadcrumbItems=function(){var r=t.prototype.breadcrumbItems.call(this);return r.add("products",K().component({href:o().route("flamarkt.products.index")},o().translator.trans("flamarkt-core.forum.breadcrumb.products"))),r},n.className=function(){return"ProductShowPage"},n.product=function(){return this.attrs.product},n.title=function(){var t=this.product();return t?t.title():""},n.contentTitle=function(){return null},n.content=function(){var t=this.product();return t?this.loadedContent(t):this.loadingContent()},n.loadingContent=function(){return wt().component({className:"LoadingIndicator--block"})},n.loadedContent=function(t){return m(".ProductShowSections",m.fragment({key:t.id()},this.sections(t).toArray()))},n.sections=function(t){var r=new(z()),n=this.gallerySection(t).toArray();return n.length&&r.add("gallery",m("section.ProductShowSection.ProductShowSection--gallery",n),30),r.add("price",m("section.ProductShowSection.ProductShowSection--price",this.priceSection(t).toArray()),20),r.add("description",m("section.ProductShowSection.ProductShowSection--description",this.descriptionSection(t).toArray()),10),r},n.gallerySection=function(t){return new(z())},n.priceSection=function(t){var r=new(z());return t.canEdit()&&r.add("edit",K().component({className:"Button",href:o().forum.attribute("backofficeUrl")+"/products/"+t.id(),external:!0},"Edit"),200),r.add("title",m("h1",t.title()),100),r.add("price",m("p",m(T,{value:t.price(),hint:"product"})),50),this.showCartControls(t)&&r.add("quantity",st.component({product:t}),20),r},n.showCartControls=function(t){return!!t.canOrder()},n.descriptionSection=function(t){var r=new(z()),n=t.descriptionHtml();return n&&r.add("description",m("div",m.trust(n)),10),r},r}(ht);const Lt=flarum.core.compat["common/components/Page"];var Ot=t.n(Lt),Qt=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.view=function(){return m(".ShopPage",[ft().prototype.hero(),m(".container",m(".sideNavContainer",[m("nav.ShopPage-nav.sideNav",m("ul",q()(this.sidebarItems().toArray()))),m(".ShopPage-content.sideNavOffset",[H.component({items:this.breadcrumbItems()}),this.content()])]))])},n.sidebarItems=function(){return ft().prototype.sidebarItems()},n.breadcrumbItems=function(){var t=new(z());return t.add("home",K().component({href:o().route("index")},"Home"),100),t},r}(Ot()),Dt=function(t){function r(){return t.apply(this,arguments)||this}return i(r,t),r.prototype.breadcrumbItems=function(){var r=t.prototype.breadcrumbItems.call(this);return r.add("account",K().component({href:o().route("flamarkt.account")},"Account")),r},r}(Qt),Bt=function(t){function r(){return t.apply(this,arguments)||this}i(r,t);var n=r.prototype;return n.oncreate=function(r){t.prototype.oncreate.call(this,r),o().setTitle(V()(o().translator.trans("flamarkt-core.forum.account.browserTitle"))),o().setTitleCount(0)},n.view=function(){return bt.component()},r}(Ot()),Rt=function(t){function r(){for(var r,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(r=t.call.apply(t,[this].concat(o))||this).loading=!0,r.cart=null,r}i(r,t);var n=r.prototype;return n.oninit=function(r){var n=this;t.prototype.oninit.call(this,r),o().request({method:"GET",url:o().forum.attribute("apiUrl")+"/flamarkt/cart"}).then((function(t){n.loading=!1,n.cart=o().store.pushPayload(t),m.redraw()})).catch((function(t){throw n.loading=!1,m.redraw(),t})),o().setTitle(V()(o().translator.trans("flamarkt-core.forum.cart.browserTitle"))),o().setTitleCount(0)},n.view=function(){var t;return t=this.loading?null:this.cart?this.cart:o().store.createRecord("flamarkt-carts"),kt.component({cart:t})},r}(Ot()),qt=function(t){function r(){for(var r,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(r=t.call.apply(t,[this].concat(o))||this).state=void 0,r}i(r,t);var n=r.prototype;return n.oninit=function(r){t.prototype.oninit.call(this,r),this.state=this.initState(),this.state.refresh(),o().setTitle(V()(o().translator.trans("flamarkt-core.forum.orders.browserTitle"))),o().setTitleCount(0)},n.initState=function(){return new Q({filter:{user:o().session.user?o().session.user.id():0}})},n.view=function(){return St.component({state:this.state})},r}(Ot());const Ht=((flarum.extensions["flamarkt-backoffice"]||{}).common||{})["pages/AbstractShowPage"];var Mt=t.n(Ht),Et=function(t){function r(){for(var r,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(r=t.call.apply(t,[this].concat(o))||this).order=null,r}i(r,t);var n=r.prototype;return n.findType=function(){return"flamarkt/orders"},n.requestParams=function(){var r=t.prototype.requestParams.call(this);return r.bySlug=!0,r},n.show=function(t){this.order=t,o().setTitle(V()(o().translator.trans("flamarkt-core.forum.order.browserTitle",{number:this.order.number()}))),o().setTitleCount(0)},n.view=function(){return It.component({order:this.order})},r}(Mt()),Ut=function(t){function r(){return t.apply(this,arguments)||this}return i(r,t),r.prototype.limit=function(){return 24},r}(D),_t=function(t){function r(){for(var r,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(r=t.call.apply(t,[this].concat(o))||this).state=void 0,r}i(r,t);var n=r.prototype;return n.oninit=function(r){t.prototype.oninit.call(this,r),this.state=this.initState(),this.state.refresh(),o().setTitle(V()(o().translator.trans("flamarkt-core.forum.products.browserTitle"))),o().setTitleCount(0)},n.initState=function(){var t=m.route.param();return new Ut({sort:t.sort,q:t.q})},n.view=function(){return Nt.component({state:this.state})},r}(Ot()),Ft=function(t){function r(){for(var r,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(r=t.call.apply(t,[this].concat(o))||this).product=null,r}i(r,t);var n=r.prototype;return n.oninit=function(r){this.bodyClass="App--product",t.prototype.oninit.call(this,r)},n.findType=function(){return"flamarkt/products"},n.requestParams=function(){var r=t.prototype.requestParams.call(this);return r.bySlug=!0,r},n.show=function(t){this.product=t,o().setTitle(t.title()),o().setTitleCount(0)},n.view=function(){return xt.component({product:this.product})},r}(Mt()),Vt={"components/Breadcrumb":H,"components/CartDropdown":W,"components/CartPageSection":X,"components/CartTable":ot,"components/CartTableRow":nt,"components/OrderTable":ct,"components/OrderTableGroupFoot":it,"components/OrderTableGroupHead":at,"components/OrderTableRow":et,"components/ProductListItem":ut,"components/ProductQuantity":st,"components/ProductSearchSource":pt,"layouts/AbstractAccountLayout":yt,"layouts/AbstractShopLayout":ht,"layouts/AccountLayout":bt,"layouts/CartLayout":kt,"layouts/OrderIndexLayout":St,"layouts/OrderShowLayout":It,"layouts/ProductIndexLayout":Nt,"layouts/ProductShowLayout":xt,"pages/AbstractAccountPage":Dt,"pages/AbstractShopPage":Qt,"pages/AccountPage":Bt,"pages/CartPage":Rt,"pages/OrderIndexPage":qt,"pages/OrderShowPage":Et,"pages/ProductIndexPage":_t,"pages/ProductShowPage":Ft,"utils/AccountControls":vt};const jt=flarum.core.compat["common/models/Forum"];var Kt=t.n(jt);const Gt=flarum.core.compat["forum/components/HeaderSecondary"];var zt=t.n(Gt),$t=function(){function t(){this.cart=null,this.loading=!1}var r=t.prototype;return r.priceTotal=function(){return this.cart?this.cart.priceTotal():null},r.productCount=function(){return this.cart?this.cart.productCount():null},r.boot=function(){this.cart=app.forum.cart()},r.load=function(){var t=this;this.loading=!0,app.request({method:"GET",url:app.forum.attribute("apiUrl")+"/flamarkt/cart"}).then((function(r){t.loading=!1,t.cart=app.store.pushPayload(r),m.redraw()})).catch((function(r){throw t.loading=!1,m.redraw(),r}))},t}();const Jt=((flarum.extensions["flamarkt-backoffice"]||{}).common||{})["components/ActiveLinkButton"];var Wt=t.n(Jt);const Xt=flarum.core.compat["forum/components/NotificationGrid"];var Yt=t.n(Xt);const Zt=flarum.core.compat["forum/components/Search"];var tr=t.n(Zt);const rr=flarum.core.compat["forum/ForumApplication"];var nr=t.n(rr);o().initializers.add("flamarkt-core",(function(){o().store.models["flamarkt-carts"]=s,o().store.models["flamarkt-orders"]=l,o().store.models["flamarkt-order-lines"]=p,o().store.models["flamarkt-products"]=d,Kt().prototype.cart=u().hasOne("cart"),function(t){t.routes["flamarkt.account"]={path:"/account",component:Bt},t.routes["flamarkt.account.orders"]={path:"/account/orders",component:qt},t.routes["flamarkt.cart"]={path:"/cart",component:Rt},t.routes["flamarkt.products.index"]={path:"/products",component:_t},t.routes["flamarkt.products.show"]={path:"/products/:id",component:Ft},t.routes["flamarkt.orders.show"]={path:"/orders/:id",component:Et},t.route.product=function(r){return t.route("flamarkt.products.show",{id:r.slug()})},t.route.order=function(r){return t.route("flamarkt.orders.show",{id:r.slug()})}}(o()),o().cart=new $t,(0,e.extend)(nr().prototype,"mount",(function(){o().cart.boot(),$("#home-link").click((function(t){t.ctrlKey||t.metaKey||2===t.which||o().session.user&&o().cart.load()}))})),(0,e.extend)(ft().prototype,"navItems",(function(t){t.add("flamarkt-products",Wt().component({icon:"fas fa-shopping-cart",href:o().route("flamarkt.products.index"),activeRoutes:["flamarkt.products.*"]},o().translator.trans("flamarkt-core.forum.nav.shop"))),t.add("flamarkt-account",Wt().component({icon:"fas fa-user",href:o().route("flamarkt.account"),activeRoutes:["flamarkt.account.*","flamarkt.orders.show"]},o().translator.trans("flamarkt-core.forum.nav.account")))})),(0,e.extend)(zt().prototype,"items",(function(t){t.add("flamarkt-cart",W.component({state:o().cart}),15)})),(0,e.extend)(Yt().prototype,"notificationTypes",(function(t){t.add("orderReceived",{name:"orderReceived",icon:"far fa-thumbs-up",label:o().translator.trans("flamarkt-core.forum.settings.notifyOrderReceived")})})),(0,e.override)(Yt().prototype,"preferenceKey",(function(t,r,n){return"orderReceived"===r&&"alert"===n?"__not_exists":t(r,n)})),(0,e.extend)(tr().prototype,"sourceItems",(function(t){t.add("products",new pt,-10)}))}))})(),module.exports=r})();
//# sourceMappingURL=forum.js.map