module.exports=function(t){var r={};function n(a){if(r[a])return r[a].exports;var e=r[a]={i:a,l:!1,exports:{}};return t[a].call(e.exports,e,e.exports,n),e.l=!0,e.exports}return n.m=t,n.c=r,n.d=function(t,r,a){n.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,r){if(1&r&&(t=n(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var e in t)n.d(a,e,function(r){return t[r]}.bind(null,e));return a},n.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(r,"a",r),r},n.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},n.p="",n(n.s=62)}([function(t,r,n){"use strict";function a(t,r){return(a=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function e(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,a(t,r)}n.d(r,"a",(function(){return e}))},function(t,r){t.exports=flarum.core.compat["common/Model"]},function(t,r){t.exports=flarum.core.compat["forum/app"]},,function(t,r){t.exports=flarum.core.compat["common/utils/ItemList"]},function(t,r){t.exports=flarum.core.compat["common/Component"]},function(t,r){t.exports=flarum.core.compat["common/app"]},function(t,r){t.exports=flarum.core.compat["common/components/LinkButton"]},function(t,r,n){"use strict";n.d(r,"a",(function(){return i}));var a=n(0),e=n(6),o=n.n(e),i=function(t){function r(){return t.apply(this,arguments)||this}Object(a.a)(r,t);var n=r.prototype;return n.decimals=function(){return o.a.forum.attribute("priceDecimals")},n.view=function(){return[t.prototype.view.call(this)," ",o.a.forum.attribute("priceUnit")]},r}(n(14).a)},function(t,r){t.exports=flarum.core.compat["common/components/Page"]},function(t,r){t.exports=flarum.core.compat["common/utils/extractText"]},function(t,r){t.exports=flarum.core.compat["common/components/Button"]},function(t,r){t.exports=flarum.core.compat["common/components/LoadingIndicator"]},function(t,r,n){"use strict";n.d(r,"a",(function(){return o}));var a=n(0),e=n(5),o=function(t){function r(){return t.apply(this,arguments)||this}Object(a.a)(r,t);var n=r.prototype;return n.decimals=function(){return this.attrs.decimals||0},n.min=function(){return this.attrs.min},n.max=function(){return this.attrs.max},n.step=function(){return this.attrs.step},n.fromIntegerValue=function(t){return t/Math.pow(10,this.decimals())},n.toIntegerValue=function(t){return Math.round(t*Math.pow(10,this.decimals()))},n.view=function(){var t=this,r={type:"number",value:this.fromIntegerValue(this.attrs.value)+"",onchange:function(r){var n=parseFloat(r.target.value);t.attrs.onchange(t.toIntegerValue(n))}},n=this.min();void 0!==n&&(r.min=this.fromIntegerValue(n));var a=this.max();void 0!==a&&(r.max=this.fromIntegerValue(a));var e=this.step();return void 0!==e?r.step=this.fromIntegerValue(e):this.decimals()>0&&(r.step=1/Math.pow(10,this.decimals())),m("input.FormControl",r)},r}(n.n(e).a)},function(t,r,n){"use strict";n.d(r,"a",(function(){return o}));var a=n(0),e=n(5),o=function(t){function r(){return t.apply(this,arguments)||this}Object(a.a)(r,t);var n=r.prototype;return n.decimals=function(){return this.attrs.decimals||0},n.fromIntegerValue=function(t){return t/Math.pow(10,this.decimals())},n.view=function(){return this.fromIntegerValue(this.attrs.value).toFixed(this.decimals())},r}(n.n(e).a)},function(t,r){t.exports=flarum.core.compat["common/extend"]},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].common["states/AbstractListState"]},function(t,r,n){"use strict";n.d(r,"a",(function(){return i}));var a=n(0),e=n(6),o=n.n(e),i=function(t){function r(){return t.apply(this,arguments)||this}return Object(a.a)(r,t),r.prototype.decimals=function(){return o.a.forum.attribute("priceDecimals")},r}(n(13).a)},function(t,r,n){"use strict";n.d(r,"a",(function(){return e}));var a=n(0),e=function(t){function r(){return t.apply(this,arguments)||this}return Object(a.a)(r,t),r}(n(13).a)},function(t,r){t.exports=flarum.core.compat["common/components/Link"]},function(t,r,n){"use strict";n.d(r,"a",(function(){return i}));var a=n(0),e=n(1),o=n.n(e),i=function(t){function r(){for(var r,n=arguments.length,a=new Array(n),e=0;e<n;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).number=o.a.attribute("number"),r.slug=o.a.attribute("slug"),r.productCount=o.a.attribute("productCount"),r.priceTotal=o.a.attribute("priceTotal"),r.paidAmount=o.a.attribute("paidAmount"),r.createdAt=o.a.attribute("createdAt",o.a.transformDate),r.isHidden=o.a.attribute("isHidden"),r.user=o.a.hasOne("user"),r.lines=o.a.hasMany("lines"),r.payments=o.a.hasMany("payments"),r}return Object(a.a)(r,t),r.prototype.apiEndpoint=function(){return"/flamarkt/orders"+(this.exists?"/"+this.data.id:"")},r}(o.a)},function(t,r,n){"use strict";n.d(r,"a",(function(){return i}));var a=n(0),e=n(1),o=n.n(e),i=function(t){function r(){for(var r,n=arguments.length,a=new Array(n),e=0;e<n;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).number=o.a.attribute("number"),r.group=o.a.attribute("group"),r.type=o.a.attribute("type"),r.label=o.a.attribute("label"),r.comment=o.a.attribute("comment"),r.quantity=o.a.attribute("quantity"),r.priceUnit=o.a.attribute("priceUnit"),r.priceTotal=o.a.attribute("priceTotal"),r.product=o.a.hasOne("product"),r}return Object(a.a)(r,t),r}(o.a)},function(t,r,n){"use strict";n.d(r,"a",(function(){return i}));var a=n(0),e=n(1),o=n.n(e),i=function(t){function r(){for(var r,n=arguments.length,a=new Array(n),e=0;e<n;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).title=o.a.attribute("title"),r.slug=o.a.attribute("slug"),r.description=o.a.attribute("description"),r.descriptionHtml=o.a.attribute("descriptionHtml"),r.price=o.a.attribute("price"),r.priceEdit=o.a.attribute("priceEdit"),r.cartQuantity=o.a.attribute("cartQuantity"),r.isHidden=o.a.attribute("isHidden"),r.canOrder=o.a.attribute("canOrder"),r.canEdit=o.a.attribute("canEdit"),r}Object(a.a)(r,t);var n=r.prototype;return n.cartPriceTotalLocal=function(){return this.price&&this.cartQuantity?this.price()*this.cartQuantity():0},n.apiEndpoint=function(){return"/flamarkt/products"+(this.exists?"/"+this.data.id:"")},r}(o.a)},function(t,r,n){"use strict";n.d(r,"a",(function(){return o}));var a=n(0),e=n(24),o=function(t){function r(){return t.apply(this,arguments)||this}Object(a.a)(r,t);var n=r.prototype;return n.className=function(){return"OrderSortDropdown"},n.options=function(){return{"-createdAt":"Newest",createdAt:"Oldest","-priceTotal":"Highest total",priceTotal:"Lowest total"}},r}(n.n(e).a)},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].common["components/AbstractSortDropdown"]},function(t,r,n){"use strict";n.d(r,"a",(function(){return c}));var a=n(0),e=n(6),o=n.n(e),i=n(24),c=function(t){function r(){return t.apply(this,arguments)||this}Object(a.a)(r,t);var n=r.prototype;return n.className=function(){return"ProductSortDropdown"},n.options=function(){return{"-createdAt":o.a.translator.trans("flamarkt-core.lib.sort.products.createdAtDesc"),createdAt:o.a.translator.trans("flamarkt-core.lib.sort.products.createdAtAsc"),price:o.a.translator.trans("flamarkt-core.lib.sort.products.priceAsc"),"-price":o.a.translator.trans("flamarkt-core.lib.sort.products.priceDesc"),title:o.a.translator.trans("flamarkt-core.lib.sort.products.titleAsc"),"-title":o.a.translator.trans("flamarkt-core.lib.sort.products.titleDesc")}},r}(n.n(i).a)},function(t,r,n){"use strict";n.d(r,"a",(function(){return o}));var a=n(0),e=n(16),o=function(t){function r(){return t.apply(this,arguments)||this}return Object(a.a)(r,t),r.prototype.type=function(){return"flamarkt/orders"},r}(n.n(e).a)},function(t,r,n){"use strict";n.d(r,"a",(function(){return o}));var a=n(0),e=n(16),o=function(t){function r(){return t.apply(this,arguments)||this}return Object(a.a)(r,t),r.prototype.type=function(){return"flamarkt/products"},r}(n.n(e).a)},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].common["pages/AbstractShowPage"]},,function(t,r){t.exports=flarum.core.compat["common/helpers/listItems"]},function(t,r){t.exports=flarum.core.compat["forum/components/IndexPage"]},function(t,r,n){"use strict";n.d(r,"a",(function(){return i}));var a=n(0),e=n(1),o=n.n(e),i=function(t){function r(){for(var r,n=arguments.length,a=new Array(n),e=0;e<n;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).method=o.a.attribute("method"),r.identifier=o.a.attribute("identifier"),r.amount=o.a.attribute("amount"),r.createdAt=o.a.attribute("createdAt",o.a.transformDate),r.isHidden=o.a.attribute("isHidden"),r}return Object(a.a)(r,t),r.prototype.apiEndpoint=function(){return"/flamarkt/payments"+(this.exists?"/"+this.data.id:"")},r}(o.a)},function(t,r,n){"use strict";n.d(r,"a",(function(){return e}));var a=n(0),e=function(t){function r(){return t.apply(this,arguments)||this}return Object(a.a)(r,t),r}(n(14).a)},function(t,r,n){"use strict";var a=n(6),e=n.n(a);r.a=function(t){return t===parseInt(t)&&(t=(t/Math.pow(10,e.a.forum.attribute("priceDecimals"))).toFixed(e.a.forum.attribute("priceDecimals"))),[t," "+e.a.forum.attribute("priceUnit")]}},function(t,r,n){"use strict";n.d(r,"a",(function(){return i}));var a=n(0),e=n(1),o=n.n(e),i=function(t){function r(){for(var r,n=arguments.length,a=new Array(n),e=0;e<n;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).productCount=o.a.attribute("productCount"),r.priceTotal=o.a.attribute("priceTotal"),r.products=o.a.hasMany("products"),r}Object(a.a)(r,t);var n=r.prototype;return n.priceTotalLocal=function(){return(this.products()||[]).reduce((function(t,r){return t+(r?r.cartPriceTotalLocal():0)}),0)},n.apiEndpoint=function(){return"/flamarkt/carts"+(this.exists?"/"+this.data.id:"")},r}(o.a)},function(t,r){t.exports=flarum.core.compat["common/helpers/highlight"]},function(t,r){t.exports=flarum.core.compat["common/helpers/humanTime"]},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].common["components/ActiveLinkButton"]},,,,function(t,r,n){"use strict";n.d(r,"a",(function(){return g}));var a=n(13),e=n(14),o=n(23),i=n(17),c=n(8),u=n(25),s=n(18),l=n(33),m=n(34),p=n(35),d=n(20),f=n(21),h=n(32),y=n(22),b=n(26),v=n(27),g={"components/DecimalInput":a.a,"components/DecimalLabel":e.a,"components/OrderSortDropdown":o.a,"components/PriceInput":i.a,"components/PriceLabel":c.a,"components/ProductSortDropdown":u.a,"components/QuantityInput":s.a,"components/QuantityLabel":l.a,"helpers/formatPrice":m.a,"models/Cart":p.a,"models/Order":d.a,"models/OrderLine":f.a,"models/Payment":h.a,"models/Product":y.a,"states/OrderListState":b.a,"states/ProductListState":v.a}},,,function(t,r){t.exports=flarum.core.compat["common/components/Placeholder"]},function(t,r){t.exports=flarum.core.compat["forum/components/NotificationGrid"]},,,,,,,,,function(t,r){t.exports=flarum.core.compat["common/components/Dropdown"]},function(t,r){t.exports=flarum.core.compat["common/helpers/icon"]},function(t,r){t.exports=flarum.core.compat["common/models/Forum"]},function(t,r){t.exports=flarum.core.compat["forum/components/HeaderSecondary"]},function(t,r){t.exports=flarum.core.compat["forum/components/Search"]},function(t,r){t.exports=flarum.core.compat["forum/ForumApplication"]},,function(t,r,n){"use strict";n.r(r),n.d(r,"common",(function(){return l.a})),n.d(r,"forum",(function(){return It}));var a=n(2),e=n.n(a),o=n(15),i=n(35),c=n(20),u=n(21),s=n(22),l=n(42),p=n(0),d=n(5),f=n.n(d),h=n(30),y=n.n(h),b=function(t){function r(){return t.apply(this,arguments)||this}Object(p.a)(r,t);var n=r.prototype;return n.view=function(){return m("ul.Breadcrumb",y()(this.items().toArray()))},n.items=function(){return this.attrs.items},r}(f.a),v=n(55),g=n.n(v),w=n(56),k=n.n(w),P=n(10),O=n.n(P),A=n(7),T=n.n(A),x=n(4),C=n.n(x),S=function(t){function r(){for(var r,n=arguments.length,a=new Array(n),e=0;e<n;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).attrs=void 0,r}Object(p.a)(r,t);var n=r.prototype;return n.view=function(){return m(".CartDropdownList",this.items().toArray())},n.items=function(){var t=new C.a;return t.add("products",m("p",e.a.translator.trans("flamarkt-core.forum.cartDropdown.products",{count:this.attrs.state.productCount()||0})),10),t.add("link",T.a.component({className:"Button Button--primary Button--block",href:e.a.route("flamarkt.cart")},e.a.translator.trans("flamarkt-core.forum.cartDropdown.action")),-10),t},r}(f.a),j=n(8),I=function(t){function r(){for(var r,n=arguments.length,a=new Array(n),e=0;e<n;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).attrs=void 0,r}Object(p.a)(r,t),r.initAttrs=function(r){r.className=r.className||"CartDropdown",r.buttonClassName=r.buttonClassName||"Button Button--flat",r.menuClassName=r.menuClassName||"Dropdown-menu--right",r.label=r.label||O()(e.a.translator.trans("flamarkt-core.forum.cartDropdown.label")),t.initAttrs.call(this,r)};var n=r.prototype;return n.getButton=function(t){return m("a.Dropdown-toggle",{className:this.attrs.buttonClassName,"data-toggle":"dropdown",onclick:this.onclick.bind(this),title:this.attrs.label,href:e.a.route("flamarkt.cart")},this.getButtonContent(t))},n.getButtonContent=function(t){var r="fas fa-shopping-cart";return this.attrs.state.loading&&(r="fas fa-spinner fa-pulse"),[k()(r,{className:"Button-icon"}),m("span.Button-label",m(j.a,{value:this.attrs.state.priceTotal()||0,hint:"cart dropdown"}))]},n.getMenu=function(){return m(".Dropdown-menu",{className:this.attrs.menuClassName,onclick:this.menuClick.bind(this)},this.showing?S.component({state:this.attrs.state}):null)},n.onclick=function(t){t.preventDefault(),e.a.drawer.isOpen()?this.goToRoute():this.showing||this.attrs.state.load()},n.goToRoute=function(){m.route.set(e.a.route("flamarkt.cart"))},n.menuClick=function(t){(t.shiftKey||t.metaKey||t.ctrlKey||2===t.which)&&t.stopPropagation()},r}(g.a),N=function(t){function r(){return t.apply(this,arguments)||this}return Object(p.a)(r,t),r.prototype.view=function(t){return m("section",{className:"CartPage-section "+t.attrs.className},[m("h3",t.attrs.title),t.children])},r}(f.a),L=n(11),Q=n.n(L),D=n(19),B=n.n(D),R=n(18),q=function(t){function r(){return t.apply(this,arguments)||this}Object(p.a)(r,t);var n=r.prototype;return n.view=function(){return m("tr",this.columns().toArray())},n.columns=function(){var t=new C.a,r=this.attrs.product;return t.add("product",m("td",m(B.a,{href:e.a.route.product(r)},r.title()))),t.add("quantity",m("td",m(R.a,{value:this.attrs.product.cartQuantity(),onchange:function(t){},product:r}))),t.add("total",m("td",m(j.a,{value:r.cartPriceTotalLocal(),hint:"cart product total",product:r}))),t.add("delete",m("td",Q.a.component({className:"Button Button--icon",icon:"fas fa-times"}))),t},r}(f.a),H=function(t){function r(){return t.apply(this,arguments)||this}Object(p.a)(r,t);var n=r.prototype;return n.view=function(){return m("table.CartTable",[m("thead",m("tr",this.head().toArray())),m("tbody",this.rows().toArray())])},n.head=function(){var t=new C.a;return t.add("product",m("th","Product")),t.add("quantity",m("th","Quantity")),t.add("total",m("th","Total")),t.add("actions",m("th")),t},n.rows=function(){var t=new C.a,r=this.attrs.cart.products()||[];return r.forEach((function(r){r&&t.add("product-"+r.id(),q.component({product:r}))})),0===r.length?t.add("empty",m("tr",m("td",{colspan:100},"Cart is empty"))):t.add("total",m("tr",[m("th",{colspan:2},"Total"),m("th",m(j.a,{value:this.attrs.cart.priceTotalLocal(),hint:"cart total"}))])),t},r}(f.a),M=n(33),_=function(t){function r(){return t.apply(this,arguments)||this}Object(p.a)(r,t);var n=r.prototype;return n.view=function(){return m("tr",this.columns().toArray())},n.columns=function(){var t=new C.a,r=this.attrs.line,n=r.product();return t.add("number",m("td",r.number()),100),t.add("product",m("td",this.productContent()),30),t.add("priceUnit",m("td",m(j.a,{value:r.priceUnit(),product:n,hint:"order line unit"})),-30),t.add("quantity",m("td",m(M.a,{value:r.quantity(),product:n})),-60),t.add("priceTotal",m("td",m(j.a,{value:r.priceTotal(),hint:"order line total",product:n})),-90),t},n.productContent=function(){return[this.labelContent(),this.commentContent()]},n.labelContent=function(){var t=this.attrs.line,r=t.product();return"product"===t.type()&&r?m(B.a,{href:e.a.route.product(r)},r.title()):t.label()||m("em","N/A")},n.commentContent=function(){var t=this.attrs.line;return t.comment()?m(".comment",t.comment()):null},r}(f.a),U=function(t){function r(){return t.apply(this,arguments)||this}Object(p.a)(r,t);var n=r.prototype;return n.view=function(){return this.visible()?m("tr",this.columns().toArray()):null},n.visible=function(){return!1},n.columns=function(){var t=new C.a;return t.add("number",m("th"),100),t.add("product",m("th"),30),t.add("priceUnit",m("th"),-30),t.add("quantity",m("th"),-60),t.add("priceTotal",m("th"),-90),t},r}(f.a),E=function(t){function r(){return t.apply(this,arguments)||this}Object(p.a)(r,t);var n=r.prototype;return n.view=function(){return this.visible()?m("tr",this.columns().toArray()):null},n.visible=function(){return null===this.attrs.group},n.subtotal=function(){return this.attrs.lines.reduce((function(t,r){return t+(r.priceTotal()||0)}),0)},n.columns=function(){var t=new C.a;return t.add("number",m("th"),100),t.add("product",m("th","Subtotal"),30),t.add("priceUnit",m("th"),-30),t.add("quantity",m("th"),-60),t.add("priceTotal",m("th",m(j.a,{value:this.subtotal(),hint:"order group subtotal"})),-90),t},r}(f.a),F=function(t){function r(){return t.apply(this,arguments)||this}Object(p.a)(r,t);var n=r.prototype;return n.view=function(){return m("table.CartTable",[m("thead",m("tr",this.head().toArray())),m("tbody",this.rows().toArray()),m("tfoot",m("tr",this.foot().toArray()))])},n.head=function(){var t=new C.a;return t.add("number",m("th"),100),t.add("product",m("th","Product"),30),t.add("priceUnit",m("th","Price"),-30),t.add("quantity",m("th","Quantity"),-60),t.add("priceTotal",m("th","Total"),-90),t},n.foot=function(){var t=new C.a;return t.add("number",m("th"),100),t.add("product",m("th","Total"),30),t.add("priceUnit",m("th"),-30),t.add("quantity",m("th"),-60),t.add("priceTotal",m("th",m(j.a,{value:this.attrs.order.priceTotal(),hint:"order foot total"})),-90),t},n.rows=function(){var t=new C.a,r=!0,n="__not_exists",a=[];return(this.attrs.order.lines()||[]).forEach((function(e){e&&(e.group()!==n&&(r||t.add("group-foot-"+n,m(E,{group:n,lines:a})),n=e.group(),a=[],t.add("group-head-"+n,m(U,{group:n,line:[]}))),t.add("line-"+e.id(),_.component({line:e})),a.push(e),r=!1)})),r||t.add("group-foot-"+n,m(E,{group:n,lines:a})),t},r}(f.a),V=n(34),K=function(t){function r(){return t.apply(this,arguments)||this}Object(p.a)(r,t);var n=r.prototype;return n.view=function(){return m("li.ProductListItem",this.link(this.items().toArray()))},n.link=function(t){return m(B.a,{className:"ProductListItem--link",href:e.a.route.product(this.attrs.product)},t)},n.items=function(){var t=new C.a,r=this.attrs.product;return t.add("price",m("span.ProductListItem--price",Object(V.a)(r.price())),20),t.add("title",m("span.ProductListItem--title",r.title()),10),t},r}(f.a),G=function(t){function r(){for(var r,n=arguments.length,a=new Array(n),e=0;e<n;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).cartQuantity=1,r.savingQuantity=!1,r}Object(p.a)(r,t);var n=r.prototype;return n.oninit=function(r){t.prototype.oninit.call(this,r),this.cartQuantity=this.attrs.product.cartQuantity()||1},n.view=function(){var t=this,r=this.attrs.product;return m(".ProductQuantity",[m(R.a,{value:this.cartQuantity,onchange:function(r){t.cartQuantity=r},product:r,min:0}),Q.a.component({className:"Button Button--primary Button--block",disabled:this.cartQuantity===r.cartQuantity(),loading:this.savingQuantity,onclick:function(){t.savingQuantity=!0,r.save({cartQuantity:t.cartQuantity}).then((function(){t.savingQuantity=!1,t.cartQuantity=r.cartQuantity()||1,m.redraw(),e.a.cart.load()})).catch((function(r){throw t.savingQuantity=!1,m.redraw(),r}))}},e.a.translator.trans(r.cartQuantity()?"flamarkt-core.forum.product.updateCartQuantity":"flamarkt-core.forum.product.addToCart")),r.cartQuantity()?Q.a.component({className:"Button Button--block",loading:this.savingQuantity,onclick:function(){t.savingQuantity=!0,r.save({cartQuantity:0}).then((function(){t.savingQuantity=!1,t.cartQuantity=1,m.redraw(),e.a.cart.load()})).catch((function(r){throw t.savingQuantity=!1,m.redraw(),r}))}},e.a.translator.trans("flamarkt-core.forum.product.removeFromCart")):null])},r}(f.a),z=n(36),J=n.n(z),W=function(){function t(){this.results=new Map}var r=t.prototype;return r.search=function(t){var r=this;return e.a.store.find("flamarkt/products",{filter:{q:t},page:{limit:5}}).then((function(n){r.results.set(t,n),m.redraw()}))},r.view=function(t){var r=this;t=t.toLowerCase();var n=(this.results.get(t)||[]).map((function(n){return m("li.UserSearchResult",{"data-index":"products"+n.id()},m(B.a,{href:e.a.route.product(n)},r.product(n,t).toArray()))}));return[m("li.Dropdown-header",e.a.translator.trans("flamarkt-core.forum.search.products.heading")),m("li",T.a.component({icon:"fas fa-search",href:e.a.route("flamarkt.products.index",{q:t})},e.a.translator.trans("flamarkt-core.forum.search.products.all",{query:t})))].concat(n)},r.product=function(t,r){var n=new C.a;return n.add("title",J()(t.title(),r)),n},t}(),X=n(31),Y=n.n(X),Z=function(t){function r(){for(var r,n=arguments.length,a=new Array(n),e=0;e<n;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).attrs=void 0,r}Object(p.a)(r,t);var n=r.prototype;return n.view=function(t){var r=this.className();return m(".ShopPage",{className:r||void 0},[Y.a.prototype.hero(),m(".container",m(".sideNavContainer",[m("nav.IndexPage-nav.ShopPage-nav.sideNav",m("ul",y()(this.sidebarItems().toArray()))),m(".ShopPage-content.sideNavOffset",[b.component({items:this.breadcrumbItems()}),this.contentTitle(),this.content(t)])]))])},n.sidebarItems=function(){return Y.a.prototype.sidebarItems()},n.breadcrumbItems=function(){var t=new C.a;"/"!==this.currentPageHref()&&t.add("home",T.a.component({href:"/"},"Home"),100);var r=this.title();return r&&t.add("current",m("span.breadcrumb-current",r),-100),t},n.className=function(){return""},n.title=function(){return""},n.currentPageHref=function(){return null},n.contentTitle=function(){var t=this.title();return t?m("h1",t):null},r}(f.a),tt=function(t){function r(){return t.apply(this,arguments)||this}return Object(p.a)(r,t),r.prototype.breadcrumbItems=function(){var r=t.prototype.breadcrumbItems.call(this);return this.currentPageHref()!==e.a.route("flamarkt.account")&&r.add("account",T.a.component({href:e.a.route("flamarkt.account")},"Account")),r},r}(Z),rt={controls:function(t){var r=new C.a;return r.add("orders",T.a.component({href:e.a.route("flamarkt.account.orders")},"Orders"),10),r.add("settings",T.a.component({href:e.a.route("settings")},"Settings"),-10),r}},nt=function(t){function r(){return t.apply(this,arguments)||this}Object(p.a)(r,t);var n=r.prototype;return n.className=function(){return"AccountPage"},n.title=function(){return e.a.translator.trans("flamarkt-core.forum.account.headingTitle")},n.currentPageHref=function(){return e.a.route("flamarkt.account")},n.content=function(){return e.a.session.user?m("ul",y()(rt.controls(e.a.session.user).toArray())):null},r}(tt),at=n(12),et=n.n(at),ot=function(t){function r(){for(var r,n=arguments.length,a=new Array(n),e=0;e<n;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).submitting=!1,r}Object(p.a)(r,t);var n=r.prototype;return n.className=function(){return"CartPage"},n.title=function(){return e.a.translator.trans("flamarkt-core.forum.cart.headingTitle")},n.content=function(){var t=this.attrs.cart;return t?t.exists?m("form",{onsubmit:this.onsubmit.bind(this)},this.sections().toArray()):"No cart":et.a.component()},n.sectionProducts=function(){var t=new C.a;return t.add("table",H.component({cart:this.attrs.cart})),t},n.sectionPayment=function(){return new C.a},n.sections=function(){var t=new C.a;t.add("products",N.component({className:"CartPage-products",title:"Products"},this.sectionProducts().toArray()));var r=this.sectionPayment().toArray();return r.length&&t.add("payment",N.component({className:"CartPage-payment",title:"Payment"},r)),t.add("submit",m(".Form-group",Q.a.component({type:"submit",className:"Button Button--primary",loading:this.submitting},"Place order"))),t},n.data=function(){return{relationships:{cart:this.attrs.cart}}},n.onsubmit=function(t){t.preventDefault(),this.submitting=!0,e.a.store.createRecord("flamarkt-orders").save(this.data()).then(this.afterSuccessfulSubmit.bind(this)).catch(this.afterFailedSubmit.bind(this))},n.afterSuccessfulSubmit=function(t){m.route.set(e.a.route.order(t)),e.a.cart.load()},n.afterFailedSubmit=function(t){throw this.submitting=!1,m.redraw(),t},r}(Z),it=n(23),ct=n(37),ut=n.n(ct),st=n(45),lt=n.n(st),mt=function(t){function r(){return t.apply(this,arguments)||this}Object(p.a)(r,t);var n=r.prototype;return n.className=function(){return"OrderIndexPage"},n.title=function(){return e.a.translator.trans("flamarkt-core.forum.orders.headingTitle")},n.content=function(){var t=this;return m("div",[m(".Form-group",[m(it.a,{state:this.attrs.state})]),m("table.CartTable",[m("thead",m("tr",this.headerRow().toArray())),m("tbody",[this.attrs.state.pages.map((function(r){return r.items.map((function(r){return m("tr",t.orderRow(r).toArray())}))})),this.bottomRow()])])])},n.headerRow=function(){var t=new C.a;return t.add("number",m("th","#"),40),t.add("createdAt",m("th","Date"),30),t.add("productCount",m("th","Products"),20),t.add("priceTotal",m("th","Total"),10),t},n.orderRow=function(t){var r=new C.a;return r.add("number",m("td",m(B.a,{href:e.a.route.order(t)},t.number())),40),r.add("createdAt",m("td",ut()(t.createdAt())),30),r.add("productCount",m("td",t.productCount()),20),r.add("priceTotal",m("td",m(j.a,{value:t.priceTotal()})),10),r},n.bottomRowContent=function(){return this.attrs.state.loading?et.a.component():this.attrs.state.moreResults?Q.a.component({className:"Button Button--block",onclick:this.attrs.state.loadMore.bind(this.attrs.state)},"Load more"):0!==this.attrs.state.pages.length||this.attrs.state.loading?void 0:lt.a.component({text:"No orders yet"})},n.bottomRow=function(){var t=this.bottomRowContent();return t?m("tr",m("td",{colspan:100},t)):null},r}(tt),pt=function(t){function r(){return t.apply(this,arguments)||this}Object(p.a)(r,t);var n=r.prototype;return n.className=function(){return"OrderShowPage"},n.title=function(){return this.attrs.order?e.a.translator.trans("flamarkt-core.forum.order.headingTitle",{number:this.attrs.order.number()}):"Order"},n.content=function(){return this.attrs.order?this.sections().toArray():et.a.component()},n.sections=function(){var t=new C.a;return t.add("table",F.component({order:this.attrs.order}),10),t},r}(tt),dt=n(25),ft=function(t){function r(){return t.apply(this,arguments)||this}Object(p.a)(r,t);var n=r.prototype;return n.className=function(){return"ProductIndexPage"},n.title=function(){return"/"===this.currentPageHref()?"Home":e.a.translator.trans("flamarkt-core.forum.products.headingTitle")},n.currentPageHref=function(){return e.a.route("flamarkt.products.index")},n.contentTitle=function(){return"/"===this.currentPageHref()?null:t.prototype.contentTitle.call(this)},n.content=function(){return[m(".ProductListFilters",this.filters().toArray()),m("ul.ProductList",this.attrs.state.pages.map((function(t){return t.items.map((function(t){return K.component({product:t})}))}))),this.bottomControls()]},n.bottomControls=function(){return this.attrs.state.loading?et.a.component():this.attrs.state.moreResults?Q.a.component({className:"Button",onclick:this.attrs.state.loadMore.bind(this.attrs.state)},"Load more"):0!==this.attrs.state.pages.length||this.attrs.state.loading?void 0:lt.a.component({text:"No results"})},n.filters=function(){var t=new C.a;return t.add("sort",m(dt.a,{state:this.attrs.state,updateUrl:!0})),t},r}(Z),ht=function(t){function r(){return t.apply(this,arguments)||this}Object(p.a)(r,t);var n=r.prototype;return n.breadcrumbItems=function(){var r=t.prototype.breadcrumbItems.call(this);return r.add("products",T.a.component({href:e.a.route("flamarkt.products.index")},e.a.translator.trans("flamarkt-core.forum.breadcrumb.products"))),r},n.className=function(){return"ProductShowPage"},n.product=function(){return this.attrs.product},n.title=function(){var t=this.product();return t?t.title():""},n.contentTitle=function(){return null},n.content=function(){var t=this.product();return t?this.loadedContent(t):this.loadingContent()},n.loadingContent=function(){return et.a.component({className:"LoadingIndicator--block"})},n.loadedContent=function(t){return m(".ProductShowSections",m.fragment({key:t.id()},this.sections(t).toArray()))},n.sections=function(t){var r=new C.a,n=this.gallerySection(t).toArray();return n.length&&r.add("gallery",m("section.ProductShowSection.ProductShowSection--gallery",n),30),r.add("price",m("section.ProductShowSection.ProductShowSection--price",this.priceSection(t).toArray()),20),r.add("description",m("section.ProductShowSection.ProductShowSection--description",this.descriptionSection(t).toArray()),10),r},n.gallerySection=function(t){return new C.a},n.priceSection=function(t){var r=new C.a;return t.canEdit()&&r.add("edit",T.a.component({className:"Button",href:e.a.forum.attribute("backofficeUrl")+"/products/"+t.id(),external:!0},"Edit"),200),r.add("title",m("h1",t.title()),100),r.add("price",m("p",m(j.a,{value:t.price(),hint:"product"})),50),this.showCartControls(t)&&r.add("quantity",G.component({product:t}),20),r},n.showCartControls=function(t){return!!t.canOrder()},n.descriptionSection=function(t){var r=new C.a,n=t.descriptionHtml();return n&&r.add("description",m("div",m.trust(n)),10),r},r}(Z),yt=n(9),bt=n.n(yt),vt=function(t){function r(){return t.apply(this,arguments)||this}Object(p.a)(r,t);var n=r.prototype;return n.view=function(){return m(".ShopPage",[Y.a.prototype.hero(),m(".container",m(".sideNavContainer",[m("nav.ShopPage-nav.sideNav",m("ul",y()(this.sidebarItems().toArray()))),m(".ShopPage-content.sideNavOffset",[b.component({items:this.breadcrumbItems()}),this.content()])]))])},n.sidebarItems=function(){return Y.a.prototype.sidebarItems()},n.breadcrumbItems=function(){var t=new C.a;return t.add("home",T.a.component({href:e.a.route("index")},"Home"),100),t},r}(bt.a),gt=function(t){function r(){return t.apply(this,arguments)||this}return Object(p.a)(r,t),r.prototype.breadcrumbItems=function(){var r=t.prototype.breadcrumbItems.call(this);return r.add("account",T.a.component({href:e.a.route("flamarkt.account")},"Account")),r},r}(vt),wt=function(t){function r(){return t.apply(this,arguments)||this}Object(p.a)(r,t);var n=r.prototype;return n.oncreate=function(r){t.prototype.oncreate.call(this,r),e.a.setTitle(O()(e.a.translator.trans("flamarkt-core.forum.account.browserTitle"))),e.a.setTitleCount(0)},n.view=function(){return nt.component()},r}(bt.a),kt=function(t){function r(){for(var r,n=arguments.length,a=new Array(n),e=0;e<n;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).loading=!0,r.cart=null,r}Object(p.a)(r,t);var n=r.prototype;return n.oninit=function(r){var n=this;t.prototype.oninit.call(this,r),e.a.request({method:"GET",url:e.a.forum.attribute("apiUrl")+"/flamarkt/cart"}).then((function(t){n.loading=!1,n.cart=e.a.store.pushPayload(t),m.redraw()})).catch((function(t){throw n.loading=!1,m.redraw(),t})),e.a.setTitle(O()(e.a.translator.trans("flamarkt-core.forum.cart.browserTitle"))),e.a.setTitleCount(0)},n.view=function(){var t;return t=this.loading?null:this.cart?this.cart:e.a.store.createRecord("flamarkt-carts"),ot.component({cart:t})},r}(bt.a),Pt=n(26),Ot=function(t){function r(){for(var r,n=arguments.length,a=new Array(n),e=0;e<n;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).state=void 0,r}Object(p.a)(r,t);var n=r.prototype;return n.oninit=function(r){t.prototype.oninit.call(this,r),this.state=this.initState(),this.state.refresh(),e.a.setTitle(O()(e.a.translator.trans("flamarkt-core.forum.orders.browserTitle"))),e.a.setTitleCount(0)},n.initState=function(){return new Pt.a({filter:{user:e.a.session.user?e.a.session.user.id():0}})},n.view=function(){return mt.component({state:this.state})},r}(bt.a),At=n(28),Tt=n.n(At),xt=function(t){function r(){for(var r,n=arguments.length,a=new Array(n),e=0;e<n;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).order=null,r}Object(p.a)(r,t);var n=r.prototype;return n.findType=function(){return"flamarkt/orders"},n.requestParams=function(){var r=t.prototype.requestParams.call(this);return r.bySlug=!0,r},n.show=function(t){this.order=t,e.a.setTitle(O()(e.a.translator.trans("flamarkt-core.forum.order.browserTitle",{number:this.order.number()}))),e.a.setTitleCount(0)},n.view=function(){return pt.component({order:this.order})},r}(Tt.a),Ct=function(t){function r(){return t.apply(this,arguments)||this}return Object(p.a)(r,t),r.prototype.limit=function(){return 24},r}(n(27).a),St=function(t){function r(){for(var r,n=arguments.length,a=new Array(n),e=0;e<n;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).state=void 0,r}Object(p.a)(r,t);var n=r.prototype;return n.oninit=function(r){t.prototype.oninit.call(this,r),this.state=this.initState(),this.state.refresh(),e.a.setTitle(O()(e.a.translator.trans("flamarkt-core.forum.products.browserTitle"))),e.a.setTitleCount(0)},n.initState=function(){var t=m.route.param();return new Ct({sort:t.sort,q:t.q})},n.view=function(){return ft.component({state:this.state})},r}(bt.a),jt=function(t){function r(){for(var r,n=arguments.length,a=new Array(n),e=0;e<n;e++)a[e]=arguments[e];return(r=t.call.apply(t,[this].concat(a))||this).product=null,r}Object(p.a)(r,t);var n=r.prototype;return n.oninit=function(r){this.bodyClass="App--product",t.prototype.oninit.call(this,r)},n.findType=function(){return"flamarkt/products"},n.requestParams=function(){var r=t.prototype.requestParams.call(this);return r.bySlug=!0,r},n.show=function(t){this.product=t,e.a.setTitle(t.title()),e.a.setTitleCount(0)},n.view=function(){return ht.component({product:this.product})},r}(Tt.a),It={"components/Breadcrumb":b,"components/CartDropdown":I,"components/CartPageSection":N,"components/CartTable":H,"components/CartTableRow":q,"components/OrderTable":F,"components/OrderTableGroupFoot":E,"components/OrderTableGroupHead":U,"components/OrderTableRow":_,"components/ProductListItem":K,"components/ProductQuantity":G,"components/ProductSearchSource":W,"layouts/AbstractAccountLayout":tt,"layouts/AbstractShopLayout":Z,"layouts/AccountLayout":nt,"layouts/CartLayout":ot,"layouts/OrderIndexLayout":mt,"layouts/OrderShowLayout":pt,"layouts/ProductIndexLayout":ft,"layouts/ProductShowLayout":ht,"pages/AbstractAccountPage":gt,"pages/AbstractShopPage":vt,"pages/AccountPage":wt,"pages/CartPage":kt,"pages/OrderIndexPage":Ot,"pages/OrderShowPage":xt,"pages/ProductIndexPage":St,"pages/ProductShowPage":jt,"utils/AccountControls":rt},Nt=n(57),Lt=n.n(Nt),Qt=n(1),Dt=n.n(Qt),Bt=n(58),Rt=n.n(Bt),qt=function(){function t(){this.cart=null,this.loading=!1}var r=t.prototype;return r.priceTotal=function(){return this.cart?this.cart.priceTotal():null},r.productCount=function(){return this.cart?this.cart.productCount():null},r.boot=function(){this.cart=app.forum.cart()},r.load=function(){var t=this;this.loading=!0,app.request({method:"GET",url:app.forum.attribute("apiUrl")+"/flamarkt/cart"}).then((function(r){t.loading=!1,t.cart=app.store.pushPayload(r),m.redraw()})).catch((function(r){throw t.loading=!1,m.redraw(),r}))},t}(),Ht=n(38),Mt=n.n(Ht),_t=n(46),Ut=n.n(_t),Et=n(59),Ft=n.n(Et),Vt=n(60),Kt=n.n(Vt);e.a.initializers.add("flamarkt-core",(function(){e.a.store.models["flamarkt-carts"]=i.a,e.a.store.models["flamarkt-orders"]=c.a,e.a.store.models["flamarkt-order-lines"]=u.a,e.a.store.models["flamarkt-products"]=s.a,Lt.a.prototype.cart=Dt.a.hasOne("cart"),function(t){t.routes["flamarkt.account"]={path:"/account",component:wt},t.routes["flamarkt.account.orders"]={path:"/account/orders",component:Ot},t.routes["flamarkt.cart"]={path:"/cart",component:kt},t.routes["flamarkt.products.index"]={path:"/products",component:St},t.routes["flamarkt.products.show"]={path:"/products/:id",component:jt},t.routes["flamarkt.orders.show"]={path:"/orders/:id",component:xt},t.route.product=function(r){return t.route("flamarkt.products.show",{id:r.slug()})},t.route.order=function(r){return t.route("flamarkt.orders.show",{id:r.slug()})}}(e.a),e.a.cart=new qt,Object(o.extend)(Kt.a.prototype,"mount",(function(){e.a.cart.boot(),$("#home-link").click((function(t){t.ctrlKey||t.metaKey||2===t.which||e.a.session.user&&e.a.cart.load()}))})),Object(o.extend)(Y.a.prototype,"navItems",(function(t){t.add("flamarkt-products",Mt.a.component({icon:"fas fa-shopping-cart",href:e.a.route("flamarkt.products.index"),activeRoutes:["flamarkt.products.*"]},e.a.translator.trans("flamarkt-core.forum.nav.shop"))),t.add("flamarkt-account",Mt.a.component({icon:"fas fa-user",href:e.a.route("flamarkt.account"),activeRoutes:["flamarkt.account.*","flamarkt.orders.show"]},e.a.translator.trans("flamarkt-core.forum.nav.account")))})),Object(o.extend)(Rt.a.prototype,"items",(function(t){t.add("flamarkt-cart",I.component({state:e.a.cart}),15)})),Object(o.extend)(Ut.a.prototype,"notificationTypes",(function(t){t.add("orderReceived",{name:"orderReceived",icon:"far fa-thumbs-up",label:e.a.translator.trans("flamarkt-core.forum.settings.notifyOrderReceived")})})),Object(o.override)(Ut.a.prototype,"preferenceKey",(function(t,r,n){return"orderReceived"===r&&"alert"===n?"__not_exists":t(r,n)})),Object(o.extend)(Ft.a.prototype,"sourceItems",(function(t){t.add("products",new W,-10)}))}))}]);
//# sourceMappingURL=forum.js.map