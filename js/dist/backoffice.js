module.exports=function(t){var r={};function e(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var a in t)e.d(n,a,function(r){return t[r]}.bind(null,a));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=63)}([function(t,r,e){"use strict";function n(t,r){return(n=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function a(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,n(t,r)}e.d(r,"a",(function(){return a}))},function(t,r){t.exports=flarum.core.compat["common/Model"]},,function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].backoffice.app},function(t,r){t.exports=flarum.core.compat["common/utils/ItemList"]},function(t,r){t.exports=flarum.core.compat["common/Component"]},function(t,r){t.exports=flarum.core.compat["common/app"]},function(t,r){t.exports=flarum.core.compat["common/components/LinkButton"]},function(t,r,e){"use strict";e.d(r,"a",(function(){return i}));var n=e(0),a=e(6),o=e.n(a),i=function(t){function r(){return t.apply(this,arguments)||this}Object(n.a)(r,t);var e=r.prototype;return e.decimals=function(){return o.a.forum.attribute("priceDecimals")},e.view=function(){return[t.prototype.view.call(this)," ",o.a.forum.attribute("priceUnit")]},r}(e(14).a)},function(t,r){t.exports=flarum.core.compat["common/components/Page"]},function(t,r){t.exports=flarum.core.compat["common/utils/extractText"]},function(t,r){t.exports=flarum.core.compat["common/components/Button"]},function(t,r){t.exports=flarum.core.compat["common/components/LoadingIndicator"]},function(t,r,e){"use strict";e.d(r,"a",(function(){return o}));var n=e(0),a=e(5),o=function(t){function r(){return t.apply(this,arguments)||this}Object(n.a)(r,t);var e=r.prototype;return e.decimals=function(){return this.attrs.decimals||0},e.min=function(){return this.attrs.min},e.max=function(){return this.attrs.max},e.step=function(){return this.attrs.step},e.fromIntegerValue=function(t){return t/Math.pow(10,this.decimals())},e.toIntegerValue=function(t){return Math.round(t*Math.pow(10,this.decimals()))},e.view=function(){var t=this,r={type:"number",value:this.fromIntegerValue(this.attrs.value)+"",onchange:function(r){var e=parseFloat(r.target.value);t.attrs.onchange(t.toIntegerValue(e))}},e=this.min();void 0!==e&&(r.min=this.fromIntegerValue(e));var n=this.max();void 0!==n&&(r.max=this.fromIntegerValue(n));var a=this.step();return void 0!==a?r.step=this.fromIntegerValue(a):this.decimals()>0&&(r.step=1/Math.pow(10,this.decimals())),m("input.FormControl",r)},r}(e.n(a).a)},function(t,r,e){"use strict";e.d(r,"a",(function(){return o}));var n=e(0),a=e(5),o=function(t){function r(){return t.apply(this,arguments)||this}Object(n.a)(r,t);var e=r.prototype;return e.decimals=function(){return this.attrs.decimals||0},e.fromIntegerValue=function(t){return t/Math.pow(10,this.decimals())},e.view=function(){return this.fromIntegerValue(this.attrs.value).toFixed(this.decimals())},r}(e.n(a).a)},function(t,r){t.exports=flarum.core.compat["common/extend"]},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].common["states/AbstractListState"]},function(t,r,e){"use strict";e.d(r,"a",(function(){return i}));var n=e(0),a=e(6),o=e.n(a),i=function(t){function r(){return t.apply(this,arguments)||this}return Object(n.a)(r,t),r.prototype.decimals=function(){return o.a.forum.attribute("priceDecimals")},r}(e(13).a)},function(t,r,e){"use strict";e.d(r,"a",(function(){return a}));var n=e(0),a=function(t){function r(){return t.apply(this,arguments)||this}return Object(n.a)(r,t),r}(e(13).a)},,function(t,r,e){"use strict";e.d(r,"a",(function(){return i}));var n=e(0),a=e(1),o=e.n(a),i=function(t){function r(){for(var r,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(r=t.call.apply(t,[this].concat(n))||this).number=o.a.attribute("number"),r.slug=o.a.attribute("slug"),r.productCount=o.a.attribute("productCount"),r.priceTotal=o.a.attribute("priceTotal"),r.paidAmount=o.a.attribute("paidAmount"),r.createdAt=o.a.attribute("createdAt",o.a.transformDate),r.isHidden=o.a.attribute("isHidden"),r.user=o.a.hasOne("user"),r.lines=o.a.hasMany("lines"),r.payments=o.a.hasMany("payments"),r}return Object(n.a)(r,t),r.prototype.apiEndpoint=function(){return"/flamarkt/orders"+(this.exists?"/"+this.data.id:"")},r}(o.a)},function(t,r,e){"use strict";e.d(r,"a",(function(){return i}));var n=e(0),a=e(1),o=e.n(a),i=function(t){function r(){for(var r,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(r=t.call.apply(t,[this].concat(n))||this).number=o.a.attribute("number"),r.group=o.a.attribute("group"),r.type=o.a.attribute("type"),r.label=o.a.attribute("label"),r.comment=o.a.attribute("comment"),r.quantity=o.a.attribute("quantity"),r.priceUnit=o.a.attribute("priceUnit"),r.priceTotal=o.a.attribute("priceTotal"),r.product=o.a.hasOne("product"),r}return Object(n.a)(r,t),r}(o.a)},function(t,r,e){"use strict";e.d(r,"a",(function(){return i}));var n=e(0),a=e(1),o=e.n(a),i=function(t){function r(){for(var r,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(r=t.call.apply(t,[this].concat(n))||this).title=o.a.attribute("title"),r.slug=o.a.attribute("slug"),r.description=o.a.attribute("description"),r.descriptionHtml=o.a.attribute("descriptionHtml"),r.price=o.a.attribute("price"),r.priceEdit=o.a.attribute("priceEdit"),r.cartQuantity=o.a.attribute("cartQuantity"),r.isHidden=o.a.attribute("isHidden"),r.canOrder=o.a.attribute("canOrder"),r.canEdit=o.a.attribute("canEdit"),r}Object(n.a)(r,t);var e=r.prototype;return e.cartPriceTotalLocal=function(){return this.price&&this.cartQuantity?this.price()*this.cartQuantity():0},e.apiEndpoint=function(){return"/flamarkt/products"+(this.exists?"/"+this.data.id:"")},r}(o.a)},function(t,r,e){"use strict";e.d(r,"a",(function(){return o}));var n=e(0),a=e(24),o=function(t){function r(){return t.apply(this,arguments)||this}Object(n.a)(r,t);var e=r.prototype;return e.className=function(){return"OrderSortDropdown"},e.options=function(){return{"-createdAt":"Newest",createdAt:"Oldest","-priceTotal":"Highest total",priceTotal:"Lowest total"}},r}(e.n(a).a)},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].common["components/AbstractSortDropdown"]},function(t,r,e){"use strict";e.d(r,"a",(function(){return c}));var n=e(0),a=e(6),o=e.n(a),i=e(24),c=function(t){function r(){return t.apply(this,arguments)||this}Object(n.a)(r,t);var e=r.prototype;return e.className=function(){return"ProductSortDropdown"},e.options=function(){return{"-createdAt":o.a.translator.trans("flamarkt-core.lib.sort.products.createdAtDesc"),createdAt:o.a.translator.trans("flamarkt-core.lib.sort.products.createdAtAsc"),price:o.a.translator.trans("flamarkt-core.lib.sort.products.priceAsc"),"-price":o.a.translator.trans("flamarkt-core.lib.sort.products.priceDesc"),title:o.a.translator.trans("flamarkt-core.lib.sort.products.titleAsc"),"-title":o.a.translator.trans("flamarkt-core.lib.sort.products.titleDesc")}},r}(e.n(i).a)},function(t,r,e){"use strict";e.d(r,"a",(function(){return o}));var n=e(0),a=e(16),o=function(t){function r(){return t.apply(this,arguments)||this}return Object(n.a)(r,t),r.prototype.type=function(){return"flamarkt/orders"},r}(e.n(a).a)},function(t,r,e){"use strict";e.d(r,"a",(function(){return o}));var n=e(0),a=e(16),o=function(t){function r(){return t.apply(this,arguments)||this}return Object(n.a)(r,t),r.prototype.type=function(){return"flamarkt/products"},r}(e.n(a).a)},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].common["pages/AbstractShowPage"]},function(t,r){t.exports=flarum.core.compat["common/components/Select"]},,,function(t,r,e){"use strict";e.d(r,"a",(function(){return i}));var n=e(0),a=e(1),o=e.n(a),i=function(t){function r(){for(var r,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(r=t.call.apply(t,[this].concat(n))||this).method=o.a.attribute("method"),r.identifier=o.a.attribute("identifier"),r.amount=o.a.attribute("amount"),r.createdAt=o.a.attribute("createdAt",o.a.transformDate),r.isHidden=o.a.attribute("isHidden"),r}return Object(n.a)(r,t),r.prototype.apiEndpoint=function(){return"/flamarkt/payments"+(this.exists?"/"+this.data.id:"")},r}(o.a)},function(t,r,e){"use strict";e.d(r,"a",(function(){return a}));var n=e(0),a=function(t){function r(){return t.apply(this,arguments)||this}return Object(n.a)(r,t),r}(e(14).a)},function(t,r,e){"use strict";var n=e(6),a=e.n(n);r.a=function(t){return t===parseInt(t)&&(t=(t/Math.pow(10,a.a.forum.attribute("priceDecimals"))).toFixed(a.a.forum.attribute("priceDecimals"))),[t," "+a.a.forum.attribute("priceUnit")]}},function(t,r,e){"use strict";e.d(r,"a",(function(){return i}));var n=e(0),a=e(1),o=e.n(a),i=function(t){function r(){for(var r,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(r=t.call.apply(t,[this].concat(n))||this).productCount=o.a.attribute("productCount"),r.priceTotal=o.a.attribute("priceTotal"),r.products=o.a.hasMany("products"),r}Object(n.a)(r,t);var e=r.prototype;return e.priceTotalLocal=function(){return(this.products()||[]).reduce((function(t,r){return t+(r?r.cartPriceTotalLocal():0)}),0)},e.apiEndpoint=function(){return"/flamarkt/carts"+(this.exists?"/"+this.data.id:"")},r}(o.a)},function(t,r){t.exports=flarum.core.compat["common/helpers/highlight"]},function(t,r){t.exports=flarum.core.compat["common/helpers/humanTime"]},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].common["components/ActiveLinkButton"]},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].backoffice["components/AbstractList"]},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].backoffice["components/SubmitButton"]},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].backoffice["components/PermanentDeleteButton"]},function(t,r,e){"use strict";e.d(r,"a",(function(){return g}));var n=e(13),a=e(14),o=e(23),i=e(17),c=e(8),s=e(25),u=e(18),l=e(33),d=e(34),f=e(35),m=e(20),p=e(21),h=e(32),b=e(22),y=e(26),v=e(27),g={"components/DecimalInput":n.a,"components/DecimalLabel":a.a,"components/OrderSortDropdown":o.a,"components/PriceInput":i.a,"components/PriceLabel":c.a,"components/ProductSortDropdown":s.a,"components/QuantityInput":u.a,"components/QuantityLabel":l.a,"helpers/formatPrice":d.a,"models/Cart":f.a,"models/Order":m.a,"models/OrderLine":p.a,"models/Payment":h.a,"models/Product":b.a,"states/OrderListState":y.a,"states/ProductListState":v.a}},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].common["components/AbstractRelationshipSelect"]},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].backoffice["components/SoftDeleteButton"]},,,,function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].common["components/SortableHandle"]},function(t,r){t.exports=flarum.core.compat["common/helpers/username"]},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].common["components/Sortable"]},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].common["components/UserRelationshipSelect"]},function(t,r){t.exports=flarum.core.compat["common/components/Modal"]},function(t,r){t.exports=flarum.core.compat["common/components/TextEditor"]},function(t,r){t.exports=flarum.extensions["flamarkt-backoffice"].backoffice["components/BackofficeNav"]},,,,,,,,,function(t,r,e){"use strict";e.r(r),e.d(r,"common",(function(){return d.a})),e.d(r,"backoffice",(function(){return Dt}));var n=e(3),a=e.n(n),o=e(1),i=e.n(o),c=e(20),s=e(21),u=e(32),l=e(22),d=e(42),f=e(48),p=e.n(f),h=e(4),b=e.n(h),y=e(29),v=e.n(y),g=e(0),k=e(43),w=e.n(k),x=e(36),O=e.n(x),D=function(t){function r(){for(var r,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(r=t.call.apply(t,[this].concat(n))||this).resultsCache=new Map,r}Object(g.a)(r,t);var e=r.prototype;return e.search=function(t){var r=this;return t?a.a.store.find("flamarkt/products",{filter:{q:t},page:{limit:5}}).then((function(e){r.resultsCache.set(t,e),m.redraw()})):(m.redraw(),Promise.resolve())},e.results=function(t){if(!t)return[];t=t.toLowerCase();var r=this.resultsCache.get(t);return void 0===r?null:(r||[]).concat(a.a.store.all("flamarkt-products").filter((function(r){return r.title().toLowerCase().substr(0,t.length)===t}))).filter((function(t,r,e){return e.lastIndexOf(t)===r})).sort((function(t,r){return t.title().localeCompare(r.title())}))},e.item=function(t,r){return[r?O()(t.title(),r):t.title()]},r}(w.a),P=e(17),A=e(18),T=e(8),L=function(){function t(){}var r=t.prototype;return r.view=function(t){var r=t.attrs,e=r.line,n=r.control,a=r.onchange,o=r.sortable,i=r.style,c=r.ondragstart;return m("tr",{style:i,"data-index":t.attrs["data-index"],ondragstart:c},this.columns(e,n,a,o).toArray())},r.columns=function(t,r,e,n){var a=new b.a;return a.add("handle",m("td.OrderLineEdit-Handle",n?m(p.a):null),100),a.add("group",m("td.OrderLineEdit-Group",v.a.component({value:null===t.group?"_none":t.group,onchange:function(r){t.group="_none"===r?null:r,e()},options:{_none:"None",shipping:"Shipping"}})),90),a.add("type",m("td.OrderLineEdit-Type",v.a.component({value:t.type,onchange:function(r){t.type=r,e()},options:{product:"Product",manual:"Manual"}})),80),a.add("info",m("td.OrderLineEdit-Info",this.fields(t,e).toArray()),30),a.add("priceUnit",m("td.OrderLineEdit-PriceUnit",m(P.a,{value:t.priceUnit,onchange:function(r){t.priceUnit=r,t.updateTotal(),e()},product:t.product})),-30),a.add("quantity",m("td.OrderLineEdit-Quantity",m(A.a,{value:t.quantity,onchange:function(r){t.quantity=r,t.updateTotal(),e()},product:t.product})),-60),a.add("priceTotal",m("td.OrderLineEdit-PriceTotal",m(T.a,{value:t.priceTotal,product:t.product})),-90),a.add("control",m("td.OrderLineEdit-Controls",r),-100),a},r.showInfoProduct=function(t){return"product"===t.type},r.showInfoLabel=function(t){return"manual"===t.type},r.showInfoComment=function(t){return"product"===t.type||"manual"===t.type},r.fields=function(t,r){var e=new b.a;return this.showInfoProduct(t)&&e.add("product",m(".Form-group",[m("label","Product"),m(D,{relationship:t.product,onchange:function(e){t.product=e,r()},hasOne:!0})])),this.showInfoLabel(t)&&e.add("label",m(".Form-group",[m("label","Label"),m("input.FormControl",{type:"text",value:t.label,onchange:function(e){t.label=e.target.value,r()}})])),this.showInfoComment(t)&&e.add("comment",m(".Form-group",[m("label","Comment"),m("textarea.FormControl",{value:t.comment,onchange:function(e){t.comment=e.target.value,r()}})])),e},t}(),C=e(7),j=e.n(C),S=e(39),F=e.n(S),I=e(49),E=e.n(I),B=e(37),M=e.n(B),_=function(t){function r(){return t.apply(this,arguments)||this}Object(g.a)(r,t);var e=r.prototype;return e.head=function(){var r=t.prototype.head.call(this);return r.add("number",m("th",a.a.translator.trans("flamarkt-core.backoffice.orders.head.number")),50),r.add("date",m("th",a.a.translator.trans("flamarkt-core.backoffice.orders.head.date")),40),r.add("user",m("th",a.a.translator.trans("flamarkt-core.backoffice.orders.head.user")),30),r.add("priceTotal",m("th",a.a.translator.trans("flamarkt-core.backoffice.orders.head.priceTotal")),20),r.add("paidAmount",m("th",a.a.translator.trans("flamarkt-core.backoffice.orders.head.paidAmount")),10),r.add("productCount",m("th",a.a.translator.trans("flamarkt-core.backoffice.orders.head.productCount")),5),r},e.columns=function(r){var e=t.prototype.columns.call(this,r);return e.add("number",m("td",r.number()),50),e.add("date",m("td",M()(r.createdAt())),40),e.add("user",m("td",E()(r.user())),30),e.add("priceTotal",m("td",m(T.a,{value:r.priceTotal()})),20),e.add("paidAmount",m("td",m(T.a,{value:r.paidAmount()})),10),e.add("productCount",m("td",r.productCount()),5),e},e.actions=function(r){var e=t.prototype.actions.call(this,r);return e.add("edit",j.a.component({className:"Button Button--icon",icon:"fas fa-pen",href:a.a.route.order(r)})),e},r}(F.a),q=function(t){function r(){for(var r,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(r=t.call.apply(t,[this].concat(n))||this).resultsCache=new Map,r}Object(g.a)(r,t);var e=r.prototype;return e.search=function(t){var r=this;return t?a.a.store.find("flamarkt/orders",{filter:{q:t},page:{limit:5}}).then((function(e){r.resultsCache.set(t,e),m.redraw()})):(m.redraw(),Promise.resolve())},e.results=function(t){if(!t)return[];t=t.toLowerCase();var r=this.resultsCache.get(t);return void 0===r?null:r||[]},e.item=function(t,r){return[r?O()(t.number(),r):t.number()]},r}(w.a),N=function(t){function r(){return t.apply(this,arguments)||this}Object(g.a)(r,t);var e=r.prototype;return e.head=function(){var r=t.prototype.head.call(this);return r.add("title",m("th",a.a.translator.trans("flamarkt-core.backoffice.products.head.title")),10),r},e.columns=function(r){var e=t.prototype.columns.call(this,r);return e.add("title",m("td",r.title()),10),e},e.actions=function(r){var e=t.prototype.actions.call(this,r);return e.add("edit",j.a.component({className:"Button Button--icon",icon:"fas fa-pen",href:a.a.route.product(r)})),e},r}(F.a),U=e(9),H=e.n(U),R=e(10),V=e.n(R),Q=e(26),K=e(23),G=function(t){function r(){for(var r,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(r=t.call.apply(t,[this].concat(n))||this).list=void 0,r}Object(g.a)(r,t);var e=r.prototype;return e.oninit=function(r){t.prototype.oninit.call(this,r),this.list=this.initState(),this.list.refresh(),a.a.setTitle(V()(a.a.translator.trans("flamarkt-core.backoffice.orders.title"))),a.a.setTitleCount(0)},e.initState=function(){var t=m.route.param(),r={sort:t.sort};return t.user&&(r.filter=r.filter||{},r.filter.user=t.user),new Q.a(r)},e.view=function(){return m(".OrderIndexPage",m(".container",[m(".Form-group",[j.a.component({className:"Button",href:a.a.route("orders.show",{id:"new"})},a.a.translator.trans("flamarkt-core.backoffice.orders.new")),m(K.a,{state:this.list})]),m(_,{state:this.list})]))},r}(H.a);function z(){return(z=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t}).apply(this,arguments)}var J=e(11),W=e.n(J),X=e(12),Y=e.n(X),Z=e(28),$=e.n(Z),tt=e(50),rt=e.n(tt),et=e(40),nt=e.n(et),at=e(51),ot=e.n(at),it=0,ct=function(){function t(){this.uniqueFormKey=void 0,this.line=void 0,this.group=null,this.type=null,this.label="",this.comment="",this.quantity=0,this.priceUnit=0,this.priceTotal=0,this.product=null,this.uniqueFormKey=++it+""}var r=t.prototype;return r.init=function(t){this.line=t,this.group=t.group()||null,this.type=t.type()||null,this.label=t.label()||"",this.comment=t.comment()||"",this.quantity=t.quantity()||0,this.priceUnit=t.priceUnit()||0,this.priceTotal=t.priceTotal()||0,this.product=t.product()||null},r.updateTotal=function(){this.priceTotal=this.quantity*this.priceUnit},r.data=function(){var t={attributes:{group:this.group,type:this.type,label:this.label,comment:this.comment,quantity:this.quantity,priceUnit:this.priceUnit},relationships:{product:{data:i.a.getIdentifier(this.product)}}};return this.line&&(t.id=this.line.id()),t},t}(),st=e(44),ut=e.n(st),lt=e(41),dt=e.n(lt),ft=e(52),mt=function(t){function r(){for(var r,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(r=t.call.apply(t,[this].concat(n))||this).payment=void 0,r.method="",r.identifier="",r.amount=0,r.dirty=!1,r}Object(g.a)(r,t);var e=r.prototype;return e.oninit=function(r){t.prototype.oninit.call(this,r),r.attrs.payment?(this.payment=r.attrs.payment,this.method=this.payment.method()||"",this.identifier=this.payment.identifier()||"",this.amount=this.payment.amount()||0):this.payment=a.a.store.createRecord("flamarkt-payments")},e.content=function(){return m(".Modal-body",this.fields().toArray())},e.fields=function(){var t=this,r=new b.a;return r.add("method",m(".Form-group",[m("label",a.a.translator.trans("flamarkt-core.backoffice.payments.field.method")),m("input.FormControl",{type:"text",value:this.method,oninput:function(r){t.method=r.target.value,t.dirty=!0},disabled:this.loading})]),30),r.add("identifier",m(".Form-group",[m("label",a.a.translator.trans("flamarkt-core.backoffice.payments.field.identifier")),m("input.FormControl",{type:"text",value:this.identifier,oninput:function(r){t.identifier=r.target.value,t.dirty=!0},disabled:this.loading})]),20),r.add("amount",m(".Form-group",[m("label",a.a.translator.trans("flamarkt-core.backoffice.payments.field.amount")),m(P.a,{value:this.amount,onchange:function(r){t.amount=r,t.dirty=!0},disabled:this.loading})]),10),r.add("submit",m(".Form-group",[nt.a.component({loading:this.loading,dirty:this.dirty,exists:this.payment.exists})," ",dt.a.component({model:this.payment,afterdelete:function(){a.a.modal.close()}})]),-10),r},e.data=function(){return{method:this.method||null,identifier:this.identifier||null,amount:this.amount}},e.onsubmit=function(t){var r=this;t.preventDefault(),this.loading=!0,this.payment.save(this.data()).then((function(t){r.payment=t,r.dirty=!1,r.loading=!1,m.redraw()}),this.loaded.bind(this))},r}(e.n(ft).a),pt=function(t){function r(){return t.apply(this,arguments)||this}Object(g.a)(r,t);var e=r.prototype;return e.head=function(){var r=t.prototype.head.call(this);return r.add("date",m("th",a.a.translator.trans("flamarkt-core.backoffice.payments.head.date")),40),r.add("method",m("th",a.a.translator.trans("flamarkt-core.backoffice.payments.head.method")),30),r.add("identifier",m("th",a.a.translator.trans("flamarkt-core.backoffice.payments.head.identifier")),20),r.add("amount",m("th",a.a.translator.trans("flamarkt-core.backoffice.payments.head.amount")),10),r},e.columns=function(r){var e=t.prototype.columns.call(this,r);return e.add("date",m("td",M()(r.createdAt())),40),e.add("method",m("td",r.method()),30),e.add("identifier",m("td",r.identifier()),20),e.add("amount",m("td",m(T.a,{value:r.amount()})),10),e},e.actions=function(r){var e=t.prototype.actions.call(this,r);return e.add("edit",W.a.component({className:"Button Button--icon",icon:"fas fa-pen",onclick:function(){a.a.modal.show(mt,{payment:r})}})),e},r}(F.a),ht=e(16),bt=function(t){function r(r){var e;e=t.call(this)||this;var n=r.payments();return e.loading=!1,e.pages=[new ht.Page(1,n||[])],e}return Object(g.a)(r,t),r.prototype.type=function(){return"flamarkt-payments"},r}(e.n(ht).a),yt=function(t){function r(){for(var r,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(r=t.call.apply(t,[this].concat(n))||this).order=null,r.user=null,r.lines=[],r.saving=!1,r.dirty=!1,r.newLine=void 0,r}Object(g.a)(r,t);var e=r.prototype;return e.oninit=function(r){t.prototype.oninit.call(this,r),this.initNewLine()},e.initNewLine=function(){this.newLine=new ct},e.initLineState=function(t){var r=new ct;return r.init(t),r},e.newRecord=function(){return a.a.store.createRecord("flamarkt-orders")},e.findType=function(){return"flamarkt/orders"},e.show=function(t){this.order=t,this.user=t.user()||null,this.lines=(t.lines()||[]).map(this.initLineState.bind(this)),a.a.setTitleCount(0)},e.view=function(){return this.order?m("form.OrderShowPage",{onsubmit:this.onsubmit.bind(this)},m(".container.container--narrow",this.fields().toArray())):Y.a.component()},e.fields=function(){var t=this,r=new b.a;return r.add("number",m(".Form-group",[m("label",a.a.translator.trans("flamarkt-core.backoffice.orders.field.number")),m("input.FormControl",{value:this.order.number(),readonly:!0})]),30),r.add("user",m(".Form-group",[m("label",a.a.translator.trans("flamarkt-core.backoffice.orders.field.user")),m(ot.a,{relationship:this.user,onchange:function(r){t.user=r,t.dirty=!0},hasOne:!0})]),20),r.add("lines",m("table.OrderComposerTable",[m("thead",m("tr",this.tableHead().toArray())),m(rt.a,{containerTag:"tbody",placeholderTag:"tr",onsort:function(r,e){var n;(n=t.lines).splice.apply(n,[e,0].concat(t.lines.splice(r,1))),t.dirty=!0}},this.lines.map((function(r,e){return m(L,{key:r.uniqueFormKey,line:r,sortable:!0,control:W.a.component({icon:"fas fa-times",className:"Button Button--icon Button--delete",onclick:function(){t.lines.splice(e,1),t.dirty=!0},title:a.a.translator.trans("flamarkt-core.backoffice.orders.lines.control.delete")}),onchange:function(){t.dirty=!0}})}))),m("tbody",m(L,{key:"new",line:this.newLine,control:W.a.component({icon:"fas fa-plus",className:"Button Button--icon",onclick:function(){t.lines.push(t.newLine),t.dirty=!0,t.initNewLine()},title:a.a.translator.trans("flamarkt-core.backoffice.orders.lines.control.add")}),onchange:function(){t.dirty=!0}}))]),10),r.add("submit",m(".Form-group",[nt.a.component({loading:this.saving,dirty:this.dirty,exists:this.order.exists})," ",ut.a.component({model:this.order})," ",dt.a.component({model:this.order,afterdelete:function(){m.route.set(a.a.route("orders.index"))}})]),-10),r.add("payments",m(".Form-group",[m("label",a.a.translator.trans("flamarkt-core.backoffice.payments.title")),m(pt,{state:new bt(this.order)})]),-20),r},e.tableHead=function(){var t=new b.a;return t.add("handle",m("th"),100),t.add("group",m("th",a.a.translator.trans("flamarkt-core.backoffice.orders.lines.head.group")),90),t.add("type",m("th",a.a.translator.trans("flamarkt-core.backoffice.orders.lines.head.type")),80),t.add("info",m("th",a.a.translator.trans("flamarkt-core.backoffice.orders.lines.head.info")),30),t.add("priceUnit",m("th",a.a.translator.trans("flamarkt-core.backoffice.orders.lines.head.priceUnit")),-30),t.add("quantity",m("th",a.a.translator.trans("flamarkt-core.backoffice.orders.lines.head.quantity")),-60),t.add("priceTotal",m("th",a.a.translator.trans("flamarkt-core.backoffice.orders.lines.head.priceTotal")),-90),t.add("control",m("th"),-100),t},e.data=function(){return{relationships:{lines:this.lines.map((function(t){return z({verbatim:!0,type:"flamarkt-product-lines"},t.data())})),user:this.user}}},e.onsubmit=function(t){var r,e=this;t.preventDefault(),this.saving=!0,this.saveThroughNewRecord(null==(r=this.order)?void 0:r.id(),this.data()).then((function(t){e.order=t,e.saving=!1,e.dirty=!1,m.redraw(),m.route.set(a.a.route.order(t))})).catch((function(t){e.saving=!1,m.redraw()}))},r}($.a),vt=e(27),gt=e(25),kt=function(t){function r(){for(var r,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(r=t.call.apply(t,[this].concat(n))||this).list=void 0,r}Object(g.a)(r,t);var e=r.prototype;return e.oninit=function(r){t.prototype.oninit.call(this,r),this.list=this.initState(),this.list.refresh(),a.a.setTitle(V()(a.a.translator.trans("flamarkt-core.backoffice.products.title"))),a.a.setTitleCount(0)},e.initState=function(){var t=m.route.param();return new vt.a({sort:t.sort})},e.view=function(){return m(".ProductIndexPage",m(".container",[m(".Form-group",[j.a.component({className:"Button",href:a.a.route("products.show",{id:"new"})},a.a.translator.trans("flamarkt-core.backoffice.products.new")),m(gt.a,{state:this.list})]),m(N,{state:this.list})]))},r}(H.a),wt=e(53),xt=e.n(wt),Ot=function(t){function r(){for(var r,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(r=t.call.apply(t,[this].concat(n))||this).product=null,r.saving=!1,r.dirty=!1,r.title="",r.description="",r.price=0,r.availabilityDriver=null,r.priceDriver=null,r.composer={editor:null},r}Object(g.a)(r,t);var e=r.prototype;return e.newRecord=function(){return a.a.store.createRecord("flamarkt-products",{attributes:{}})},e.findType=function(){return"flamarkt/products"},e.show=function(t){this.product=t,this.title=t.title()||"",this.description=t.description()||"",this.price=t.priceEdit()||0,this.availabilityDriver=t.attribute("availabilityDriver"),this.priceDriver=t.attribute("priceDriver"),a.a.setTitle(t.title()),a.a.setTitleCount(0)},e.view=function(){return this.product?m("form.ProductShowPage",{onsubmit:this.onsubmit.bind(this)},m(".container.container--narrow",this.fields().toArray())):Y.a.component()},e.fields=function(){var t=this,r=new b.a;return a.a.composer=this.composer,r.add("title",m(".Form-group",[m("label",a.a.translator.trans("flamarkt-core.backoffice.products.field.title")),m("input.FormControl",{type:"text",value:this.title,oninput:function(r){t.title=r.target.value,t.dirty=!0},disabled:this.saving})]),50),r.add("description",m(".Form-group",[m("label",a.a.translator.trans("flamarkt-core.backoffice.products.field.description")),m(".FormControl.FormControl--editor",xt.a.component({value:this.description,onchange:function(r){t.description=r,t.dirty=!0,m.redraw()},disabled:this.saving,composer:this.composer}))]),40),r.add("price",m(".Form-group",[m("label",a.a.translator.trans("flamarkt-core.backoffice.products.field.price")),m(P.a,{value:this.price,onchange:function(r){t.price=r,t.dirty=!0},disabled:this.saving})]),30),r.add("availabilityDriver",m(".Form-group",[m("label",a.a.translator.trans("flamarkt-core.backoffice.products.field.availabilityDriver")),v.a.component({value:this.availabilityDriver||"_default",options:this.availabilityDriverOptions(),onchange:function(r){t.availabilityDriver="_default"===r?null:r,t.dirty=!0}})]),20),r.add("priceDriver",m(".Form-group",[m("label",a.a.translator.trans("flamarkt-core.backoffice.products.field.priceDriver")),v.a.component({value:this.priceDriver||"_default",options:this.priceDriverOptions(),onchange:function(r){t.priceDriver="_default"===r?null:r,t.dirty=!0}})]),10),r.add("submit",m(".Form-group",[nt.a.component({loading:this.saving,dirty:this.dirty,exists:this.product.exists})," ",ut.a.component({model:this.product})," ",dt.a.component({model:this.product,afterdelete:function(){m.route.set(a.a.route("products.index"))}})]),-10),r},e.availabilityDriverOptions=function(){var t={_default:"Default"};return(a.a.forum.attribute("flamarktAvailabilityDrivers")||[]).forEach((function(r){t[r]=r})),t},e.priceDriverOptions=function(){var t={_default:"Default"};return(a.a.forum.attribute("flamarktPriceDrivers")||[]).forEach((function(r){t[r]=r})),t},e.data=function(){return{title:this.title,description:this.description,price:this.price,availabilityDriver:this.availabilityDriver,priceDriver:this.priceDriver}},e.onsubmit=function(t){var r,e=this;t.preventDefault(),this.saving=!0,this.saveThroughNewRecord(null==(r=this.product)?void 0:r.id(),this.data()).then((function(t){e.product=t,e.saving=!1,e.dirty=!1,m.redraw(),m.route.set(a.a.route.product(t))})).catch((function(t){throw e.saving=!1,m.redraw(),t}))},r}($.a),Dt={"components/OrderLineEdit":L,"components/OrderList":_,"components/OrderRelationshipSelect":q,"components/ProductList":N,"components/ProductRelationshipSelect":D,"pages/OrderIndexPage":G,"pages/OrderShowPage":yt,"pages/ProductIndexPage":kt,"pages/ProductShowPage":Ot,"states/OrderLineEditState":ct},Pt=e(15),At=e(54),Tt=e.n(At),Lt=e(38),Ct=e.n(Lt);a.a.initializers.add("flamarkt-core",(function(){a.a.store.models["flamarkt-orders"]=c.a,a.a.store.models["flamarkt-order-lines"]=s.a,a.a.store.models["flamarkt-payments"]=u.a,a.a.store.models["flamarkt-products"]=l.a,a.a.store.models.users.prototype.flamarktOrderCount=i.a.attribute("flamarktOrderCount"),a.a.routes["products.index"]={path:"/products",component:kt},a.a.routes["products.show"]={path:"/products/:id",component:Ot},a.a.routes["orders.index"]={path:"/orders",component:G},a.a.routes["orders.show"]={path:"/orders/:id",component:yt},a.a.route.product=function(t){return a.a.route("products.show",{id:t.id()})},a.a.route.order=function(t){return a.a.route("orders.show",{id:t.id()})},Object(Pt.extend)(Tt.a.prototype,"items",(function(t){t.add("products",Ct.a.component({href:a.a.route("products.index"),icon:"fas fa-box",activeRoutes:["products.*"]},a.a.translator.trans("flamarkt-core.backoffice.nav.products")),40),t.add("orders",Ct.a.component({href:a.a.route("orders.index"),icon:"fas fa-shopping-cart",activeRoutes:["orders.*"]},a.a.translator.trans("flamarkt-core.backoffice.nav.orders")),20)})),a.a.extensionData.for("flamarkt-core").registerSetting((function(){var t={};return(a.a.forum.attribute("flamarktAvailabilityDrivers")||[]).forEach((function(r){t[r]=r})),m(".Form-group",[m("label",a.a.translator.trans("flamarkt-core.backoffice.settings.defaultAvailabilityDriver")),v.a.component({value:this.setting("flamarkt.defaultAvailabilityDriver")()||"never",options:t,onchange:this.setting("flamarkt.defaultAvailabilityDriver")})])})).registerSetting((function(){var t={};return(a.a.forum.attribute("flamarktPriceDrivers")||[]).forEach((function(r){t[r]=r})),m(".Form-group",[m("label",a.a.translator.trans("flamarkt-core.backoffice.settings.defaultPriceDriver")),v.a.component({value:this.setting("flamarkt.defaultPriceDriver")()||"fixed",options:t,onchange:this.setting("flamarkt.defaultPriceDriver")})])})).registerSetting({type:"switch",setting:"flamarkt.forceOrderPrepayment",label:a.a.translator.trans("flamarkt-core.backoffice.settings.forceOrderPrepayment")}).registerPermission({icon:"fas fa-shopping-cart",label:a.a.translator.trans("flamarkt-core.backoffice.permissions.shop"),permission:"flamarkt.shop",allowGuest:!0},"reply").registerPermission({icon:"fas fa-wrench",label:a.a.translator.trans("flamarkt-core.backoffice.permissions.backoffice"),permission:"backoffice"},"moderate")}))}]);
//# sourceMappingURL=backoffice.js.map